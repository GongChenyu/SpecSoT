/data/home/chenyu/anaconda3/envs/sdsot/lib/python3.9/site-packages/torch/cuda/__init__.py:61: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
  import pynvml  # type: ignore[import]
2026-01-08 21:47:32,720 - init - INFO - 检测到单机多卡环境，使用NCCL后端
2026-01-08 21:47:33,021 - Rank-2 - INFO - 初始化设备 Rank 2/3
2026-01-08 21:47:33,204 - Rank-2 - INFO - 加载模型: /data/home/chenyu/Coding/SD+SoT/models/Qwen3-4B
2026-01-08 21:47:33,204 - Rank-2 - INFO - 注意：所有设备都加载完整模型，Prefill阶段选择对应层计算
`torch_dtype` is deprecated! Use `dtype` instead!
[Rank 2] 单机多卡模式(无环境隔离)，使用GPU 2
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:01,  1.52it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:01<00:00,  2.05it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.47it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.25it/s]
2026-01-08 21:47:34,816 - Rank-2 - INFO - 模型加载完成，共36层
2026-01-08 21:47:34,817 - Rank-2 - INFO - 模型加载完成，共36层
2026-01-08 21:47:34,817 - Rank-2 - INFO - ============================================================
2026-01-08 21:47:34,817 - Rank-2 - INFO - 开始 Prefill 阶段 (SP+PP)
2026-01-08 21:47:34,830 - Rank-2 - INFO - Prompt长度: 26 tokens
2026-01-08 21:47:34,830 - Rank-2 - INFO - 切分为 1 个chunks (chunk_size=128)
2026-01-08 21:47:34,830 - Rank-2 - INFO - 负责层范围: [24, 36)
2026-01-08 21:47:34,830 - Rank-2 - INFO - 处理 chunk 1/1
