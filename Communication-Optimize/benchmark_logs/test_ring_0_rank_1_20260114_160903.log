2026-01-14 16:09:05,658 - ZMQ-Rank-1 - INFO - 检测到 CUDA_VISIBLE_DEVICES=6，使用逻辑设备 cuda:0
2026-01-14 16:09:05,659 - ZMQ-Rank-1 - INFO - 初始化ZMQ通信管理器 (mode=ring)
2026-01-14 16:09:05,659 - ZMQComm-Rank1 - INFO - 设置Ring模式 ZMQ sockets
2026-01-14 16:09:05,659 - ZMQComm-Rank1 - INFO - Ring模式 ZMQ sockets设置完成 (prev=0, next=2)
2026-01-14 16:09:05,659 - ZMQComm-Rank1 - INFO - Ring拓扑: prev=0 <- rank1 -> next=2
2026-01-14 16:09:05,659 - ZMQ-Rank-1 - INFO - 等待其他节点就绪 (2.0秒)...
2026-01-14 16:09:07,662 - ZMQComm-Rank1 - INFO - 接收线程启动
2026-01-14 16:09:07,662 - ZMQComm-Rank1 - INFO - Ring发送线程启动
2026-01-14 16:09:07,662 - ZMQComm-Rank1 - INFO - 通信管理器已启动 (RingCommManager)
2026-01-14 16:09:07,662 - ZMQ-Rank-1 - INFO - 初始化设备 Rank 1/3
2026-01-14 16:09:07,948 - ZMQ-Rank-1 - INFO - 加载模型: /data/home/chenyu/Coding/SD+SoT/models/Qwen3-4B
2026-01-14 16:09:09,430 - ZMQ-Rank-1 - INFO - 模型加载完成，共36层
2026-01-14 16:09:09,432 - ZMQ-Rank-1 - INFO - KV Cache 预分配完成（最大长度: 2200）
2026-01-14 16:09:09,432 - ZMQ-Rank-1 - INFO - ============================================================
2026-01-14 16:09:09,432 - ZMQ-Rank-1 - INFO - 开始 Prefill 阶段 (SP+PP with ZMQ)
2026-01-14 16:09:09,440 - ZMQ-Rank-1 - INFO - Prompt长度: 17 tokens
2026-01-14 16:09:09,440 - ZMQ-Rank-1 - INFO - 切分为 1 个chunks (chunk_size=128)
2026-01-14 16:09:09,440 - ZMQ-Rank-1 - INFO - 负责层范围: [12, 24)
2026-01-14 16:09:09,440 - ZMQ-Rank-1 - INFO - 处理 chunk 1/1
2026-01-14 16:09:09,885 - ZMQ-Rank-1 - INFO -   chunk 1 处理完成
2026-01-14 16:09:09,886 - ZMQ-Rank-1 - INFO - 等待接收 12 个cache...
2026-01-14 16:09:10,229 - ZMQ-Rank-1 - INFO - 所有cache接收完成
2026-01-14 16:09:10,229 - ZMQ-Rank-1 - INFO - Prefill 总耗时: 0.796s, cache同步耗时: 0.796s, 计算耗时: 0.453s
2026-01-14 16:09:40,229 - ZMQComm-Rank1 - WARNING - 接收token超时
2026-01-14 16:09:40,229 - root - ERROR - Rank 1 测试出错: 'NoneType' object has no attribute 'item'
Traceback (most recent call last):
  File "/data/home/chenyu/Coding/SD+SoT/Speculative-Decoding-Enabled-Skeleton-of-Thought/Communication-Optimize/zmq_performance_benchmark.py", line 100, in run_single_test
    last_hidden, kv_caches = engine.prefill_phase(args_dict['prompt'])
  File "/data/home/chenyu/Coding/SD+SoT/Speculative-Decoding-Enabled-Skeleton-of-Thought/Communication-Optimize/zmq_distributed_inference.py", line 355, in prefill_phase
    self.logger.info(f"First token 同步完成: {self.first_token.item()}")
AttributeError: 'NoneType' object has no attribute 'item'
