2026-01-22 19:31:08.428 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:182] - [INIT] 初始化ZMQ通信管理器 | mode=p2p, base_port=45000
2026-01-22 19:31:09.430 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:194] - [INIT] 等待其他节点就绪 (3.0秒)...
2026-01-22 19:31:12.433 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:199] - [INIT] 通信管理器已启动
2026-01-22 19:31:12.469 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:256] - ============================================================
2026-01-22 19:31:12.469 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:257] - [PREFILL] 开始分布式 Prefill 阶段
2026-01-22 19:31:12.469 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:258] - ============================================================
2026-01-22 19:31:12.469 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:259] -   Rank: 0/2
2026-01-22 19:31:12.469 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:260] -   负责层范围: [0, 14)
2026-01-22 19:31:12.469 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:261] -   输入序列长度: 574
2026-01-22 19:31:12.469 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:262] -   模型总层数: 36
2026-01-22 19:31:12.469 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:820] - [INIT] Cache 追踪初始化: chunks=5, layers=36, seq_len=574
2026-01-22 19:31:12.469 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:687] - [SPLIT] 输入序列切分为 5 个 chunks | seq_len=574, chunk_size=128
2026-01-22 19:31:12.470 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:689] -     Chunk 0: shape=torch.Size([1, 128])
2026-01-22 19:31:12.470 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:689] -     Chunk 1: shape=torch.Size([1, 128])
2026-01-22 19:31:12.470 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:689] -     Chunk 2: shape=torch.Size([1, 128])
2026-01-22 19:31:12.470 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:689] -     Chunk 3: shape=torch.Size([1, 128])
2026-01-22 19:31:12.470 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:689] -     Chunk 4: shape=torch.Size([1, 62])
2026-01-22 19:31:12.470 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:269] -   Chunk数量: 5 (chunk_size=128)
2026-01-22 19:31:12.470 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:742] - [EAGLE] Input Layers 配置: [1, 17, 32] (总层数=36)
2026-01-22 19:31:12.470 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:273] -   Eagle Input Layers: [1, 17, 32]
2026-01-22 19:31:12.470 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:287] - 
[CHUNK 1/5] 开始处理 | seq_len=128, first=True, last=False
2026-01-22 19:31:12.470 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:296] -   [PHASE 1] 执行 Embedding...
2026-01-22 19:31:12.522 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:298] -   [PHASE 1] Embedding 完成 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 19:31:12.522 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:314] -   [PHASE 1] 完成 | 耗时: 52.30ms
2026-01-22 19:31:12.522 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:320] -   [PHASE 2] 开始计算 Decoder Layers [0, 14)
2026-01-22 19:31:12.522 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:328] -     past_key_values_length=0, seq_with_past=128
2026-01-22 19:31:12.641 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=0 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.642 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=0 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.646 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:409] -     [SEND][EAGLE] hidden state layer=1, chunk=0 -> Rank 2
2026-01-22 19:31:12.646 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=1 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.646 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=1 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.649 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=2 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.650 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=2 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.652 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=3 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.652 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=3 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.655 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=4 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.655 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=4 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.658 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=5 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.658 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=5 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.660 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=6 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.660 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=6 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.663 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=7 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.663 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=7 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.665 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=8 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.665 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=8 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.667 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=9 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.668 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=9 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.670 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=10 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.670 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=10 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.672 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=11 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.673 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=11 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.675 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=12 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.675 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=12 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.677 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=13 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.678 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=13 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.678 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:434] -   [PHASE 2] 完成 | layers=14, cache_sent=28, eagle_hidden_sent=1 | 耗时: 155.71ms
2026-01-22 19:31:12.678 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:444] -   [PHASE 3][SEND] Hidden States -> Rank 1
2026-01-22 19:31:12.678 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:450] -     Hidden States 发送完成 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 19:31:12.678 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:558] -   [PHASE 3] 完成 | 耗时: 0.14ms
2026-01-22 19:31:12.679 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:564] - [CHUNK 1/5] 完成 | 总耗时: 209.52ms
2026-01-22 19:31:12.680 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:287] - 
[CHUNK 2/5] 开始处理 | seq_len=128, first=False, last=False
2026-01-22 19:31:12.680 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:296] -   [PHASE 1] 执行 Embedding...
2026-01-22 19:31:12.680 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:298] -   [PHASE 1] Embedding 完成 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 19:31:12.680 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:314] -   [PHASE 1] 完成 | 耗时: 0.53ms
2026-01-22 19:31:12.680 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:320] -   [PHASE 2] 开始计算 Decoder Layers [0, 14)
2026-01-22 19:31:12.680 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:328] -     past_key_values_length=128, seq_with_past=256
2026-01-22 19:31:12.683 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=0 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.683 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=0 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.685 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:409] -     [SEND][EAGLE] hidden state layer=1, chunk=1 -> Rank 2
2026-01-22 19:31:12.686 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=1 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.686 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=1 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.688 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=2 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.689 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=2 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.691 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=3 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.691 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=3 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.693 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=4 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.694 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=4 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.696 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=5 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.696 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=5 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.698 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=6 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.698 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=6 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.700 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=7 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.701 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=7 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.702 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=8 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.703 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=8 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.705 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=9 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.705 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=9 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.707 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=10 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.708 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=10 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.710 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=11 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.710 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=11 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.712 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=12 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.712 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=12 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.714 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=13 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.714 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=13 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.714 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:434] -   [PHASE 2] 完成 | layers=14, cache_sent=28, eagle_hidden_sent=1 | 耗时: 34.05ms
2026-01-22 19:31:12.714 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:444] -   [PHASE 3][SEND] Hidden States -> Rank 1
2026-01-22 19:31:12.714 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:450] -     Hidden States 发送完成 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 19:31:12.715 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:558] -   [PHASE 3] 完成 | 耗时: 0.11ms
2026-01-22 19:31:12.716 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:564] - [CHUNK 2/5] 完成 | 总耗时: 36.18ms
2026-01-22 19:31:12.716 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:287] - 
[CHUNK 3/5] 开始处理 | seq_len=128, first=False, last=False
2026-01-22 19:31:12.716 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:296] -   [PHASE 1] 执行 Embedding...
2026-01-22 19:31:12.716 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:298] -   [PHASE 1] Embedding 完成 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 19:31:12.717 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:314] -   [PHASE 1] 完成 | 耗时: 0.18ms
2026-01-22 19:31:12.717 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:320] -   [PHASE 2] 开始计算 Decoder Layers [0, 14)
2026-01-22 19:31:12.717 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:328] -     past_key_values_length=256, seq_with_past=384
2026-01-22 19:31:12.719 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=0 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.720 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=0 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.722 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:409] -     [SEND][EAGLE] hidden state layer=1, chunk=2 -> Rank 2
2026-01-22 19:31:12.722 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=1 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.722 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=1 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.725 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=2 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.725 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=2 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.727 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=3 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.727 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=3 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.729 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=4 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.729 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=4 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.731 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=5 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.732 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=5 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.734 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=6 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.734 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=6 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.736 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=7 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.736 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=7 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.738 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=8 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.739 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=8 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.741 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=9 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.741 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=9 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.743 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=10 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.743 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=10 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.745 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=11 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.746 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=11 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.748 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=12 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.748 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=12 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.751 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=13 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.751 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=13 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.751 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:434] -   [PHASE 2] 完成 | layers=14, cache_sent=28, eagle_hidden_sent=1 | 耗时: 34.34ms
2026-01-22 19:31:12.751 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:444] -   [PHASE 3][SEND] Hidden States -> Rank 1
2026-01-22 19:31:12.751 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:450] -     Hidden States 发送完成 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 19:31:12.751 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:558] -   [PHASE 3] 完成 | 耗时: 0.12ms
2026-01-22 19:31:12.752 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:564] - [CHUNK 3/5] 完成 | 总耗时: 36.01ms
2026-01-22 19:31:12.752 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:287] - 
[CHUNK 4/5] 开始处理 | seq_len=128, first=False, last=False
2026-01-22 19:31:12.752 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:296] -   [PHASE 1] 执行 Embedding...
2026-01-22 19:31:12.753 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:298] -   [PHASE 1] Embedding 完成 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 19:31:12.753 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:314] -   [PHASE 1] 完成 | 耗时: 0.17ms
2026-01-22 19:31:12.753 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:320] -   [PHASE 2] 开始计算 Decoder Layers [0, 14)
2026-01-22 19:31:12.753 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:328] -     past_key_values_length=384, seq_with_past=512
2026-01-22 19:31:12.755 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=0 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.755 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=0 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.757 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:409] -     [SEND][EAGLE] hidden state layer=1, chunk=3 -> Rank 2
2026-01-22 19:31:12.758 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=1 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.758 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=1 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.760 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=2 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.760 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=2 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.762 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=3 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.763 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=3 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.765 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=4 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.765 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=4 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.767 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=5 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.767 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=5 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.769 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=6 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.769 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=6 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.771 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=7 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.772 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=7 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.774 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=8 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.774 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=8 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.776 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=9 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.776 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=9 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.779 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=10 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.779 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=10 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.781 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=11 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.782 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=11 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.784 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=12 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.784 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=12 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.786 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=13 -> Rank 1 | size=0.50MB
2026-01-22 19:31:12.786 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=13 -> Rank 2 | size=0.50MB
2026-01-22 19:31:12.786 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:434] -   [PHASE 2] 完成 | layers=14, cache_sent=28, eagle_hidden_sent=1 | 耗时: 33.75ms
2026-01-22 19:31:12.787 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:444] -   [PHASE 3][SEND] Hidden States -> Rank 1
2026-01-22 19:31:12.787 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:450] -     Hidden States 发送完成 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 19:31:12.787 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:558] -   [PHASE 3] 完成 | 耗时: 0.19ms
2026-01-22 19:31:12.788 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:564] - [CHUNK 4/5] 完成 | 总耗时: 35.49ms
2026-01-22 19:31:12.788 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:287] - 
[CHUNK 5/5] 开始处理 | seq_len=62, first=False, last=True
2026-01-22 19:31:12.788 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:296] -   [PHASE 1] 执行 Embedding...
2026-01-22 19:31:12.788 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:298] -   [PHASE 1] Embedding 完成 | shape=(1, 62, 2560), dtype=float16, device=cuda:0, size=0.303MB
2026-01-22 19:31:12.788 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:314] -   [PHASE 1] 完成 | 耗时: 0.24ms
2026-01-22 19:31:12.788 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:320] -   [PHASE 2] 开始计算 Decoder Layers [0, 14)
2026-01-22 19:31:12.788 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:328] -     past_key_values_length=512, seq_with_past=574
2026-01-22 19:31:12.791 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=0 -> Rank 1 | size=0.24MB
2026-01-22 19:31:12.791 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=0 -> Rank 2 | size=0.24MB
2026-01-22 19:31:12.793 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:409] -     [SEND][EAGLE] hidden state layer=1, chunk=4 -> Rank 2
2026-01-22 19:31:12.793 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=1 -> Rank 1 | size=0.24MB
2026-01-22 19:31:12.793 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=1 -> Rank 2 | size=0.24MB
2026-01-22 19:31:12.796 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=2 -> Rank 1 | size=0.24MB
2026-01-22 19:31:12.796 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=2 -> Rank 2 | size=0.24MB
2026-01-22 19:31:12.798 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=3 -> Rank 1 | size=0.24MB
2026-01-22 19:31:12.799 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=3 -> Rank 2 | size=0.24MB
2026-01-22 19:31:12.800 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=4 -> Rank 1 | size=0.24MB
2026-01-22 19:31:12.801 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=4 -> Rank 2 | size=0.24MB
2026-01-22 19:31:12.803 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=5 -> Rank 1 | size=0.24MB
2026-01-22 19:31:12.803 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=5 -> Rank 2 | size=0.24MB
2026-01-22 19:31:12.805 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=6 -> Rank 1 | size=0.24MB
2026-01-22 19:31:12.805 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=6 -> Rank 2 | size=0.24MB
2026-01-22 19:31:12.807 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=7 -> Rank 1 | size=0.24MB
2026-01-22 19:31:12.807 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=7 -> Rank 2 | size=0.24MB
2026-01-22 19:31:12.809 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=8 -> Rank 1 | size=0.24MB
2026-01-22 19:31:12.809 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=8 -> Rank 2 | size=0.24MB
2026-01-22 19:31:12.815 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=9 -> Rank 1 | size=0.24MB
2026-01-22 19:31:12.815 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=9 -> Rank 2 | size=0.24MB
2026-01-22 19:31:12.818 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=10 -> Rank 1 | size=0.24MB
2026-01-22 19:31:12.818 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=10 -> Rank 2 | size=0.24MB
2026-01-22 19:31:12.820 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=11 -> Rank 1 | size=0.24MB
2026-01-22 19:31:12.820 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=11 -> Rank 2 | size=0.24MB
2026-01-22 19:31:12.822 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=12 -> Rank 1 | size=0.24MB
2026-01-22 19:31:12.822 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=12 -> Rank 2 | size=0.24MB
2026-01-22 19:31:12.824 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=13 -> Rank 1 | size=0.24MB
2026-01-22 19:31:12.824 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:428] -     [SEND][CACHE] layer=13 -> Rank 2 | size=0.24MB
2026-01-22 19:31:12.824 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:434] -   [PHASE 2] 完成 | layers=14, cache_sent=28, eagle_hidden_sent=1 | 耗时: 36.12ms
2026-01-22 19:31:12.825 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:444] -   [PHASE 3][SEND] Hidden States -> Rank 1
2026-01-22 19:31:12.825 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:450] -     Hidden States 发送完成 | shape=(1, 62, 2560), dtype=float16, device=cuda:0, size=0.303MB
2026-01-22 19:31:12.825 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:558] -   [PHASE 3] 完成 | 耗时: 0.13ms
2026-01-22 19:31:12.826 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:564] - [CHUNK 5/5] 完成 | 总耗时: 37.97ms
2026-01-22 19:31:12.826 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:569] - 
============================================================
2026-01-22 19:31:12.826 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:570] - [POST-CHUNK] 所有 Chunks 处理完成，开始同步阶段
2026-01-22 19:31:12.826 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:571] - ============================================================
2026-01-22 19:31:12.826 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:577] - [RECV] 等待 Draft Tokens (from Rank 2)...
2026-01-22 19:31:15.401 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:588] - [RECV] Draft Tokens 接收完成 | shape=torch.Size([1, 40]) | 耗时: 2574.47ms
2026-01-22 19:31:15.401 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:591] - [SYNC] 等待所有 Cache 同步...
2026-01-22 19:31:15.412 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:608] - [SYNC_OK] Rank 0 Cache 同步完成 | 耗时: 10.88ms
2026-01-22 19:31:15.412 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:617] - ============================================================
2026-01-22 19:31:15.412 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:618] - [PREFILL] 分布式 Prefill 完成 | 总耗时: 2.943s
2026-01-22 19:31:15.412 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:619] - ============================================================
2026-01-22 19:31:36.018 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:206] - [CLEANUP] 通信统计: {'draft_tokens_sent': 0, 'draft_tokens_recv': 1, 'hidden_sent': 5, 'hidden_recv': 0, 'eagle_input_hidden_sent': 5, 'eagle_input_hidden_recv': 0, 'base_cache_sent': 140, 'base_cache_recv': 110, 'eagle_cache_sent': 0, 'eagle_cache_recv': 5, 'aggregated_sends': 0, 'forwarded_messages': 0}
2026-01-22 19:31:36.046 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:209] - [CLEANUP] 分布式Prefill管理器已清理
