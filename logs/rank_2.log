2026-01-22 20:35:59.502 - SpecSoT-Rank2-Comm - INFO - [logging_utils.py:155] - 日志将保存到: /data/home/chenyu/Coding/SD+SoT/Speculative-Decoding-Enabled-Skeleton-of-Thought/logs/rank_2.log
2026-01-22 20:35:59.503 - SpecSoT-Rank2-Comm - INFO - [p2p_comm_manager.py:46] - [INIT] 初始化 P2P 模式 socket 连接...
2026-01-22 22026-01-22 20:36:00.504 - SpecSoT-Rank2 - INFO - [distributed_prefill.py:143] - [INIT] 等待其他节点就绪 (3.0秒)...
2026-01-22 20:36:03.509 - SpecSoT-Rank2 - INFO - [distributed_prefill.py:148] - [INIT] 通信管理器已启动
2026-01-22 20:36:03.517 - SpecSoT-Rank2 - INFO - [run_specsot.py:358] - 模型加载完成，耗时: 7.38s
2026-01-22 20:36:03.520 - SpecSoT-Rank2 - INFO - [run_specsot.py:364] - Special Token IDs:
2026-01-22 20:36:03.520 - SpecSoT-Rank2 - DEBUG - [run_specsot.py:367] -   para_begin_token_id: 820 -> '####'
2026-01-22 20:36:03.521 - SpecSoT-Rank2 - DEBUG - [run_specsot.py:367] -   para_end_token_id: 5321 -> '%%%%'
2026-01-22 20:36:03.521 - SpecSoT-Rank2 - DEBUG - [run_specsot.py:367] -   ellipsis_token_id: 28149 -> '......'
2026-01-22 20:36:03.521 - SpecSoT-Rank2 - DEBUG - [run_specsot.py:367] -   half_ellipsis_token_id: 1112 -> '...'
2026-01-22 20:36:03.521 - SpecSoT-Rank2 - DEBUG - [run_specsot.py:367] -   line_break_token_id: 271 -> '

'
2026-01-22 20:36:03.521 - SpecSoT-Rank2 - DEBUG - [run_specsot.py:367] -   colon_token_id: 25 -> ':'
2026-01-22 20:36:03.522 - SpecSoT-Rank2 - DEBUG - [run_specsot.py:367] -   cn_colon_token_id: 5122 -> '：'
2026-01-22 20:36:03.522 - SpecSoT-Rank2 - DEBUG - [run_specsot.py:367] -   colon_new_line_token_id: 510 -> ':
'
2026-01-22 20:36:03.530 - SpecSoT-Rank2 - INFO - [run_specsot.py:242] - 加载数据集: /data/home/chenyu/Coding/SD+SoT/Speculative-Decoding-Enabled-Skeleton-of-Thought/datasets/planning/industry_tasks_no_ascii.jsonl, 共 9 条样本
2026-01-22 20:36:03.531 - SpecSoT-Rank2 - INFO - [run_specsot.py:374] - 使用 1 条样本进行评估
2026-01-22 20:36:03.531 - SpecSoT-Rank2 - INFO - [run_specsot.py:389] - 
============================================================
2026-01-22 20:36:03.531 - SpecSoT-Rank2 - INFO - [run_specsot.py:390] - 样本 1/1: 请问打篮球时，如何提高投篮命中率？请给出详细的建议。...
2026-01-22 20:36:03.532 - SpecSoT-Rank2 - INFO - [run_specsot.py:391] - ============================================================
2026-01-22 20:36:03.562 - SpecSoT-Rank2 - INFO - [distributed_prefill.py:205] - [PREFILL] 开始 | Rank=2/2 | layers=[28,36) | seq_len=574
2026-01-22 20:36:03.562 - SpecSoT-Rank2 - INFO - [distributed_prefill.py:758] - [INIT] Cache 追踪初始化: chunks=5, layers=36, seq_len=574
2026-01-22 20:36:03.562 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:625] - [SPLIT] 输入序列切分为 5 个 chunks | seq_len=574, chunk_size=128
2026-01-22 20:36:03.563 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:627] -     Chunk 0: shape=torch.Size([1, 128])
2026-01-22 20:36:03.563 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:627] -     Chunk 1: shape=torch.Size([1, 128])
2026-01-22 20:36:03.563 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:627] -     Chunk 2: shape=torch.Size([1, 128])
2026-01-22 20:36:03.563 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:627] -     Chunk 3: shape=torch.Size([1, 128])
2026-01-22 20:36:03.563 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:627] -     Chunk 4: shape=torch.Size([1, 62])
2026-01-22 20:36:03.564 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:212] -   Chunk数量: 5 (chunk_size=128)
2026-01-22 20:36:03.564 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:680] - [EAGLE] Input Layers 配置: [1, 17, 32] (总层数=36)
2026-01-22 20:36:03.564 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:216] -   Eagle Input Layers: [1, 17, 32]
2026-01-22 20:36:03.564 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:230] - [CHUNK 1/5] 开始处理 | seq_len=128, first=True, last=False
2026-01-22 20:2026-01-22 20:36:04 - SpecSoT-Rank2 - INFO - [PREFILL] Chunks处理完成，开始 Cache 同步...
2026-01-22 20:36:04 - SpecSoT-Rank2 - INFO - [PREFILL] 分布式 Prefill 完成 | Rank=2 | 耗时: 0.454s
Generated Skeleton: 分析这个问题是否属于需要拆解规划的“复杂任务”：

问题要求“详细建议”，涉及多个独立的方面，如技术动作、训练方法、心理因素、场地条件等，这些部分可以并行考虑，因此属于复杂任务，必须拆解规划。

执行方法B，生成思维骨架：

#### 技术动作规范【212】:......

#### 训练计划制定【189】:......

#### 心理素质提升【199】:......

#### 场地与装备优化【156】:......

#### 比赛经验积累【204】:......

####%%%%
Detected 5 parallel branches with predicted lengths: [200, 200, 200, 200, 200]
Parallel Decoding Step 1
Parallel Decoding Step 51
Branch 0 finished with EOS.
Parallel Decoding Step 101
Branch 1 finished with EOS.
Parallel Decoding Step 151
Parallel Decoding Step 201
Branch 4 finished with EOS.
Parallel Decoding Step 251
Parallel Decoding Step 301
Parallel Decoding Step 351
Parallel Decoding Step 401
Parallel Decoding Step 451
Branch 3 finished with EOS.
Branch 2 finished with EOS.
All branches finished generation.
Avg accepted lengths: 0.5254582484725051, Avg draft time: 0.0056s, Avg update time: 0.0011s, Avg verify time: 0.0289s
Branch 0 Length: 122
Branch 1 Length: 171
Branch 2 Length: 586
Branch 3 Length: 567
Branch 4 Length: 309
2026-01-22 20:36:24 - SpecSoT-Rank2 - INFO - 
[统计信息]
2026-01-22 20:36:24 - SpecSoT-Rank2 - INFO -   总耗时: 20.95s
2026-01-22 20:36:24 - SpecSoT-Rank2 - INFO -   峰值显存: 4422.19 MB
2026-01-22 20:36:24 - SpecSoT-Rank2 - INFO -   输出长度: 1901 tokens
2026-01-22 20:36:24 - SpecSoT-Rank2 - INFO -   吞吐量: 90.7 tokens/s
2026-01-22 20:36:24 - SpecSoT-Rank2 - INFO -   并行分支数: 5
2026-01-22 20:36:24 - SpecSoT-Rank2 - INFO -   平均接受长度: 0.53
2026-01-22 20:36:24 - SpecSoT-Rank2 - INFO -   平均Draft时间: 5.59 ms
2026-01-22 20:36:24 - SpecSoT-Rank2 - INFO -   平均Verify时间: 28.87 ms
2026-01-22 20:36:24 - SpecSoT-Rank2 - INFO -   平均Update时间: 1.06 ms
2026-01-22 20:36:24 - SpecSoT-Rank2 - INFO - 
[响应预览]
2026-01-22 20:36:24 - SpecSoT-Rank2 - INFO - 分析这个问题是否属于需要拆解规划的“复杂任务”：

问题要求“详细建议”，涉及多个独立的方面，如技术动作、训练方法、心理因素、场地条件等，这些部分可以并行考虑，因此属于复杂任务，必须拆解规划。

执行方法B，生成思维骨架：

#### 技术动作规范【212】:......

#### 训练计划制定【189】:......

#### 心理素质提升【199】:......

#### 场地与装备优化【156】:......

#### 比赛经验积累【204】:......

####%%%%

#### 技术动作规范【212】: 
正确的投篮姿势是保持身体平衡，双脚分开与肩同宽，膝盖微屈，重心放在前脚掌。出手时，手臂自然伸直，手腕下压，球从指尖弹出。练习时要注意保持手臂与身体成直线，避免过度弯曲或伸直。此外，投篮时的发力顺序也很重要，先蹬地，再转胯，最后出手，确保动作连贯。可以通过慢动作练习和录像回放来纠正错误动作，提高动作的准确性和稳定性。


#### 训练计划制定【189】: 
制定科学的训练计划是提高投篮命中率的关键。首先，要明确训练目标，例如提升远距离投篮能力或增强近距离投篮的...
2026-01-22 20:36:24 - SpecSoT-Rank2 - INFO - 正在清理分布式资源...
2026-01-22 20:36:24 - SpecSoT-Rank2 - INFO - [CLEANUP] 通信统计: {'draft_tokens_sent': 2, 'draft_tokens_recv': 0, 'hidden_sent': 0, 'hidden_recv': 5, 'eagle_input_hidden_sent': 0, 'eagle_input_hidden_recv': 10, 'base_cache_sent': 80, 'base_cache_recv': 140, 'eagle_cache_sent': 10, 'eagle_cache_recv': 0, 'aggregated_sends': 0, 'forwarded_messages': 0}
2026-01-22 20:36:24 - SpecSoT-Rank2 - INFO - [CLEANUP] 分布式Prefill管理器已清理
2026-01-22 20:36:24 - SpecSoT-Rank2 - INFO - 分布式资源已清理
2026-01-22 20:36:24 - SpecSoT-Rank2 - INFO - Worker 执行完成
 1 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 20:36:03.836 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:721] -     [EAGLE] 收集 layer 17 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 20:36:03.836 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:721] -     [EAGLE] 收集 layer 32 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 20:36:03.836 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:725] -   [EAGLE] 拼接后 hidden_states | shape=(1, 128, 7680), dtype=float16, device=cuda:0, size=1.875MB
2026-01-22 20:36:03.836 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:431] -     EAGLE3 Hidden States | shape=(1, 128, 7680), dtype=float16, device=cuda:0, size=1.875MB
2026-01-22 20:36:03.836 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:456] -     Draft Tree 生成: input_ids range=[1, 129)
2026-01-22 20:36:03.863 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:473] -   [PHASE 3][BROADCAST] Eagle Stable KV | chunk=0, size=0.50MB
2026-01-22 20:36:03.863 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:501] -   [PHASE 3] 完成 | 耗时: 28.91ms
2026-01-22 20:36:03.864 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=0, chunk=0 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.864 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=14, chunk=0 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.864 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=15, chunk=0 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.865 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=1, chunk=0 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.865 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=16, chunk=0 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.865 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=2, chunk=0 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.865 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=3, chunk=0 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.865 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=17, chunk=0 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.866 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=4, chunk=0 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.866 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=18, chunk=0 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.866 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=5, chunk=0 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.866 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=19, chunk=0 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.866 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=6, chunk=0 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.866 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=20, chunk=0 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.866 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=7, chunk=0 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.866 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=21, chunk=0 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.866 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=8, chunk=0 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.866 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=22, chunk=0 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.866 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=9, chunk=0 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.866 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=23, chunk=0 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.866 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=10, chunk=0 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.867 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=24, chunk=0 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.867 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=11, chunk=0 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.867 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=25, chunk=0 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.867 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=12, chunk=0 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.867 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=26, chunk=0 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.867 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=13, chunk=0 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.867 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=0, chunk=1 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.867 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=27, chunk=0 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.867 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=14, chunk=1 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.867 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=1, chunk=1 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.867 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=15, chunk=1 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.867 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=2, chunk=1 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.867 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=16, chunk=1 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.867 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=3, chunk=1 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.867 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=4, chunk=1 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.867 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=17, chunk=1 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.867 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=5, chunk=1 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.867 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=18, chunk=1 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.867 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=6, chunk=1 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.867 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=19, chunk=1 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.867 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=7, chunk=1 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.867 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=20, chunk=1 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.868 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=8, chunk=1 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.868 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=21, chunk=1 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.868 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=9, chunk=1 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.868 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=22, chunk=1 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.868 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=10, chunk=1 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.868 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=23, chunk=1 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.868 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=11, chunk=1 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.868 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=24, chunk=1 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.868 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=12, chunk=1 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.868 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=25, chunk=1 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.868 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=13, chunk=1 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.868 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=26, chunk=1 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.868 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=0, chunk=2 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.868 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=27, chunk=1 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.868 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=1, chunk=2 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.868 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=14, chunk=2 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.868 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=2, chunk=2 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.868 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=15, chunk=2 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.868 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=3, chunk=2 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.868 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=16, chunk=2 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.868 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=4, chunk=2 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.868 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=5, chunk=2 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.868 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=17, chunk=2 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.869 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=6, chunk=2 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.869 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=18, chunk=2 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.869 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=7, chunk=2 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.869 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=19, chunk=2 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.869 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=8, chunk=2 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.869 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=20, chunk=2 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.869 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=9, chunk=2 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.869 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=21, chunk=2 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.869 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=10, chunk=2 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.869 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=22, chunk=2 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.869 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=11, chunk=2 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.869 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=23, chunk=2 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.869 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=12, chunk=2 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.869 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=24, chunk=2 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.869 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=13, chunk=2 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.869 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=25, chunk=2 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.869 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=0, chunk=3 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.869 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=26, chunk=2 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.869 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=1, chunk=3 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.869 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=27, chunk=2 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.869 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=2, chunk=3 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.869 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=14, chunk=3 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.869 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=3, chunk=3 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.870 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=15, chunk=3 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.870 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=4, chunk=3 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.870 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=16, chunk=3 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.870 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=5, chunk=3 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.870 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=6, chunk=3 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.870 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=17, chunk=3 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.870 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=7, chunk=3 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.870 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=18, chunk=3 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.870 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=8, chunk=3 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.870 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=19, chunk=3 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.870 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=9, chunk=3 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.870 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=20, chunk=3 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.870 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=10, chunk=3 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.870 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=21, chunk=3 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.870 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=11, chunk=3 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.870 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=22, chunk=3 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.870 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=12, chunk=3 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.870 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=23, chunk=3 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.870 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=13, chunk=3 from Rank 0 | size=0.50MB
2026-01-22 20:36:03.870 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=24, chunk=3 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.870 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=0, chunk=4 from Rank 0 | size=0.24MB
2026-01-22 20:36:03.870 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=25, chunk=3 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.870 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=26, chunk=3 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.870 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=1, chunk=4 from Rank 0 | size=0.24MB
2026-01-22 20:36:03.871 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=2, chunk=4 from Rank 0 | size=0.24MB
2026-01-22 20:36:03.871 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=27, chunk=3 from Rank 1 | size=0.50MB
2026-01-22 20:36:03.871 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=3, chunk=4 from Rank 0 | size=0.24MB
2026-01-22 20:36:03.871 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=14, chunk=4 from Rank 1 | size=0.24MB
2026-01-22 20:36:03.871 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=4, chunk=4 from Rank 0 | size=0.24MB
2026-01-22 20:36:03.871 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=15, chunk=4 from Rank 1 | size=0.24MB
2026-01-22 20:36:03.871 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=5, chunk=4 from Rank 0 | size=0.24MB
2026-01-22 20:36:03.871 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=16, chunk=4 from Rank 1 | size=0.24MB
2026-01-22 20:36:03.871 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=6, chunk=4 from Rank 0 | size=0.24MB
2026-01-22 20:36:03.871 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=7, chunk=4 from Rank 0 | size=0.24MB
2026-01-22 20:36:03.871 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=17, chunk=4 from Rank 1 | size=0.24MB
2026-01-22 20:36:03.871 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=8, chunk=4 from Rank 0 | size=0.24MB
2026-01-22 20:36:03.871 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=18, chunk=4 from Rank 1 | size=0.24MB
2026-01-22 20:36:03.871 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=9, chunk=4 from Rank 0 | size=0.24MB
2026-01-22 20:36:03.871 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=19, chunk=4 from Rank 1 | size=0.24MB
2026-01-22 20:36:03.871 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=10, chunk=4 from Rank 0 | size=0.24MB
2026-01-22 20:36:03.871 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=20, chunk=4 from Rank 1 | size=0.24MB
2026-01-22 20:36:03.871 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=11, chunk=4 from Rank 0 | size=0.24MB
2026-01-22 20:36:03.871 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=21, chunk=4 from Rank 1 | size=0.24MB
2026-01-22 20:36:03.871 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=12, chunk=4 from Rank 0 | size=0.24MB
2026-01-22 20:36:03.871 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=22, chunk=4 from Rank 1 | size=0.24MB
2026-01-22 20:36:03.871 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=13, chunk=4 from Rank 0 | size=0.24MB
2026-01-22 20:36:03.871 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=23, chunk=4 from Rank 1 | size=0.24MB
2026-01-22 20:36:03.872 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=24, chunk=4 from Rank 1 | size=0.24MB
2026-01-22 20:36:03.872 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=25, chunk=4 from Rank 1 | size=0.24MB
2026-01-22 20:36:03.872 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=26, chunk=4 from Rank 1 | size=0.24MB
2026-01-22 20:36:03.872 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=27, chunk=4 from Rank 1 | size=0.24MB
2026-01-22 20:36:03.873 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:668] -   [CACHE] 非阻塞接收 140 个 Base Cache
2026-01-22 20:36:03.873 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:507] - [CHUNK 1/5] 完成 | 总耗时: 308.75ms
2026-01-22 20:36:03.873 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:230] - [CHUNK 2/5] 开始处理 | seq_len=128, first=False, last=False
2026-01-22 20:36:03.873 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:245] -   [PHASE 1] 等待接收 Hidden States (from Rank 1)...
2026-01-22 20:36:03.873 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:254] -   [PHASE 1][RECV] Hidden States | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB | chunk_idx=1
2026-01-22 20:36:03.873 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:257] -   [PHASE 1] 完成 | 耗时: 0.11ms
2026-01-22 20:36:03.873 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:263] -   [PHASE 2] 开始计算 Decoder Layers [28, 36)
2026-01-22 20:36:03.873 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:271] -     past_key_values_length=128, seq_with_past=256
2026-01-22 20:36:03.875 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=28 -> Rank 0 | size=0.50MB
2026-01-22 20:36:03.875 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=28 -> Rank 1 | size=0.50MB
2026-01-22 20:36:03.877 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=29 -> Rank 0 | size=0.50MB
2026-01-22 20:36:03.877 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=29 -> Rank 1 | size=0.50MB
2026-01-22 20:36:03.879 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=30 -> Rank 0 | size=0.50MB
2026-01-22 20:36:03.879 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=30 -> Rank 1 | size=0.50MB
2026-01-22 20:36:03.881 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=31 -> Rank 0 | size=0.50MB
2026-01-22 20:36:03.881 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=31 -> Rank 1 | size=0.50MB
2026-01-22 20:36:03.883 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:342] -     [EAGLE] 保存 hidden state layer=32, chunk=1
2026-01-22 20:36:03.884 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=32 -> Rank 0 | size=0.50MB
2026-01-22 20:36:03.884 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=32 -> Rank 1 | size=0.50MB
2026-01-22 20:36:03.886 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=33 -> Rank 0 | size=0.50MB
2026-01-22 20:36:03.886 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=33 -> Rank 1 | size=0.50MB
2026-01-22 20:36:03.888 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=34 -> Rank 0 | size=0.50MB
2026-01-22 20:36:03.888 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=34 -> Rank 1 | size=0.50MB
2026-01-22 20:36:03.890 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=35 -> Rank 0 | size=0.50MB
2026-01-22 20:36:03.890 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=35 -> Rank 1 | size=0.50MB
2026-01-22 20:36:03.891 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:377] -   [PHASE 2] 完成 | layers=8, cache_sent=16, eagle_hidden_sent=0 | 耗时: 17.59ms
2026-01-22 20:36:03.891 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:396] -   [PHASE 3] 执行 Eagle Layer 计算...
2026-01-22 20:36:03.891 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:400] -     Norm 完成 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 20:36:03.891 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:404] -     LM Head 完成 | shape=(1, 128, 151936), dtype=float16, device=cuda:0, size=37.094MB
2026-01-22 20:36:03.891 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:407] -   [PHASE 3][RECV] 等待 Eagle Input Hidden States (chunk=1)...
2026-01-22 20:36:03.892 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:417] -   [PHASE 3][RECV] 收到 2 个 Eagle Hidden (chunk=1) | 耗时: 0.23ms
2026-01-22 20:36:03.892 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:421] -     合并后 Eagle Hidden States 层: [1, 17, 32]
2026-01-22 20:36:03.892 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:680] - [EAGLE] Input Layers 配置: [1, 17, 32] (总层数=36)
2026-01-22 20:36:03.892 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:721] -     [EAGLE] 收集 layer 1 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 20:36:03.892 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:721] -     [EAGLE] 收集 layer 17 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 20:36:03.892 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:721] -     [EAGLE] 收集 layer 32 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 20:36:03.892 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:725] -   [EAGLE] 拼接后 hidden_states | shape=(1, 128, 7680), dtype=float16, device=cuda:0, size=1.875MB
2026-01-22 20:36:03.892 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:431] -     EAGLE3 Hidden States | shape=(1, 128, 7680), dtype=float16, device=cuda:0, size=1.875MB
2026-01-22 20:36:03.892 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:456] -     Draft Tree 生成: input_ids range=[129, 257)
2026-01-22 20:36:03.894 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:473] -   [PHASE 3][BROADCAST] Eagle Stable KV | chunk=1, size=0.50MB
2026-01-22 20:36:03.894 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:501] -   [PHASE 3] 完成 | 耗时: 3.46ms
2026-01-22 20:36:03.895 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:507] - [CHUNK 2/5] 完成 | 总耗时: 22.38ms
2026-01-22 20:36:03.895 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:230] - [CHUNK 3/5] 开始处理 | seq_len=128, first=False, last=False
2026-01-22 20:36:03.895 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:245] -   [PHASE 1] 等待接收 Hidden States (from Rank 1)...
2026-01-22 20:36:03.895 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:254] -   [PHASE 1][RECV] Hidden States | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB | chunk_idx=2
2026-01-22 20:36:03.895 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:257] -   [PHASE 1] 完成 | 耗时: 0.26ms
2026-01-22 20:36:03.895 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:263] -   [PHASE 2] 开始计算 Decoder Layers [28, 36)
2026-01-22 20:36:03.896 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:271] -     past_key_values_length=256, seq_with_past=384
2026-01-22 20:36:03.897 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=28 -> Rank 0 | size=0.50MB
2026-01-22 20:36:03.898 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=28 -> Rank 1 | size=0.50MB
2026-01-22 20:36:03.903 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=29 -> Rank 0 | size=0.50MB
2026-01-22 20:36:03.903 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=29 -> Rank 1 | size=0.50MB
2026-01-22 20:36:03.905 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=30 -> Rank 0 | size=0.50MB
2026-01-22 20:36:03.905 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=30 -> Rank 1 | size=0.50MB
2026-01-22 20:36:03.907 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=31 -> Rank 0 | size=0.50MB
2026-01-22 20:36:03.907 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=31 -> Rank 1 | size=0.50MB
2026-01-22 20:36:03.908 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:342] -     [EAGLE] 保存 hidden state layer=32, chunk=2
2026-01-22 20:36:03.909 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=32 -> Rank 0 | size=0.50MB
2026-01-22 20:36:03.909 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=32 -> Rank 1 | size=0.50MB
2026-01-22 20:36:03.911 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=33 -> Rank 0 | size=0.50MB
2026-01-22 20:36:03.911 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=33 -> Rank 1 | size=0.50MB
2026-01-22 20:36:03.912 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=34 -> Rank 0 | size=0.50MB
2026-01-22 20:36:03.913 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=34 -> Rank 1 | size=0.50MB
2026-01-22 20:36:03.914 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=35 -> Rank 0 | size=0.50MB
2026-01-22 20:36:03.914 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=35 -> Rank 1 | size=0.50MB
2026-01-22 20:36:03.915 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:377] -   [PHASE 2] 完成 | layers=8, cache_sent=16, eagle_hidden_sent=0 | 耗时: 19.06ms
2026-01-22 20:36:03.915 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:396] -   [PHASE 3] 执行 Eagle Layer 计算...
2026-01-22 20:36:03.915 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:400] -     Norm 完成 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 20:36:03.915 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:404] -     LM Head 完成 | shape=(1, 128, 151936), dtype=float16, device=cuda:0, size=37.094MB
2026-01-22 20:36:03.915 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:407] -   [PHASE 3][RECV] 等待 Eagle Input Hidden States (chunk=2)...
2026-01-22 20:36:03.916 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:417] -   [PHASE 3][RECV] 收到 2 个 Eagle Hidden (chunk=2) | 耗时: 0.57ms
2026-01-22 20:36:03.916 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:421] -     合并后 Eagle Hidden States 层: [1, 17, 32]
2026-01-22 20:36:03.916 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:680] - [EAGLE] Input Layers 配置: [1, 17, 32] (总层数=36)
2026-01-22 20:36:03.916 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:721] -     [EAGLE] 收集 layer 1 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 20:36:03.916 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:721] -     [EAGLE] 收集 layer 17 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 20:36:03.916 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:721] -     [EAGLE] 收集 layer 32 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 20:36:03.916 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:725] -   [EAGLE] 拼接后 hidden_states | shape=(1, 128, 7680), dtype=float16, device=cuda:0, size=1.875MB
2026-01-22 20:36:03.916 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:431] -     EAGLE3 Hidden States | shape=(1, 128, 7680), dtype=float16, device=cuda:0, size=1.875MB
2026-01-22 20:36:03.916 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:456] -     Draft Tree 生成: input_ids range=[257, 385)
2026-01-22 20:36:03.917 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:473] -   [PHASE 3][BROADCAST] Eagle Stable KV | chunk=2, size=0.50MB
2026-01-22 20:36:03.918 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:501] -   [PHASE 3] 完成 | 耗时: 3.01ms
2026-01-22 20:36:03.919 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:507] - [CHUNK 3/5] 完成 | 总耗时: 23.53ms
2026-01-22 20:36:03.919 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:230] - [CHUNK 4/5] 开始处理 | seq_len=128, first=False, last=False
2026-01-22 20:36:03.919 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:245] -   [PHASE 1] 等待接收 Hidden States (from Rank 1)...
2026-01-22 20:36:03.919 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:254] -   [PHASE 1][RECV] Hidden States | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB | chunk_idx=3
2026-01-22 20:36:03.919 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:257] -   [PHASE 1] 完成 | 耗时: 0.20ms
2026-01-22 20:36:03.919 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:263] -   [PHASE 2] 开始计算 Decoder Layers [28, 36)
2026-01-22 20:36:03.919 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:271] -     past_key_values_length=384, seq_with_past=512
2026-01-22 20:36:03.920 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=28 -> Rank 0 | size=0.50MB
2026-01-22 20:36:03.921 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=28 -> Rank 1 | size=0.50MB
2026-01-22 20:36:03.922 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=29 -> Rank 0 | size=0.50MB
2026-01-22 20:36:03.923 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=29 -> Rank 1 | size=0.50MB
2026-01-22 20:36:03.924 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=30 -> Rank 0 | size=0.50MB
2026-01-22 20:36:03.924 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=30 -> Rank 1 | size=0.50MB
2026-01-22 20:36:03.926 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=31 -> Rank 0 | size=0.50MB
2026-01-22 20:36:03.926 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=31 -> Rank 1 | size=0.50MB
2026-01-22 20:36:03.928 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:342] -     [EAGLE] 保存 hidden state layer=32, chunk=3
2026-01-22 20:36:03.928 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=32 -> Rank 0 | size=0.50MB
2026-01-22 20:36:03.928 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=32 -> Rank 1 | size=0.50MB
2026-01-22 20:36:03.930 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=33 -> Rank 0 | size=0.50MB
2026-01-22 20:36:03.930 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=33 -> Rank 1 | size=0.50MB
2026-01-22 20:36:03.932 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=34 -> Rank 0 | size=0.50MB
2026-01-22 20:36:03.933 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=34 -> Rank 1 | size=0.50MB
2026-01-22 20:36:03.935 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=35 -> Rank 0 | size=0.50MB
2026-01-22 20:36:03.935 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=35 -> Rank 1 | size=0.50MB
2026-01-22 20:36:03.935 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:377] -   [PHASE 2] 完成 | layers=8, cache_sent=16, eagle_hidden_sent=0 | 耗时: 16.10ms
2026-01-22 20:36:03.935 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:396] -   [PHASE 3] 执行 Eagle Layer 计算...
2026-01-22 20:36:03.936 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:400] -     Norm 完成 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 20:36:03.936 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:404] -     LM Head 完成 | shape=(1, 128, 151936), dtype=float16, device=cuda:0, size=37.094MB
2026-01-22 20:36:03.936 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:407] -   [PHASE 3][RECV] 等待 Eagle Input Hidden States (chunk=3)...
2026-01-22 20:36:03.936 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:417] -   [PHASE 3][RECV] 收到 2 个 Eagle Hidden (chunk=3) | 耗时: 0.41ms
2026-01-22 20:36:03.936 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:421] -     合并后 Eagle Hidden States 层: [1, 17, 32]
2026-01-22 20:36:03.936 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:680] - [EAGLE] Input Layers 配置: [1, 17, 32] (总层数=36)
2026-01-22 20:36:03.936 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:721] -     [EAGLE] 收集 layer 1 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 20:36:03.936 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:721] -     [EAGLE] 收集 layer 17 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 20:36:03.936 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:721] -     [EAGLE] 收集 layer 32 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 20:36:03.937 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:725] -   [EAGLE] 拼接后 hidden_states | shape=(1, 128, 7680), dtype=float16, device=cuda:0, size=1.875MB
2026-01-22 20:36:03.937 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:431] -     EAGLE3 Hidden States | shape=(1, 128, 7680), dtype=float16, device=cuda:0, size=1.875MB
2026-01-22 20:36:03.937 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:456] -     Draft Tree 生成: input_ids range=[385, 513)
2026-01-22 20:36:03.938 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:473] -   [PHASE 3][BROADCAST] Eagle Stable KV | chunk=3, size=0.50MB
2026-01-22 20:36:03.939 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:501] -   [PHASE 3] 完成 | 耗时: 3.50ms
2026-01-22 20:36:03.940 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:507] - [CHUNK 4/5] 完成 | 总耗时: 21.19ms
2026-01-22 20:36:03.940 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:230] - [CHUNK 5/5] 开始处理 | seq_len=62, first=False, last=True
2026-01-22 20:36:03.940 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:245] -   [PHASE 1] 等待接收 Hidden States (from Rank 1)...
2026-01-22 20:36:03.940 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:254] -   [PHASE 1][RECV] Hidden States | shape=(1, 62, 2560), dtype=float16, device=cuda:0, size=0.303MB | chunk_idx=4
2026-01-22 20:36:03.941 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:257] -   [PHASE 1] 完成 | 耗时: 0.53ms
2026-01-22 20:36:03.941 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:263] -   [PHASE 2] 开始计算 Decoder Layers [28, 36)
2026-01-22 20:36:03.941 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:271] -     past_key_values_length=512, seq_with_past=574
2026-01-22 20:36:03.943 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=28 -> Rank 0 | size=0.24MB
2026-01-22 20:36:03.943 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=28 -> Rank 1 | size=0.24MB
2026-01-22 20:36:03.945 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=29 -> Rank 0 | size=0.24MB
2026-01-22 20:36:03.946 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=29 -> Rank 1 | size=0.24MB
2026-01-22 20:36:03.948 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=30 -> Rank 0 | size=0.24MB
2026-01-22 20:36:03.948 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=30 -> Rank 1 | size=0.24MB
2026-01-22 20:36:03.950 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=31 -> Rank 0 | size=0.24MB
2026-01-22 20:36:03.950 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=31 -> Rank 1 | size=0.24MB
2026-01-22 20:36:03.952 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:342] -     [EAGLE] 保存 hidden state layer=32, chunk=4
2026-01-22 20:36:03.952 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=32 -> Rank 0 | size=0.24MB
2026-01-22 20:36:03.953 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=32 -> Rank 1 | size=0.24MB
2026-01-22 20:36:03.955 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=33 -> Rank 0 | size=0.24MB
2026-01-22 20:36:03.955 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=33 -> Rank 1 | size=0.24MB
2026-01-22 20:36:03.957 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=34 -> Rank 0 | size=0.24MB
2026-01-22 20:36:03.957 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=34 -> Rank 1 | size=0.24MB
2026-01-22 20:36:03.959 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=35 -> Rank 0 | size=0.24MB
2026-01-22 20:36:03.960 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=35 -> Rank 1 | size=0.24MB
2026-01-22 20:36:03.960 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:377] -   [PHASE 2] 完成 | layers=8, cache_sent=16, eagle_hidden_sent=0 | 耗时: 19.19ms
2026-01-22 20:36:03.960 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:396] -   [PHASE 3] 执行 Eagle Layer 计算...
2026-01-22 20:36:03.960 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:400] -     Norm 完成 | shape=(1, 62, 2560), dtype=float16, device=cuda:0, size=0.303MB
2026-01-22 20:36:03.961 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:404] -     LM Head 完成 | shape=(1, 62, 151936), dtype=float16, device=cuda:0, size=17.967MB
2026-01-22 20:36:03.961 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:407] -   [PHASE 3][RECV] 等待 Eagle Input Hidden States (chunk=4)...
2026-01-22 20:36:03.961 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:417] -   [PHASE 3][RECV] 收到 2 个 Eagle Hidden (chunk=4) | 耗时: 0.44ms
2026-01-22 20:36:03.961 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:421] -     合并后 Eagle Hidden States 层: [1, 17, 32]
2026-01-22 20:36:03.962 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:680] - [EAGLE] Input Layers 配置: [1, 17, 32] (总层数=36)
2026-01-22 20:36:03.962 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:721] -     [EAGLE] 收集 layer 1 | shape=(1, 62, 2560), dtype=float16, device=cuda:0, size=0.303MB
2026-01-22 20:36:03.962 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:721] -     [EAGLE] 收集 layer 17 | shape=(1, 62, 2560), dtype=float16, device=cuda:0, size=0.303MB
2026-01-22 20:36:03.962 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:721] -     [EAGLE] 收集 layer 32 | shape=(1, 62, 2560), dtype=float16, device=cuda:0, size=0.303MB
2026-01-22 20:36:03.962 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:725] -   [EAGLE] 拼接后 hidden_states | shape=(1, 62, 7680), dtype=float16, device=cuda:0, size=0.908MB
2026-01-22 20:36:03.962 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:431] -     EAGLE3 Hidden States | shape=(1, 62, 7680), dtype=float16, device=cuda:0, size=0.908MB
2026-01-22 20:36:03.993 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:448] -   [PHASE 3] First Token 采样: 101042
2026-01-22 20:36:03.993 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:456] -     Draft Tree 生成: input_ids range=[513, 575)
2026-01-22 20:36:04.012 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:473] -   [PHASE 3][BROADCAST] Eagle Stable KV | chunk=4, size=0.24MB
2026-01-22 20:36:04.013 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:493] -   [PHASE 3][BROADCAST] Draft Tokens | shape=torch.Size([1, 40])
2026-01-22 20:36:04.013 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:498] -   [PHASE 3] Draft Tokens 广播完成
2026-01-22 20:36:04.013 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:501] -   [PHASE 3] 完成 | 耗时: 53.07ms
2026-01-22 20:36:04.014 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:507] - [CHUNK 5/5] 完成 | 总耗时: 74.30ms
2026-01-22 20:36:04.014 - SpecSoT-Rank2 - INFO - [distributed_prefill.py:512] - [PREFILL] Chunks处理完成，开始 Cache 同步...
2026-01-22 20:36:04.015 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:568] - [SYNC] 最后一个 Rank 等待所有 Cache 同步...
2026-01-22 20:36:04.016 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:585] - [SYNC_OK] Rank 2 Cache 同步完成 | 耗时: 1.23ms
2026-01-22 20:36:04.016 - SpecSoT-Rank2 - INFO - [distributed_prefill.py:594] - [PREFILL] 分布式 Prefill 完成 | Rank=2 | 耗时: 0.454s
2026-01-22 20:36:24.504 - SpecSoT-Rank2 - INFO - [run_specsot.py:414] - 
[统计信息]
2026-01-22 20:36:24.505 - SpecSoT-Rank2 - INFO - [run_specsot.py:415] -   总耗时: 20.95s
2026-01-22 20:36:24.505 - SpecSoT-Rank2 - INFO - [run_specsot.py:416] -   峰值显存: 4422.19 MB
2026-01-22 20:36:24.505 - SpecSoT-Rank2 - INFO - [run_specsot.py:417] -   输出长度: 1901 tokens
2026-01-22 20:36:24.505 - SpecSoT-Rank2 - INFO - [run_specsot.py:418] -   吞吐量: 90.7 tokens/s
2026-01-22 20:36:24.505 - SpecSoT-Rank2 - INFO - [run_specsot.py:419] -   并行分支数: 5
2026-01-22 20:36:24.505 - SpecSoT-Rank2 - INFO - [run_specsot.py:420] -   平均接受长度: 0.53
2026-01-22 20:36:24.505 - SpecSoT-Rank2 - INFO - [run_specsot.py:421] -   平均Draft时间: 5.59 ms
2026-01-22 20:36:24.505 - SpecSoT-Rank2 - INFO - [run_specsot.py:422] -   平均Verify时间: 28.87 ms
2026-01-22 20:36:24.505 - SpecSoT-Rank2 - INFO - [run_specsot.py:423] -   平均Update时间: 1.06 ms
2026-01-22 20:36:24.505 - SpecSoT-Rank2 - INFO - [run_specsot.py:426] - 
[响应预览]
2026-01-22 20:36:24.505 - SpecSoT-Rank2 - INFO - [run_specsot.py:427] - 分析这个问题是否属于需要拆解规划的“复杂任务”：

问题要求“详细建议”，涉及多个独立的方面，如技术动作、训练方法、心理因素、场地条件等，这些部分可以并行考虑，因此属于复杂任务，必须拆解规划。

执行方法B，生成思维骨架：

#### 技术动作规范【212】:......

#### 训练计划制定【189】:......

#### 心理素质提升【199】:......

#### 场地与装备优化【156】:......

#### 比赛经验积累【204】:......

####%%%%

#### 技术动作规范【212】: 
正确的投篮姿势是保持身体平衡，双脚分开与肩同宽，膝盖微屈，重心放在前脚掌。出手时，手臂自然伸直，手腕下压，球从指尖弹出。练习时要注意保持手臂与身体成直线，避免过度弯曲或伸直。此外，投篮时的发力顺序也很重要，先蹬地，再转胯，最后出手，确保动作连贯。可以通过慢动作练习和录像回放来纠正错误动作，提高动作的准确性和稳定性。


#### 训练计划制定【189】: 
制定科学的训练计划是提高投篮命中率的关键。首先，要明确训练目标，例如提升远距离投篮能力或增强近距离投篮的...
2026-01-22 20:36:24.505 - SpecSoT-Rank2 - INFO - [run_specsot.py:481] - 正在清理分布式资源...
2026-01-22 20:36:24.505 - SpecSoT-Rank2 - INFO - [distributed_prefill.py:155] - [CLEANUP] 通信统计: {'draft_tokens_sent': 2, 'draft_tokens_recv': 0, 'hidden_sent': 0, 'hidden_recv': 5, 'eagle_input_hidden_sent': 0, 'eagle_input_hidden_recv': 10, 'base_cache_sent': 80, 'base_cache_recv': 140, 'eagle_cache_sent': 10, 'eagle_cache_recv': 0, 'aggregated_sends': 0, 'forwarded_messages': 0}
2026-01-22 20:36:24.550 - SpecSoT-Rank2 - INFO - [distributed_prefill.py:158] - [CLEANUP] 分布式Prefill管理器已清理
2026-01-22 20:36:24.550 - SpecSoT-Rank2 - INFO - [run_specsot.py:483] - 分布式资源已清理
2026-01-22 20:36:24.550 - SpecSoT-Rank2 - INFO - [run_specsot.py:485] - Worker 执行完成
 20:36:03.789 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-22 20:36:03.789 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=17, chunk_idx=4, seq_id=129, latency=1191.16ms
2026-01-22 20:36:03.789 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-22 20:36:03.792 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 0 | layer_idx=8, chunk_idx=4, seq_id=139, latency=1704.38ms
2026-01-22 20:36:03.792 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-22 20:36:03.793 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=18, chunk_idx=4, seq_id=131, latency=1192.98ms
2026-01-22 20:36:03.793 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-22 20:36:03.794 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 0 | layer_idx=9, chunk_idx=4, seq_id=141, latency=1703.35ms
2026-01-22 20:36:03.794 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-22 20:36:03.795 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=19, chunk_idx=4, seq_id=133, latency=1192.98ms
2026-01-22 20:36:03.795 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-22 20:36:03.795 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 0 | layer_idx=10, chunk_idx=4, seq_id=143, latency=1698.01ms
2026-01-22 20:36:03.796 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-22 20:36:03.796 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=20, chunk_idx=4, seq_id=135, latency=1193.21ms
2026-01-22 20:36:03.796 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-22 20:36:03.801 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 0 | layer_idx=11, chunk_idx=4, seq_id=145, latency=1700.28ms
2026-01-22 20:36:03.801 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-22 20:36:03.802 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=21, chunk_idx=4, seq_id=137, latency=1196.86ms
2026-01-22 20:36:03.802 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-22 20:36:03.803 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 0 | layer_idx=12, chunk_idx=4, seq_id=147, latency=1699.36ms
2026-01-22 20:36:03.803 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-22 20:36:03.808 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=22, chunk_idx=4, seq_id=139, latency=1201.62ms
2026-01-22 20:36:03.808 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-22 20:36:03.809 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 0 | layer_idx=13, chunk_idx=4, seq_id=149, latency=1702.77ms
2026-01-22 20:36:03.809 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-22 20:36:03.811 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=23, chunk_idx=4, seq_id=141, latency=1203.20ms
2026-01-22 20:36:03.811 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-22 20:36:03.811 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=28, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.812 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=28, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.813 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=24, chunk_idx=4, seq_id=143, latency=1204.00ms
2026-01-22 20:36:03.814 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-22 20:36:03.815 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=1, layer_idx=28, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=3.35ms
2026-01-22 20:36:03.815 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=25, chunk_idx=4, seq_id=145, latency=1204.34ms
2026-01-22 20:36:03.815 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-22 20:36:03.817 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=2, layer_idx=28, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.76ms
2026-01-22 20:36:03.817 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=26, chunk_idx=4, seq_id=147, latency=1204.71ms
2026-01-22 20:36:03.817 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-22 20:36:03.818 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:239] - [RECV] HIDDEN from rank 1 | chunk_idx=4, seq_id=150, latency=1203.88ms
2026-01-22 20:36:03.818 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:243] -   hidden_state: shape=(1, 62, 2560), dtype=float16, device=cuda:0, size=0.303MB
2026-01-22 20:36:03.820 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=27, chunk_idx=4, seq_id=149, latency=1205.58ms
2026-01-22 20:36:03.820 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-22 20:36:03.820 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=29, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.820 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=29, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.821 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=3, layer_idx=29, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.18ms
2026-01-22 20:36:03.823 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=4, layer_idx=29, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.97ms
2026-01-22 20:36:03.823 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=30, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.823 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=30, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.824 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=5, layer_idx=30, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.02ms
2026-01-22 20:36:03.825 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=6, layer_idx=30, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.94ms
2026-01-22 20:36:03.825 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=31, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.825 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=31, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.826 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=7, layer_idx=31, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.97ms
2026-01-22 20:36:03.827 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=8, layer_idx=31, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.92ms
2026-01-22 20:36:03.827 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=32, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.827 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=32, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.828 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=9, layer_idx=32, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.95ms
2026-01-22 20:36:03.829 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=10, layer_idx=32, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.92ms
2026-01-22 20:36:03.830 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=33, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.830 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=33, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.831 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=11, layer_idx=33, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.96ms
2026-01-22 20:36:03.832 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=12, layer_idx=33, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.94ms
2026-01-22 20:36:03.832 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=34, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.832 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=34, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.833 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=13, layer_idx=34, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.97ms
2026-01-22 20:36:03.834 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=35, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.834 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=35, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.834 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=14, layer_idx=34, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.12ms
2026-01-22 20:36:03.835 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:582] - [WAIT] 等待接收 ALL_EAGLE_INPUT_HIDDEN | expected_layers=[1, 17], chunk_idx=0, my_range=[28, 36), timeout=60.0s
2026-01-22 20:36:03.835 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:606] - [RECV_OK] EAGLE_INPUT_HIDDEN | layer_idx=1, chunk_idx=0, from rank 0, remaining={17}
2026-01-22 20:36:03.836 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:610] -   hidden: shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 20:36:03.836 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:606] - [RECV_OK] EAGLE_INPUT_HIDDEN | layer_idx=17, chunk_idx=0, from rank 1, remaining=set()
2026-01-22 20:36:03.836 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=15, layer_idx=35, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.16ms
2026-01-22 20:36:03.836 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:610] -   hidden: shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 20:36:03.836 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:627] - [RECV_OK] ALL_EAGLE_INPUT_HIDDEN 全部接收完成 | chunk_idx=0, layers=[1, 17], wait_time=0.69ms
2026-01-22 20:36:03.837 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=16, layer_idx=35, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.19ms
2026-01-22 20:36:03.863 - SpecSoT-Rank2-Comm - INFO - [p2p_comm_manager.py:348] - [BROADCAST] EAGLE_STABLE_KV -> targets=[0, 1] | chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.863 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:313] - [QUEUE] EAGLE_CACHE -> rank 0 | chunk_idx=0, incremental=True, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.863 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:313] - [QUEUE] EAGLE_CACHE -> rank 1 | chunk_idx=0, incremental=True, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.865 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:162] - [SEND] EAGLE_CACHE -> rank 0 | seq_id=17, chunk_idx=0, incremental=True, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.16ms
2026-01-22 20:36:03.866 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:162] - [SEND] EAGLE_CACHE -> rank 1 | seq_id=18, chunk_idx=0, incremental=True, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.09ms
2026-01-22 20:36:03.873 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:430] - [WAIT] 等待接收 HIDDEN (src_rank=1, timeout=60.0s)
2026-01-22 20:36:03.873 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:448] - [RECV_OK] HIDDEN 接收成功 | from rank 1, chunk_idx=1, wait_time=0.02ms
2026-01-22 20:36:03.873 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:453] -   hidden: shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 20:36:03.874 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=28, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.875 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=28, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.876 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=19, layer_idx=28, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.99ms
2026-01-22 20:36:03.877 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=20, layer_idx=28, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.93ms
2026-01-22 20:36:03.877 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=29, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.877 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=29, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.878 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=21, layer_idx=29, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.98ms
2026-01-22 20:36:03.879 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=22, layer_idx=29, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.93ms
2026-01-22 20:36:03.879 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=30, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.879 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=30, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.880 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=23, layer_idx=30, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.95ms
2026-01-22 20:36:03.881 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=24, layer_idx=30, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.88ms
2026-01-22 20:36:03.881 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=31, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.881 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=31, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.882 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=25, layer_idx=31, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.95ms
2026-01-22 20:36:03.883 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=26, layer_idx=31, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.89ms
2026-01-22 20:36:03.883 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=32, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.884 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=32, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.885 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=27, layer_idx=32, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.94ms
2026-01-22 20:36:03.886 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=28, layer_idx=32, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.93ms
2026-01-22 20:36:03.886 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=33, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.886 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=33, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.887 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=29, layer_idx=33, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.98ms
2026-01-22 20:36:03.888 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=30, layer_idx=33, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.92ms
2026-01-22 20:36:03.888 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=34, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.888 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=34, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.889 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=31, layer_idx=34, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.97ms
2026-01-22 20:36:03.890 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=35, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.890 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=32, layer_idx=34, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.97ms
2026-01-22 20:36:03.890 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=35, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.891 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=33, layer_idx=35, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.09ms
2026-01-22 20:36:03.891 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:582] - [WAIT] 等待接收 ALL_EAGLE_INPUT_HIDDEN | expected_layers=[1, 17], chunk_idx=1, my_range=[28, 36), timeout=60.0s
2026-01-22 20:36:03.892 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:606] - [RECV_OK] EAGLE_INPUT_HIDDEN | layer_idx=1, chunk_idx=1, from rank 0, remaining={17}
2026-01-22 20:36:03.892 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:610] -   hidden: shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 20:36:03.892 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:606] - [RECV_OK] EAGLE_INPUT_HIDDEN | layer_idx=17, chunk_idx=1, from rank 1, remaining=set()
2026-01-22 20:36:03.892 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:610] -   hidden: shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 20:36:03.892 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:627] - [RECV_OK] ALL_EAGLE_INPUT_HIDDEN 全部接收完成 | chunk_idx=1, layers=[1, 17], wait_time=0.20ms
2026-01-22 20:36:03.893 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=34, layer_idx=35, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.39ms
2026-01-22 20:36:03.894 - SpecSoT-Rank2-Comm - INFO - [p2p_comm_manager.py:348] - [BROADCAST] EAGLE_STABLE_KV -> targets=[0, 1] | chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.894 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:313] - [QUEUE] EAGLE_CACHE -> rank 0 | chunk_idx=1, incremental=True, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.894 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:313] - [QUEUE] EAGLE_CACHE -> rank 1 | chunk_idx=1, incremental=True, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.895 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:162] - [SEND] EAGLE_CACHE -> rank 0 | seq_id=35, chunk_idx=1, incremental=True, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.89ms
2026-01-22 20:36:03.895 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:430] - [WAIT] 等待接收 HIDDEN (src_rank=1, timeout=60.0s)
2026-01-22 20:36:03.895 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:448] - [RECV_OK] HIDDEN 接收成功 | from rank 1, chunk_idx=2, wait_time=0.03ms
2026-01-22 20:36:03.895 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:453] -   hidden: shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 20:36:03.896 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:162] - [SEND] EAGLE_CACHE -> rank 1 | seq_id=36, chunk_idx=1, incremental=True, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.03ms
2026-01-22 20:36:03.897 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=28, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.898 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=28, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.902 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=37, layer_idx=28, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=4.24ms
2026-01-22 20:36:03.903 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=38, layer_idx=28, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.82ms
2026-01-22 20:36:03.903 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=29, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.903 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=29, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.904 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=39, layer_idx=29, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.83ms
2026-01-22 20:36:03.905 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=40, layer_idx=29, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.78ms
2026-01-22 20:36:03.905 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=30, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.905 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=30, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.906 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=41, layer_idx=30, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.83ms
2026-01-22 20:36:03.906 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=42, layer_idx=30, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.73ms
2026-01-22 20:36:03.907 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=31, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.907 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=31, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.908 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=43, layer_idx=31, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.83ms
2026-01-22 20:36:03.908 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=44, layer_idx=31, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.79ms
2026-01-22 20:36:03.909 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=32, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.909 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=32, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.909 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=45, layer_idx=32, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.81ms
2026-01-22 20:36:03.910 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=46, layer_idx=32, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.74ms
2026-01-22 20:36:03.910 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=33, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.911 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=33, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.911 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=47, layer_idx=33, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.80ms
2026-01-22 20:36:03.912 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=48, layer_idx=33, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.76ms
2026-01-22 20:36:03.912 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=34, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.912 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=34, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.913 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=49, layer_idx=34, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.81ms
2026-01-22 20:36:03.914 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=50, layer_idx=34, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.75ms
2026-01-22 20:36:03.914 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=35, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.914 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=35, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.915 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:582] - [WAIT] 等待接收 ALL_EAGLE_INPUT_HIDDEN | expected_layers=[1, 17], chunk_idx=2, my_range=[28, 36), timeout=60.0s
2026-01-22 20:36:03.915 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:606] - [RECV_OK] EAGLE_INPUT_HIDDEN | layer_idx=1, chunk_idx=2, from rank 0, remaining={17}
2026-01-22 20:36:03.915 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:610] -   hidden: shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 20:36:03.915 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:606] - [RECV_OK] EAGLE_INPUT_HIDDEN | layer_idx=17, chunk_idx=2, from rank 1, remaining=set()
2026-01-22 20:36:03.915 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:610] -   hidden: shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 20:36:03.915 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=51, layer_idx=35, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.99ms
2026-01-22 20:36:03.915 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:627] - [RECV_OK] ALL_EAGLE_INPUT_HIDDEN 全部接收完成 | chunk_idx=2, layers=[1, 17], wait_time=0.43ms
2026-01-22 20:36:03.917 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=52, layer_idx=35, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.13ms
2026-01-22 20:36:03.917 - SpecSoT-Rank2-Comm - INFO - [p2p_comm_manager.py:348] - [BROADCAST] EAGLE_STABLE_KV -> targets=[0, 1] | chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.917 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:313] - [QUEUE] EAGLE_CACHE -> rank 0 | chunk_idx=2, incremental=True, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.918 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:313] - [QUEUE] EAGLE_CACHE -> rank 1 | chunk_idx=2, incremental=True, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.918 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:162] - [SEND] EAGLE_CACHE -> rank 0 | seq_id=53, chunk_idx=2, incremental=True, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.73ms
2026-01-22 20:36:03.919 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:430] - [WAIT] 等待接收 HIDDEN (src_rank=1, timeout=60.0s)
2026-01-22 20:36:03.919 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:448] - [RECV_OK] HIDDEN 接收成功 | from rank 1, chunk_idx=3, wait_time=0.12ms
2026-01-22 20:36:03.919 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:453] -   hidden: shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 20:36:03.919 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:162] - [SEND] EAGLE_CACHE -> rank 1 | seq_id=54, chunk_idx=2, incremental=True, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.92ms
2026-01-22 20:36:03.920 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=28, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.921 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=28, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.921 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=55, layer_idx=28, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.81ms
2026-01-22 20:36:03.922 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=56, layer_idx=28, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.78ms
2026-01-22 20:36:03.922 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=29, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.922 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=29, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.923 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=57, layer_idx=29, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.85ms
2026-01-22 20:36:03.924 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=30, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.924 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=58, layer_idx=29, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.85ms
2026-01-22 20:36:03.924 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=30, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.925 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=59, layer_idx=30, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.77ms
2026-01-22 20:36:03.926 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=60, layer_idx=30, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.76ms
2026-01-22 20:36:03.926 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=31, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.926 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=31, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.927 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=61, layer_idx=31, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.85ms
2026-01-22 20:36:03.928 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=62, layer_idx=31, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.84ms
2026-01-22 20:36:03.928 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=32, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.928 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=32, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.929 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=63, layer_idx=32, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.03ms
2026-01-22 20:36:03.930 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=64, layer_idx=32, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.77ms
2026-01-22 20:36:03.930 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=33, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.930 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=33, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.931 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=65, layer_idx=33, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.82ms
2026-01-22 20:36:03.932 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=66, layer_idx=33, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.77ms
2026-01-22 20:36:03.932 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=34, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.932 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=34, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.933 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=67, layer_idx=34, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.80ms
2026-01-22 20:36:03.934 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=68, layer_idx=34, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.74ms
2026-01-22 20:36:03.935 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=35, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.935 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=35, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.936 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:582] - [WAIT] 等待接收 ALL_EAGLE_INPUT_HIDDEN | expected_layers=[1, 17], chunk_idx=3, my_range=[28, 36), timeout=60.0s
2026-01-22 20:36:03.936 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=69, layer_idx=35, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.01ms
2026-01-22 20:36:03.936 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:606] - [RECV_OK] EAGLE_INPUT_HIDDEN | layer_idx=1, chunk_idx=3, from rank 0, remaining={17}
2026-01-22 20:36:03.936 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:610] -   hidden: shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 20:36:03.936 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:606] - [RECV_OK] EAGLE_INPUT_HIDDEN | layer_idx=17, chunk_idx=3, from rank 1, remaining=set()
2026-01-22 20:36:03.936 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:610] -   hidden: shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 20:36:03.936 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:627] - [RECV_OK] ALL_EAGLE_INPUT_HIDDEN 全部接收完成 | chunk_idx=3, layers=[1, 17], wait_time=0.38ms
2026-01-22 20:36:03.937 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=70, layer_idx=35, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.22ms
2026-01-22 20:36:03.939 - SpecSoT-Rank2-Comm - INFO - [p2p_comm_manager.py:348] - [BROADCAST] EAGLE_STABLE_KV -> targets=[0, 1] | chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.939 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:313] - [QUEUE] EAGLE_CACHE -> rank 0 | chunk_idx=3, incremental=True, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.939 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:313] - [QUEUE] EAGLE_CACHE -> rank 1 | chunk_idx=3, incremental=True, key_shape=(1, 8, 128, 128)
2026-01-22 20:36:03.940 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:162] - [SEND] EAGLE_CACHE -> rank 0 | seq_id=71, chunk_idx=3, incremental=True, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.78ms
2026-01-22 20:36:03.940 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:430] - [WAIT] 等待接收 HIDDEN (src_rank=1, timeout=60.0s)
2026-01-22 20:36:03.940 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:448] - [RECV_OK] HIDDEN 接收成功 | from rank 1, chunk_idx=4, wait_time=0.05ms
2026-01-22 20:36:03.940 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:453] -   hidden: shape=(1, 62, 2560), dtype=float16, device=cuda:0, size=0.303MB
2026-01-22 20:36:03.941 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:162] - [SEND] EAGLE_CACHE -> rank 1 | seq_id=72, chunk_idx=3, incremental=True, key_shape=(1, 8, 128, 128), size=514.60KB, time=0.95ms
2026-01-22 20:36:03.943 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=28, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-22 20:36:03.943 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=28, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-22 20:36:03.944 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=73, layer_idx=28, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.75ms
2026-01-22 20:36:03.944 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=74, layer_idx=28, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.59ms
2026-01-22 20:36:03.945 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=29, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-22 20:36:03.945 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=29, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-22 20:36:03.946 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=75, layer_idx=29, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.72ms
2026-01-22 20:36:03.947 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=76, layer_idx=29, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.61ms
2026-01-22 20:36:03.947 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=30, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-22 20:36:03.948 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=30, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-22 20:36:03.948 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=77, layer_idx=30, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.68ms
2026-01-22 20:36:03.949 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=78, layer_idx=30, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.59ms
2026-01-22 20:36:03.950 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=31, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-22 20:36:03.950 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=31, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-22 20:36:03.951 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=79, layer_idx=31, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.77ms
2026-01-22 20:36:03.951 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=80, layer_idx=31, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.59ms
2026-01-22 20:36:03.952 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=32, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-22 20:36:03.953 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=32, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-22 20:36:03.953 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=81, layer_idx=32, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.72ms
2026-01-22 20:36:03.954 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=82, layer_idx=32, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.61ms
2026-01-22 20:36:03.955 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=33, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-22 20:36:03.955 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=33, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-22 20:36:03.955 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=83, layer_idx=33, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.72ms
2026-01-22 20:36:03.956 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=84, layer_idx=33, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.57ms
2026-01-22 20:36:03.957 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=34, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-22 20:36:03.957 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=34, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-22 20:36:03.958 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=85, layer_idx=34, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.71ms
2026-01-22 20:36:03.958 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=86, layer_idx=34, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.58ms
2026-01-22 20:36:03.959 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=35, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-22 20:36:03.960 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=35, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-22 20:36:03.960 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=87, layer_idx=35, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.76ms
2026-01-22 20:36:03.961 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:582] - [WAIT] 等待接收 ALL_EAGLE_INPUT_HIDDEN | expected_layers=[1, 17], chunk_idx=4, my_range=[28, 36), timeout=60.0s
2026-01-22 20:36:03.961 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:606] - [RECV_OK] EAGLE_INPUT_HIDDEN | layer_idx=1, chunk_idx=4, from rank 0, remaining={17}
2026-01-22 20:36:03.961 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=88, layer_idx=35, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.95ms
2026-01-22 20:36:03.961 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:610] -   hidden: shape=(1, 62, 2560), dtype=float16, device=cuda:0, size=0.303MB
2026-01-22 20:36:03.961 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:606] - [RECV_OK] EAGLE_INPUT_HIDDEN | layer_idx=17, chunk_idx=4, from rank 1, remaining=set()
2026-01-22 20:36:03.961 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:610] -   hidden: shape=(1, 62, 2560), dtype=float16, device=cuda:0, size=0.303MB
2026-01-22 20:36:03.961 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:627] - [RECV_OK] ALL_EAGLE_INPUT_HIDDEN 全部接收完成 | chunk_idx=4, layers=[1, 17], wait_time=0.41ms
2026-01-22 20:36:04.012 - SpecSoT-Rank2-Comm - INFO - [p2p_comm_manager.py:348] - [BROADCAST] EAGLE_STABLE_KV -> targets=[0, 1] | chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-22 20:36:04.012 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:313] - [QUEUE] EAGLE_CACHE -> rank 0 | chunk_idx=4, incremental=True, key_shape=(1, 8, 62, 128)
2026-01-22 20:36:04.013 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:313] - [QUEUE] EAGLE_CACHE -> rank 1 | chunk_idx=4, incremental=True, key_shape=(1, 8, 62, 128)
2026-01-22 20:36:04.013 - SpecSoT-Rank2-Comm - INFO - [p2p_comm_manager.py:207] - [BROADCAST] DRAFT_TOKENS -> targets=[0, 1] | draft_shape=(1, 40)
2026-01-22 20:36:04.013 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:211] -   retrieve_shape=(1, 22, 6), mask_shape=(1, 1, 40, 40)
2026-01-22 20:36:04.013 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:162] - [SEND] EAGLE_CACHE -> rank 0 | seq_id=89, chunk_idx=4, incremental=True, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.76ms
2026-01-22 20:36:04.014 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:118] - [SEND] DRAFT_TOKENS -> rank 0 | seq_id=91, draft_shape=(1, 40), size=9.33KB, time=0.56ms
2026-01-22 20:36:04.014 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:118] - [SEND] DRAFT_TOKENS -> rank 1 | seq_id=92, draft_shape=(1, 40), size=9.33KB, time=0.38ms
2026-01-22 20:36:04.015 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:162] - [SEND] EAGLE_CACHE -> rank 1 | seq_id=90, chunk_idx=4, incremental=True, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.73ms
2026-01-22 20:36:04.016 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:776] - [WAIT] 等待接收所有 Cache | expected_base_caches=0, expected_eagle_caches=0, my_layer_range=[28, 36), timeout=60.0s
2026-01-22 20:36:04.016 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:781] -   待接收的 base cache: []
2026-01-22 20:36:04.016 - SpecSoT-Rank2-Comm - INFO - [base_comm_manager.py:858] - [SYNC_OK] 所有 Cache 接收完成 | base_cache=0, eagle_cache=0, wait_time=1.21ms
2026-01-22 20:36:24.532 - SpecSoT-Rank2-Comm - INFO - [p2p_comm_manager.py:102] - [THREAD] 发送线程退出
2026-01-22 20:36:24.545 - SpecSoT-Rank2-Comm - INFO - [base_comm_manager.py:189] - 接收线程退出
2026-01-22 20:36:24.550 - SpecSoT-Rank2-Comm - INFO - [base_comm_manager.py:329] - 通信管理器已停止
