2026-01-26 11:45:11.260 - SpecSoT-Rank2-Comm - INFO - [logging_utils.py:155] - 日志将保存到: /data/home/chenyu/Coding/SD+SoT/SpecSoT/logs/rank_2.log
22026-01-26 11:45:15.270 - SpecSoT-Rank2-Model - INFO - [specsot_model.py:348] - 分布式推理已启用: DistributedConfig(rank=2/2, layer_splits=[14, 28], comm_mode=p2p)
2026-01-26 11:45:15.270 - SpecSoT-Rank2-Model - INFO - [specsot_model.py:168] - 预初始化 VocabScanner 和 SemanticLogitsProcessor...
2026-01-26 11:45:15.280 - SpecSoT-Rank2-Model - INFO - [specsot_m2026-01-26 11:45:15.283 - SpecSoT-Rank2 - INFO - [run_spec2026-01-26 11:45:15.291 - SpecSoT-Rank2-Model - INFO - [specsot_model.py:661] - 使用 FSM 语义约束进行骨架生成
2026-01-26 11:45:16.226 - SpecSoT-Rank2-Model - INFO - [specsot_model.py:719] - Generated Skeleton:  [PLAN]
1.<154><Search>[-]Top 3 Cities in China
2.<543><Search>[-]Top 3 Cities in China
3.<456><Search>[-]Top 3 Cities in China
[END]</s><s>
2026-01-26 11:45:16.226 - SpecSoT-Rank2-Model - INFO - [specsot_model.py:726] - Skeleton generation completed in 0.938s
2026-01-26 11:45:16.227 - SpecSoT-Rank2-Model - INFO - [specsot_model.py:745] - Detected 3 parallel tasks: ['Top 3 Cities in China', 'Top 3 Cities in China', 'Top 3 Cities in China']
2026-01-26 11:45:16.228 - SpecSoT-Rank2-Model - INFO - [specsot_model.py:755] - Predicted lengths: [154, 543, 456]
2026-01-26 11:45:16.317 - SpecSoT-Rank2-Model - DEBUG - [specsot_model.py:803] - Parallel Decoding Step 1
2026-01-26 11:45:18.021 - SpecSoT-Rank2-Model - DEBUG - [specsot_model.py:803] - Parallel Decoding Step 51
2026-01-26 11:45:19.801 - SpecSoT-Rank2-Model - DEBUG - [specsot_model.py:803] - Parallel Decoding Step 101
2026-01-26 11:45:21.669 - SpecSoT-Rank2-Model - DEBUG - [specsot_model.py:803] - Parallel Decoding Step 151
2026-01-26 11:45:23.616 - SpecSoT-Rank2-Model - DEBUG - [specsot_model.py:803] - Parallel Decoding Step 201
2026-01-26 11:45:25.675 - SpecSoT-Rank2-Model - DEBUG - [specsot_model.py:803] - Parallel Decoding Step 251
2026-01-26 11:45:27.804 - SpecSoT-Rank2-Model - WARNING - [specsot_model.py:799] - Incomplete branches due to KV cache limit: [0, 1, 2]
2026-01-26 11:45:27.804 - SpecSoT-Rank2-Model - INFO - [specsot_model.py:843] - Avg accepted lengths: 6.41, Avg draft time: 0.0074s, Avg update time: 0.0009s, Avg verify time: 0.0303s
2026-01-26 11:45:27.804 - SpecSoT-Rank2-Model - INFO - [specsot_model.py:852] - Parallel decoding completed in 11.575s
3 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:212] -   Chunk数量: 5 (chunk_size=128)
2026-01-26 11:45:15.293 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:675] - [EAGLE] Input Layers 配置: [1, 15, 28] (总层数=32)
2026-01-26 11:45:15.293 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:216] -   Eagle Input Layers: [1, 15, 28]
2026-01-26 11:45:15.293 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:230] - [CHUNK 1/5] 开始处理 | seq_len=128, first=True, last=False
2026-01-26 12026-01-26 11:45:15.293 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:430] - [WAIT] 等待接收 HIDDEN (src_rank=1, t2026-01-26 11:45:15.310 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:254] -   [PHASE 1][RECV] Hidden States | shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB | chunk_idx=0
2026-01-26 11:45:15.310 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:257] -   [PHASE 1] 完成 | 耗时: 17.25ms
2026-01-26 11:45:15.310 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:263] -   [PHASE 2] 开始计算 Decoder Layers [28, 32)
2026-01-26 11:45:15.311 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:271] -     past_key_values_length=0, seq_with_past=128
2026-01-26 11:45:15.484 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=28 -> Rank 0 | size=2.00MB
2026-01-26 11:45:15.485 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=28 -> Rank 1 | size=2.00MB
2026-01-26 11:45:15.500 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=29 -> Rank 0 | size=2.00MB
2026-01-26 11:45:15.501 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=29 -> Rank 1 | size=2.00MB
2026-01-26 11:45:15.511 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=30 -> Rank 0 | size=2.00MB
2026-01-26 11:45:15.512 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=30 -> Rank 1 | size=2.00MB
2026-01-26 11:45:15.524 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=31 -> Rank 0 | size=2.00MB
2026-01-26 11:45:15.525 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=31 -> Rank 1 | size=2.00MB
2026-01-26 11:45:15.525 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:377] -   [PHASE 2] 完成 | layers=4, cache_sent=8, eagle_hidden_sent=0 | 耗时: 214.78ms
2026-01-26 11:45:15.525 - SpecSoT-Rank2 - DEBUG - [distri2026-01-26 11:45:15 - SpecSoT-Rank2 - INFO - [PREFILL] Chunks处理完成，开始 Cache 同步...
2026-01-26 11:45:15 - SpecSoT-Rank2 - INFO - [PREFILL] 分布式 Prefill 完成 | Rank=2 | 耗时: 0.440s
2026-01-26 11:45:16 - SpecSoT-Rank2-Model - INFO - Generated Skeleton:  [PLAN]
1.<154><Search>[-]Top 3 Cities in China
2.<543><Search>[-]Top 3 Cities in China
3.<456><Search>[-]Top 3 Cities in China
[END]</s><s>
2026-01-26 11:45:16 - SpecSoT-Rank2-Model - INFO - Skeleton generation completed in 0.938s
2026-01-26 11:45:16 - SpecSoT-Rank2-Model - INFO - Detected 3 parallel tasks: ['Top 3 Cities in China', 'Top 3 Cities in China', 'Top 3 Cities in China']
2026-01-26 11:45:16 - SpecSoT-Rank2-Model - INFO - Predicted lengths: [154, 543, 456]
Stopping due to KV cache limit: peak 3691 >= max 3678
2026-01-26 11:45:27 - SpecSoT-Rank2-Model - WARNING - Incomplete branches due to KV cache limit: [0, 1, 2]
2026-01-26 11:45:27 - SpecSoT-Rank2-Model - INFO - Avg accepted lengths: 6.41, Avg draft time: 0.0074s, Avg update time: 0.0009s, Avg verify time: 0.0303s
2026-01-26 11:45:27 - SpecSoT-Rank2-Model - INFO - Parallel decoding completed in 11.575s
2026-01-26 11:45:27 - SpecSoT-Rank2 - INFO - 
[统计信息]
2026-01-26 11:45:27 - SpecSoT-Rank2 - INFO -   推理时间: 12.52s
2026-01-26 11:45:27 - SpecSoT-Rank2 - INFO -   Skeleton阶段时间: 0.94s
2026-01-26 11:45:27 - SpecSoT-Rank2 - INFO -   Parallel阶段时间: 11.58s
2026-01-26 11:45:27 - SpecSoT-Rank2 - INFO -   峰值显存: 3552.38 MB
2026-01-26 11:45:27 - SpecSoT-Rank2 - INFO -   输出长度: 2914 tokens
2026-01-26 11:45:27 - SpecSoT-Rank2 - INFO -   吞吐量: 232.8 tokens/s
2026-01-26 11:45:27 - SpecSoT-Rank2 - INFO -   并行分支数: 3
2026-01-26 11:45:27 - SpecSoT-Rank2 - INFO -   平均接受长度: 6.41
2026-01-26 11:45:27 - SpecSoT-Rank2 - INFO -   平均Draft时间: 7.36 ms
2026-01-26 11:45:27 - SpecSoT-Rank2 - INFO -   平均Verify时间: 30.26 ms
2026-01-26 11:45:27 - SpecSoT-Rank2 - INFO -   平均Update时间: 0.88 ms
2026-01-26 11:45:27 - SpecSoT-Rank2 - INFO - 
[响应预览]
2026-01-26 11:45:27 - SpecSoT-Rank2 - INFO - [PLAN]
1.<154><Search>[-]Top 3 Cities in China
2.<543><Search>[-]Top 3 Cities in China
3.<456><Search>[-]Top 3 Cities in China
[END] 

## 1. Top 3 Cities in China
 China is home to some of the most populous and influential cities in the world. With a population of over 1.4 billion people, the country is a major player in global politics, economics, and culture. Here are the top 3 cities in China that you should know about:

1. Beijing: The capital of China, Beijing is a city with a rich history and a vibrant present. It is home to some of the country's most iconic landmarks, including the Great Wall of China, the Forbidden City, and the Temple of Heaven. The city is also a hub for technology and innovation, with a thriving startup scene and a number of world-class universities.
2. Shanghai: Known as the "Pearl of the Orient," Shanghai is China's largest city and one of the world's most important financial centers. It is home to some of the country's most impressive skyscrapers, as well...
2026-01-26 11:45:27 - SpecSoT-Rank2 - INFO - [CLEANUP] 通信统计: {'draft_tokens_sent': 2, 'draft_tokens_recv': 0, 'hidden_sent': 0, 'hidden_recv': 5, 'eagle_input_hidden_sent': 0, 'eagle_input_hidden_recv': 0, 'base_cache_sent': 40, 'base_cache_recv': 140, 'eagle_cache_sent': 10, 'eagle_cache_recv': 0, 'aggregated_sends': 0, 'forwarded_messages': 0}
2026-01-26 11:45:27 - SpecSoT-Rank2 - INFO - Worker 执行完成
CACHE] layer=10, chunk=0 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.577 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=23, chunk=0 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.578 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=11, chunk=0 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.578 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=24, chunk=0 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.579 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=12, chunk=0 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.579 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=25, chunk=0 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.579 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=13, chunk=0 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.580 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=26, chunk=0 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.580 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=0, chunk=1 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.580 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=27, chunk=0 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.581 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=1, chunk=1 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.581 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=14, chunk=1 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.581 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=2, chunk=1 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.581 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=15, chunk=1 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.582 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=3, chunk=1 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.582 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=16, chunk=1 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.582 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=4, chunk=1 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.582 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=17, chunk=1 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.583 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=5, chunk=1 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.583 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=18, chunk=1 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.583 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=6, chunk=1 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.584 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=7, chunk=1 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.584 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=19, chunk=1 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.585 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=8, chunk=1 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.585 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=20, chunk=1 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.585 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=9, chunk=1 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.586 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=21, chunk=1 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.586 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=10, chunk=1 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.586 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=22, chunk=1 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.586 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=11, chunk=1 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.587 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=23, chunk=1 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.587 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=12, chunk=1 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.588 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=24, chunk=1 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.588 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=13, chunk=1 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.588 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=25, chunk=1 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.589 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=0, chunk=2 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.589 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=26, chunk=1 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.589 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=1, chunk=2 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.590 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=27, chunk=1 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.590 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=2, chunk=2 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.590 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=3, chunk=2 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.591 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=14, chunk=2 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.591 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=4, chunk=2 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.592 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=15, chunk=2 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.592 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=5, chunk=2 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.592 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=16, chunk=2 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.593 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=6, chunk=2 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.593 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=17, chunk=2 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.593 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=7, chunk=2 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.594 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=18, chunk=2 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.594 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=8, chunk=2 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.594 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=19, chunk=2 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.594 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=9, chunk=2 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.595 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=20, chunk=2 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.596 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=10, chunk=2 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.596 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=21, chunk=2 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.596 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=11, chunk=2 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.596 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=22, chunk=2 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.597 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=12, chunk=2 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.597 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=23, chunk=2 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.597 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=13, chunk=2 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.598 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=0, chunk=3 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.598 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=24, chunk=2 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.599 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=1, chunk=3 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.599 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=25, chunk=2 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.599 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=2, chunk=3 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.600 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=26, chunk=2 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.600 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=3, chunk=3 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.600 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=27, chunk=2 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.601 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=4, chunk=3 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.601 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=14, chunk=3 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.602 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=5, chunk=3 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.602 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=15, chunk=3 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.603 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=6, chunk=3 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.603 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=16, chunk=3 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.603 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=7, chunk=3 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.603 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=17, chunk=3 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.604 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=8, chunk=3 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.604 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=18, chunk=3 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.605 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=9, chunk=3 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.605 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=19, chunk=3 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.605 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=10, chunk=3 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.606 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=20, chunk=3 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.606 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=11, chunk=3 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.606 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=21, chunk=3 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.607 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=12, chunk=3 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.607 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=22, chunk=3 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.608 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=13, chunk=3 from Rank 0 | size=2.00MB
2026-01-26 11:45:15.608 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=23, chunk=3 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.609 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=0, chunk=4 from Rank 0 | size=1.03MB
2026-01-26 11:45:15.609 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=24, chunk=3 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.609 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=1, chunk=4 from Rank 0 | size=1.03MB
2026-01-26 11:45:15.610 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=25, chunk=3 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.610 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=2, chunk=4 from Rank 0 | size=1.03MB
2026-01-26 11:45:15.611 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=3, chunk=4 from Rank 0 | size=1.03MB
2026-01-26 11:45:15.611 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=26, chunk=3 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.611 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=4, chunk=4 from Rank 0 | size=1.03MB
2026-01-26 11:45:15.612 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=27, chunk=3 from Rank 1 | size=2.00MB
2026-01-26 11:45:15.612 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=5, chunk=4 from Rank 0 | size=1.03MB
2026-01-26 11:45:15.612 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=14, chunk=4 from Rank 1 | size=1.03MB
2026-01-26 11:45:15.613 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=6, chunk=4 from Rank 0 | size=1.03MB
2026-01-26 11:45:15.613 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=15, chunk=4 from Rank 1 | size=1.03MB
2026-01-26 11:45:15.614 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=7, chunk=4 from Rank 0 | size=1.03MB
2026-01-26 11:45:15.614 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=16, chunk=4 from Rank 1 | size=1.03MB
2026-01-26 11:45:15.614 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=8, chunk=4 from Rank 0 | size=1.03MB
2026-01-26 11:45:15.615 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=17, chunk=4 from Rank 1 | size=1.03MB
2026-01-26 11:45:15.615 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=9, chunk=4 from Rank 0 | size=1.03MB
2026-01-26 11:45:15.615 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=18, chunk=4 from Rank 1 | size=1.03MB
2026-01-26 11:45:15.616 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=10, chunk=4 from Rank 0 | size=1.03MB
2026-01-26 11:45:15.616 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=19, chunk=4 from Rank 1 | size=1.03MB
2026-01-26 11:45:15.617 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=11, chunk=4 from Rank 0 | size=1.03MB
2026-01-26 11:45:15.617 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=20, chunk=4 from Rank 1 | size=1.03MB
2026-01-26 11:45:15.618 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=12, chunk=4 from Rank 0 | size=1.03MB
2026-01-26 11:45:15.618 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=21, chunk=4 from Rank 1 | size=1.03MB
2026-01-26 11:45:15.618 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=13, chunk=4 from Rank 0 | size=1.03MB
2026-01-26 11:45:15.619 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=22, chunk=4 from Rank 1 | size=1.03MB
2026-01-26 11:45:15.619 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=23, chunk=4 from Rank 1 | size=1.03MB
2026-01-26 11:45:15.619 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=24, chunk=4 from Rank 1 | size=1.03MB
2026-01-26 11:45:15.619 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=25, chunk=4 from Rank 1 | size=1.03MB
2026-01-26 11:45:15.619 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=26, chunk=4 from Rank 1 | size=1.03MB
2026-01-26 11:45:15.619 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=27, chunk=4 from Rank 1 | size=1.03MB
2026-01-26 11:45:15.620 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:663] -   [CACHE] 非阻塞接收 140 个 Base Cache
2026-01-26 11:45:15.620 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:502] - [CHUNK 1/5] 完成 | 总耗时: 326.65ms
2026-01-26 11:45:15.620 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:230] - [CHUNK 2/5] 开始处理 | seq_len=128, first=False, last=False
2026-01-26 11:45:15.620 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:245] -   [PHASE 1] 等待接收 Hidden States (from Rank 1)...
2026-01-26 11:45:15.620 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:254] -   [PHASE 1][RECV] Hidden States | shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB | chunk_idx=1
2026-01-26 11:45:15.620 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:257] -   [PHASE 1] 完成 | 耗时: 0.11ms
2026-01-26 11:45:15.620 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:263] -   [PHASE 2] 开始计算 Decoder Layers [28, 32)
2026-01-26 11:45:15.620 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:271] -     past_key_values_length=128, seq_with_past=256
2026-01-26 11:45:15.621 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=28 -> Rank 0 | size=2.00MB
2026-01-26 11:45:15.622 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=28 -> Rank 1 | size=2.00MB
2026-01-26 11:45:15.623 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=29 -> Rank 0 | size=2.00MB
2026-01-26 11:45:15.623 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=29 -> Rank 1 | size=2.00MB
2026-01-26 11:45:15.626 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=30 -> Rank 0 | size=2.00MB
2026-01-26 11:45:15.626 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=30 -> Rank 1 | size=2.00MB
2026-01-26 11:45:15.627 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=31 -> Rank 0 | size=2.00MB
2026-01-26 11:45:15.627 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=31 -> Rank 1 | size=2.00MB
2026-01-26 11:45:15.627 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:377] -   [PHASE 2] 完成 | layers=4, cache_sent=8, eagle_hidden_sent=0 | 耗时: 7.00ms
2026-01-26 11:45:15.627 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:396] -   [PHASE 3] 执行 Eagle Layer 计算...
2026-01-26 11:45:15.628 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:400] -     Norm 完成 | shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.628 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:404] -     LM Head 完成 | shape=(1, 128, 32000), dtype=float16, device=cuda:0, size=7.812MB
2026-01-26 11:45:15.628 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:451] -     Draft Tree 生成: input_ids range=[129, 257)
2026-01-26 11:45:15.630 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:468] -   [PHASE 3][BROADCAST] Eagle Stable KV | chunk=1, size=2.00MB
2026-01-26 11:45:15.631 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:496] -   [PHASE 3] 完成 | 耗时: 3.55ms
2026-01-26 11:45:15.632 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:502] - [CHUNK 2/5] 完成 | 总耗时: 11.96ms
2026-01-26 11:45:15.632 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:230] - [CHUNK 3/5] 开始处理 | seq_len=128, first=False, last=False
2026-01-26 11:45:15.632 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:245] -   [PHASE 1] 等待接收 Hidden States (from Rank 1)...
2026-01-26 11:45:15.632 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:254] -   [PHASE 1][RECV] Hidden States | shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB | chunk_idx=2
2026-01-26 11:45:15.632 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:257] -   [PHASE 1] 完成 | 耗时: 0.29ms
2026-01-26 11:45:15.632 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:263] -   [PHASE 2] 开始计算 Decoder Layers [28, 32)
2026-01-26 11:45:15.632 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:271] -     past_key_values_length=256, seq_with_past=384
2026-01-26 11:45:15.636 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=28 -> Rank 0 | size=2.00MB
2026-01-26 11:45:15.636 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=28 -> Rank 1 | size=2.00MB
2026-01-26 11:45:15.637 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=29 -> Rank 0 | size=2.00MB
2026-01-26 11:45:15.637 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=29 -> Rank 1 | size=2.00MB
2026-01-26 11:45:15.640 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=30 -> Rank 0 | size=2.00MB
2026-01-26 11:45:15.640 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=30 -> Rank 1 | size=2.00MB
2026-01-26 11:45:15.641 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=31 -> Rank 0 | size=2.00MB
2026-01-26 11:45:15.643 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=31 -> Rank 1 | size=2.00MB
2026-01-26 11:45:15.643 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:377] -   [PHASE 2] 完成 | layers=4, cache_sent=8, eagle_hidden_sent=0 | 耗时: 10.64ms
2026-01-26 11:45:15.643 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:396] -   [PHASE 3] 执行 Eagle Layer 计算...
2026-01-26 11:45:15.643 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:400] -     Norm 完成 | shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.643 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:404] -     LM Head 完成 | shape=(1, 128, 32000), dtype=float16, device=cuda:0, size=7.812MB
2026-01-26 11:45:15.644 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:451] -     Draft Tree 生成: input_ids range=[257, 385)
2026-01-26 11:45:15.645 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:468] -   [PHASE 3][BROADCAST] Eagle Stable KV | chunk=2, size=2.00MB
2026-01-26 11:45:15.647 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:496] -   [PHASE 3] 完成 | 耗时: 3.81ms
2026-01-26 11:45:15.648 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:502] - [CHUNK 3/5] 完成 | 总耗时: 15.92ms
2026-01-26 11:45:15.648 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:230] - [CHUNK 4/5] 开始处理 | seq_len=128, first=False, last=False
2026-01-26 11:45:15.648 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:245] -   [PHASE 1] 等待接收 Hidden States (from Rank 1)...
2026-01-26 11:45:15.648 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:254] -   [PHASE 1][RECV] Hidden States | shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB | chunk_idx=3
2026-01-26 11:45:15.648 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:257] -   [PHASE 1] 完成 | 耗时: 0.08ms
2026-01-26 11:45:15.648 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:263] -   [PHASE 2] 开始计算 Decoder Layers [28, 32)
2026-01-26 11:45:15.648 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:271] -     past_key_values_length=384, seq_with_past=512
2026-01-26 11:45:15.651 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=28 -> Rank 0 | size=2.00MB
2026-01-26 11:45:15.651 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=28 -> Rank 1 | size=2.00MB
2026-01-26 11:45:15.654 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=29 -> Rank 0 | size=2.00MB
2026-01-26 11:45:15.654 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=29 -> Rank 1 | size=2.00MB
2026-01-26 11:45:15.655 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=30 -> Rank 0 | size=2.00MB
2026-01-26 11:45:15.655 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=30 -> Rank 1 | size=2.00MB
2026-01-26 11:45:15.658 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=31 -> Rank 0 | size=2.00MB
2026-01-26 11:45:15.658 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=31 -> Rank 1 | size=2.00MB
2026-01-26 11:45:15.658 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:377] -   [PHASE 2] 完成 | layers=4, cache_sent=8, eagle_hidden_sent=0 | 耗时: 10.15ms
2026-01-26 11:45:15.658 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:396] -   [PHASE 3] 执行 Eagle Layer 计算...
2026-01-26 11:45:15.658 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:400] -     Norm 完成 | shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.658 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:404] -     LM Head 完成 | shape=(1, 128, 32000), dtype=float16, device=cuda:0, size=7.812MB
2026-01-26 11:45:15.659 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:451] -     Draft Tree 生成: input_ids range=[385, 513)
2026-01-26 11:45:15.660 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:468] -   [PHASE 3][BROADCAST] Eagle Stable KV | chunk=3, size=2.00MB
2026-01-26 11:45:15.662 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:496] -   [PHASE 3] 完成 | 耗时: 3.56ms
2026-01-26 11:45:15.663 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:502] - [CHUNK 4/5] 完成 | 总耗时: 14.95ms
2026-01-26 11:45:15.663 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:230] - [CHUNK 5/5] 开始处理 | seq_len=66, first=False, last=True
2026-01-26 11:45:15.663 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:245] -   [PHASE 1] 等待接收 Hidden States (from Rank 1)...
2026-01-26 11:45:15.663 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:254] -   [PHASE 1][RECV] Hidden States | shape=(1, 66, 4096), dtype=float16, device=cuda:0, size=0.516MB | chunk_idx=4
2026-01-26 11:45:15.663 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:257] -   [PHASE 1] 完成 | 耗时: 0.09ms
2026-01-26 11:45:15.663 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:263] -   [PHASE 2] 开始计算 Decoder Layers [28, 32)
2026-01-26 11:45:15.663 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:271] -     past_key_values_length=512, seq_with_past=578
2026-01-26 11:45:15.667 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=28 -> Rank 0 | size=1.03MB
2026-01-26 11:45:15.667 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=28 -> Rank 1 | size=1.03MB
2026-01-26 11:45:15.670 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=29 -> Rank 0 | size=1.03MB
2026-01-26 11:45:15.670 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=29 -> Rank 1 | size=1.03MB
2026-01-26 11:45:15.671 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=30 -> Rank 0 | size=1.03MB
2026-01-26 11:45:15.672 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=30 -> Rank 1 | size=1.03MB
2026-01-26 11:45:15.673 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=31 -> Rank 0 | size=1.03MB
2026-01-26 11:45:15.673 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=31 -> Rank 1 | size=1.03MB
2026-01-26 11:45:15.673 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:377] -   [PHASE 2] 完成 | layers=4, cache_sent=8, eagle_hidden_sent=0 | 耗时: 9.83ms
2026-01-26 11:45:15.673 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:396] -   [PHASE 3] 执行 Eagle Layer 计算...
2026-01-26 11:45:15.673 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:400] -     Norm 完成 | shape=(1, 66, 4096), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:15.673 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:404] -     LM Head 完成 | shape=(1, 66, 32000), dtype=float16, device=cuda:0, size=4.028MB
2026-01-26 11:45:15.702 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:443] -   [PHASE 3] First Token 采样: 518
2026-01-26 11:45:15.702 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:451] -     Draft Tree 生成: input_ids range=[513, 579)
2026-01-26 11:45:15.729 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:468] -   [PHASE 3][BROADCAST] Eagle Stable KV | chunk=4, size=1.03MB
2026-01-26 11:45:15.729 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:488] -   [PHASE 3][BROADCAST] Draft Tokens | shape=torch.Size([1, 40])
2026-01-26 11:45:15.729 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:493] -   [PHASE 3] Draft Tokens 广播完成
2026-01-26 11:45:15.729 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:496] -   [PHASE 3] 完成 | 耗时: 56.58ms
2026-01-26 11:45:15.731 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:502] - [CHUNK 5/5] 完成 | 总耗时: 68.03ms
2026-01-26 11:45:15.731 - SpecSoT-Rank2 - INFO - [distributed_prefill.py:507] - [PREFILL] Chunks处理完成，开始 Cache 同步...
2026-01-26 11:45:15.731 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:563] - [SYNC] 最后一个 Rank 等待所有 Cache 同步...
2026-01-26 11:45:15.733 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:580] - [SYNC_OK] Rank 2 Cache 同步完成 | 耗时: 1.49ms
2026-01-26 11:45:15.733 - SpecSoT-Rank2 - INFO - [distributed_prefill.py:589] - [PREFILL] 分布式 Prefill 完成 | Rank=2 | 耗时: 0.440s
2026-01-26 11:45:27.835 - SpecSoT-Rank2 - INFO - [run_specsot.py:362] - 
[统计信息]
2026-01-26 11:45:27.835 - SpecSoT-Rank2 - INFO - [run_specsot.py:363] -   推理时间: 12.52s
2026-01-26 11:45:27.835 - SpecSoT-Rank2 - INFO - [run_specsot.py:365] -   Skeleton阶段时间: 0.94s
2026-01-26 11:45:27.835 - SpecSoT-Rank2 - INFO - [run_specsot.py:366] -   Parallel阶段时间: 11.58s
2026-01-26 11:45:27.835 - SpecSoT-Rank2 - INFO - [run_specsot.py:367] -   峰值显存: 3552.38 MB
2026-01-26 11:45:27.835 - SpecSoT-Rank2 - INFO - [run_specsot.py:368] -   输出长度: 2914 tokens
2026-01-26 11:45:27.835 - SpecSoT-Rank2 - INFO - [run_specsot.py:369] -   吞吐量: 232.8 tokens/s
2026-01-26 11:45:27.835 - SpecSoT-Rank2 - INFO - [run_specsot.py:370] -   并行分支数: 3
2026-01-26 11:45:27.835 - SpecSoT-Rank2 - INFO - [run_specsot.py:371] -   平均接受长度: 6.41
2026-01-26 11:45:27.835 - SpecSoT-Rank2 - INFO - [run_specsot.py:372] -   平均Draft时间: 7.36 ms
2026-01-26 11:45:27.835 - SpecSoT-Rank2 - INFO - [run_specsot.py:373] -   平均Verify时间: 30.26 ms
2026-01-26 11:45:27.835 - SpecSoT-Rank2 - INFO - [run_specsot.py:374] -   平均Update时间: 0.88 ms
2026-01-26 11:45:27.835 - SpecSoT-Rank2 - INFO - [run_specsot.py:377] - 
[响应预览]
2026-01-26 11:45:27.835 - SpecSoT-Rank2 - INFO - [run_specsot.py:378] - [PLAN]
1.<154><Search>[-]Top 3 Cities in China
2.<543><Search>[-]Top 3 Cities in China
3.<456><Search>[-]Top 3 Cities in China
[END] 

## 1. Top 3 Cities in China
 China is home to some of the most populous and influential cities in the world. With a population of over 1.4 billion people, the country is a major player in global politics, economics, and culture. Here are the top 3 cities in China that you should know about:

1. Beijing: The capital of China, Beijing is a city with a rich history and a vibrant present. It is home to some of the country's most iconic landmarks, including the Great Wall of China, the Forbidden City, and the Temple of Heaven. The city is also a hub for technology and innovation, with a thriving startup scene and a number of world-class universities.
2. Shanghai: Known as the "Pearl of the Orient," Shanghai is China's largest city and one of the world's most important financial centers. It is home to some of the country's most impressive skyscrapers, as well...
2026-01-26 11:45:27.835 - SpecSoT-Rank2 - DEBUG - [run_specsot.py:441] - 正在清理分布式资源...
2026-01-26 11:45:27.835 - SpecSoT-Rank2 - INFO - [distributed_prefill.py:155] - [CLEANUP] 通信统计: {'draft_tokens_sent': 2, 'draft_tokens_recv': 0, 'hidden_sent': 0, 'hidden_recv': 5, 'eagle_input_hidden_sent': 0, 'eagle_input_hidden_recv': 0, 'base_cache_sent': 40, 'base_cache_recv': 140, 'eagle_cache_sent': 10, 'eagle_cache_recv': 0, 'aggregated_sends': 0, 'forwarded_messages': 0}
2026-01-26 11:45:27.936 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:158] - [CLEANUP] 分布式Prefill管理器已清理
2026-01-26 11:45:27.936 - SpecSoT-Rank2 - DEBUG - [run_specsot.py:443] - 分布式资源已清理
2026-01-26 11:45:27.936 - SpecSoT-Rank2 - INFO - [run_specsot.py:445] - Worker 执行完成
ype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.541 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 0 | layer_idx=4, chunk_idx=3, seq_id=97, latency=2233.54ms
2026-01-26 11:45:15.541 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.543 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=14, chunk_idx=3, seq_id=89, latency=1347.91ms
2026-01-26 11:45:15.543 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.545 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 0 | layer_idx=5, chunk_idx=3, seq_id=99, latency=2234.18ms
2026-01-26 11:45:15.545 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.550 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=15, chunk_idx=3, seq_id=91, latency=1352.85ms
2026-01-26 11:45:15.550 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.559 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:348] - [BROADCAST] EAGLE_STABLE_KV -> targets=[0, 1] | chunk_idx=0, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:15.559 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:313] - [QUEUE] EAGLE_CACHE -> rank 0 | chunk_idx=0, incremental=True, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:15.559 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:313] - [QUEUE] EAGLE_CACHE -> rank 1 | chunk_idx=0, incremental=True, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:15.560 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 0 | layer_idx=6, chunk_idx=3, seq_id=101, latency=2245.99ms
2026-01-26 11:45:15.560 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.562 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=16, chunk_idx=3, seq_id=93, latency=1361.27ms
2026-01-26 11:45:15.562 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.566 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:162] - [SEND] EAGLE_CACHE -> rank 0 | seq_id=9, chunk_idx=0, incremental=True, key_shape=(1, 32, 128, 128), size=2050.60KB, time=6.28ms
2026-01-26 11:45:15.566 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 0 | layer_idx=7, chunk_idx=3, seq_id=103, latency=2248.32ms
2026-01-26 11:45:15.566 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.569 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=17, chunk_idx=3, seq_id=95, latency=1365.37ms
2026-01-26 11:45:15.569 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.572 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:162] - [SEND] EAGLE_CACHE -> rank 1 | seq_id=10, chunk_idx=0, incremental=True, key_shape=(1, 32, 128, 128), size=2050.60KB, time=5.75ms
2026-01-26 11:45:15.573 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 0 | layer_idx=8, chunk_idx=3, seq_id=105, latency=2249.68ms
2026-01-26 11:45:15.573 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.574 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=18, chunk_idx=3, seq_id=97, latency=1367.43ms
2026-01-26 11:45:15.574 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.575 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 0 | layer_idx=9, chunk_idx=3, seq_id=107, latency=2248.24ms
2026-01-26 11:45:15.575 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.576 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=19, chunk_idx=3, seq_id=99, latency=1367.25ms
2026-01-26 11:45:15.576 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.578 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 0 | layer_idx=10, chunk_idx=3, seq_id=109, latency=2242.84ms
2026-01-26 11:45:15.578 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.579 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=20, chunk_idx=3, seq_id=101, latency=1366.75ms
2026-01-26 11:45:15.579 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.580 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 0 | layer_idx=11, chunk_idx=3, seq_id=111, latency=2240.32ms
2026-01-26 11:45:15.580 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.581 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=21, chunk_idx=3, seq_id=103, latency=1366.30ms
2026-01-26 11:45:15.581 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.583 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 0 | layer_idx=12, chunk_idx=3, seq_id=113, latency=2235.60ms
2026-01-26 11:45:15.583 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.584 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=22, chunk_idx=3, seq_id=105, latency=1366.04ms
2026-01-26 11:45:15.584 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.585 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 0 | layer_idx=13, chunk_idx=3, seq_id=115, latency=2234.06ms
2026-01-26 11:45:15.585 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.586 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=23, chunk_idx=3, seq_id=107, latency=1365.59ms
2026-01-26 11:45:15.586 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.587 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 0 | layer_idx=0, chunk_idx=4, seq_id=118, latency=2228.63ms
2026-01-26 11:45:15.587 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
  value: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:15.588 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=24, chunk_idx=3, seq_id=109, latency=1364.88ms
2026-01-26 11:45:15.588 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.589 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 0 | layer_idx=1, chunk_idx=4, seq_id=120, latency=2227.69ms
2026-01-26 11:45:15.589 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
  value: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:15.590 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=25, chunk_idx=3, seq_id=111, latency=1364.05ms
2026-01-26 11:45:15.590 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.591 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 0 | layer_idx=2, chunk_idx=4, seq_id=122, latency=2226.86ms
2026-01-26 11:45:15.591 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
  value: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:15.592 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:239] - [RECV] HIDDEN from rank 1 | chunk_idx=4, seq_id=145, latency=1310.13ms
2026-01-26 11:45:15.592 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:243] -   hidden_state: shape=(1, 66, 4096), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:15.593 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 0 | layer_idx=3, chunk_idx=4, seq_id=124, latency=2225.51ms
2026-01-26 11:45:15.593 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
  value: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:15.594 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=26, chunk_idx=3, seq_id=113, latency=1365.04ms
2026-01-26 11:45:15.594 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.595 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 0 | layer_idx=4, chunk_idx=4, seq_id=126, latency=2224.57ms
2026-01-26 11:45:15.595 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
  value: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:15.596 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=27, chunk_idx=3, seq_id=115, latency=1364.48ms
2026-01-26 11:45:15.596 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.597 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 0 | layer_idx=5, chunk_idx=4, seq_id=128, latency=2224.20ms
2026-01-26 11:45:15.597 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
  value: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:15.598 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=14, chunk_idx=4, seq_id=118, latency=1359.32ms
2026-01-26 11:45:15.598 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
  value: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:15.599 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 0 | layer_idx=6, chunk_idx=4, seq_id=130, latency=2223.05ms
2026-01-26 11:45:15.599 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
  value: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:15.600 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=15, chunk_idx=4, seq_id=120, latency=1357.82ms
2026-01-26 11:45:15.600 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
  value: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:15.601 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 0 | layer_idx=7, chunk_idx=4, seq_id=132, latency=2221.97ms
2026-01-26 11:45:15.601 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
  value: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:15.602 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=16, chunk_idx=4, seq_id=122, latency=1356.29ms
2026-01-26 11:45:15.602 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
  value: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:15.603 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 0 | layer_idx=8, chunk_idx=4, seq_id=134, latency=2221.09ms
2026-01-26 11:45:15.603 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
  value: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:15.604 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=17, chunk_idx=4, seq_id=124, latency=1354.81ms
2026-01-26 11:45:15.604 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
  value: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:15.605 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 0 | layer_idx=9, chunk_idx=4, seq_id=136, latency=2220.06ms
2026-01-26 11:45:15.605 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
  value: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:15.606 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=18, chunk_idx=4, seq_id=126, latency=1353.68ms
2026-01-26 11:45:15.606 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
  value: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:15.607 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 0 | layer_idx=10, chunk_idx=4, seq_id=138, latency=2218.13ms
2026-01-26 11:45:15.607 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
  value: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:15.608 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=19, chunk_idx=4, seq_id=128, latency=1352.68ms
2026-01-26 11:45:15.608 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
  value: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:15.608 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 0 | layer_idx=11, chunk_idx=4, seq_id=140, latency=2216.96ms
2026-01-26 11:45:15.608 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
  value: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:15.609 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=20, chunk_idx=4, seq_id=130, latency=1351.41ms
2026-01-26 11:45:15.609 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
  value: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:15.610 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 0 | layer_idx=12, chunk_idx=4, seq_id=142, latency=2213.61ms
2026-01-26 11:45:15.610 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
  value: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:15.611 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=21, chunk_idx=4, seq_id=132, latency=1350.04ms
2026-01-26 11:45:15.611 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
  value: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:15.612 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 0 | layer_idx=13, chunk_idx=4, seq_id=144, latency=2211.04ms
2026-01-26 11:45:15.612 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
  value: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:15.613 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=22, chunk_idx=4, seq_id=134, latency=1349.00ms
2026-01-26 11:45:15.613 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
  value: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:15.614 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=23, chunk_idx=4, seq_id=136, latency=1346.62ms
2026-01-26 11:45:15.614 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
  value: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:15.615 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=24, chunk_idx=4, seq_id=138, latency=1344.52ms
2026-01-26 11:45:15.615 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
  value: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:15.616 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=25, chunk_idx=4, seq_id=140, latency=1342.73ms
2026-01-26 11:45:15.616 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
  value: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:15.617 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=26, chunk_idx=4, seq_id=142, latency=1339.89ms
2026-01-26 11:45:15.617 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
  value: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:15.618 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=27, chunk_idx=4, seq_id=144, latency=1337.74ms
2026-01-26 11:45:15.618 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
  value: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:15.620 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:430] - [WAIT] 等待接收 HIDDEN (src_rank=1, timeout=60.0s)
2026-01-26 11:45:15.620 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:448] - [RECV_OK] HIDDEN 接收成功 | from rank 1, chunk_idx=1, wait_time=0.02ms
2026-01-26 11:45:15.620 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:453] -   hidden: shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.621 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=28, chunk_idx=1, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:15.621 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=28, chunk_idx=1, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:15.623 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=29, chunk_idx=1, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:15.623 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=29, chunk_idx=1, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:15.625 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=11, layer_idx=28, chunk_idx=1, key_shape=(1, 32, 128, 128), size=2050.60KB, time=3.86ms
2026-01-26 11:45:15.626 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=30, chunk_idx=1, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:15.626 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=30, chunk_idx=1, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:15.627 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=31, chunk_idx=1, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:15.627 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=31, chunk_idx=1, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:15.628 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=12, layer_idx=28, chunk_idx=1, key_shape=(1, 32, 128, 128), size=2050.60KB, time=2.79ms
2026-01-26 11:45:15.630 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:348] - [BROADCAST] EAGLE_STABLE_KV -> targets=[0, 1] | chunk_idx=1, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:15.630 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:313] - [QUEUE] EAGLE_CACHE -> rank 0 | chunk_idx=1, incremental=True, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:15.630 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:313] - [QUEUE] EAGLE_CACHE -> rank 1 | chunk_idx=1, incremental=True, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:15.632 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:430] - [WAIT] 等待接收 HIDDEN (src_rank=1, timeout=60.0s)
2026-01-26 11:45:15.632 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:448] - [RECV_OK] HIDDEN 接收成功 | from rank 1, chunk_idx=2, wait_time=0.02ms
2026-01-26 11:45:15.632 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=13, layer_idx=29, chunk_idx=1, key_shape=(1, 32, 128, 128), size=2050.60KB, time=3.67ms
2026-01-26 11:45:15.632 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:453] -   hidden: shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.636 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=14, layer_idx=29, chunk_idx=1, key_shape=(1, 32, 128, 128), size=2050.60KB, time=3.27ms
2026-01-26 11:45:15.636 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=28, chunk_idx=2, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:15.636 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=28, chunk_idx=2, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:15.637 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=29, chunk_idx=2, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:15.637 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=29, chunk_idx=2, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:15.639 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=15, layer_idx=30, chunk_idx=1, key_shape=(1, 32, 128, 128), size=2050.60KB, time=3.62ms
2026-01-26 11:45:15.640 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=30, chunk_idx=2, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:15.640 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=30, chunk_idx=2, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:15.641 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=31, chunk_idx=2, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:15.643 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=31, chunk_idx=2, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:15.643 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=16, layer_idx=30, chunk_idx=1, key_shape=(1, 32, 128, 128), size=2050.60KB, time=3.63ms
2026-01-26 11:45:15.647 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:348] - [BROADCAST] EAGLE_STABLE_KV -> targets=[0, 1] | chunk_idx=2, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:15.647 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:313] - [QUEUE] EAGLE_CACHE -> rank 0 | chunk_idx=2, incremental=True, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:15.647 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:313] - [QUEUE] EAGLE_CACHE -> rank 1 | chunk_idx=2, incremental=True, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:15.647 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=17, layer_idx=31, chunk_idx=1, key_shape=(1, 32, 128, 128), size=2050.60KB, time=3.69ms
2026-01-26 11:45:15.648 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:430] - [WAIT] 等待接收 HIDDEN (src_rank=1, timeout=60.0s)
2026-01-26 11:45:15.648 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:448] - [RECV_OK] HIDDEN 接收成功 | from rank 1, chunk_idx=3, wait_time=0.02ms
2026-01-26 11:45:15.648 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:453] -   hidden: shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.650 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=18, layer_idx=31, chunk_idx=1, key_shape=(1, 32, 128, 128), size=2050.60KB, time=3.40ms
2026-01-26 11:45:15.651 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=28, chunk_idx=3, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:15.651 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=28, chunk_idx=3, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:15.653 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=29, chunk_idx=3, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:15.654 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=29, chunk_idx=3, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:15.654 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=21, layer_idx=28, chunk_idx=2, key_shape=(1, 32, 128, 128), size=2050.60KB, time=3.61ms
2026-01-26 11:45:15.655 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=30, chunk_idx=3, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:15.655 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=30, chunk_idx=3, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:15.658 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=31, chunk_idx=3, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:15.658 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=22, layer_idx=28, chunk_idx=2, key_shape=(1, 32, 128, 128), size=2050.60KB, time=3.73ms
2026-01-26 11:45:15.658 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=31, chunk_idx=3, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:15.660 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:348] - [BROADCAST] EAGLE_STABLE_KV -> targets=[0, 1] | chunk_idx=3, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:15.662 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:313] - [QUEUE] EAGLE_CACHE -> rank 0 | chunk_idx=3, incremental=True, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:15.662 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:313] - [QUEUE] EAGLE_CACHE -> rank 1 | chunk_idx=3, incremental=True, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:15.662 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=23, layer_idx=29, chunk_idx=2, key_shape=(1, 32, 128, 128), size=2050.60KB, time=3.68ms
2026-01-26 11:45:15.663 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:430] - [WAIT] 等待接收 HIDDEN (src_rank=1, timeout=60.0s)
2026-01-26 11:45:15.663 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:448] - [RECV_OK] HIDDEN 接收成功 | from rank 1, chunk_idx=4, wait_time=0.03ms
2026-01-26 11:45:15.663 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:453] -   hidden: shape=(1, 66, 4096), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:15.665 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=24, layer_idx=29, chunk_idx=2, key_shape=(1, 32, 128, 128), size=2050.60KB, time=3.41ms
2026-01-26 11:45:15.667 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=28, chunk_idx=4, key_shape=(1, 32, 66, 128)
2026-01-26 11:45:15.667 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=28, chunk_idx=4, key_shape=(1, 32, 66, 128)
2026-01-26 11:45:15.669 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=25, layer_idx=30, chunk_idx=2, key_shape=(1, 32, 128, 128), size=2050.60KB, time=3.39ms
2026-01-26 11:45:15.670 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=29, chunk_idx=4, key_shape=(1, 32, 66, 128)
2026-01-26 11:45:15.670 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=29, chunk_idx=4, key_shape=(1, 32, 66, 128)
2026-01-26 11:45:15.671 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=30, chunk_idx=4, key_shape=(1, 32, 66, 128)
2026-01-26 11:45:15.671 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=30, chunk_idx=4, key_shape=(1, 32, 66, 128)
2026-01-26 11:45:15.671 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=26, layer_idx=30, chunk_idx=2, key_shape=(1, 32, 128, 128), size=2050.60KB, time=2.48ms
2026-01-26 11:45:15.672 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=31, chunk_idx=4, key_shape=(1, 32, 66, 128)
2026-01-26 11:45:15.673 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=31, chunk_idx=4, key_shape=(1, 32, 66, 128)
2026-01-26 11:45:15.674 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=27, layer_idx=31, chunk_idx=2, key_shape=(1, 32, 128, 128), size=2050.60KB, time=2.01ms
2026-01-26 11:45:15.682 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=28, layer_idx=31, chunk_idx=2, key_shape=(1, 32, 128, 128), size=2050.60KB, time=8.51ms
2026-01-26 11:45:15.699 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=31, layer_idx=28, chunk_idx=3, key_shape=(1, 32, 128, 128), size=2050.60KB, time=16.83ms
2026-01-26 11:45:15.703 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=32, layer_idx=28, chunk_idx=3, key_shape=(1, 32, 128, 128), size=2050.60KB, time=3.67ms
2026-01-26 11:45:15.705 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=33, layer_idx=29, chunk_idx=3, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.79ms
2026-01-26 11:45:15.707 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=34, layer_idx=29, chunk_idx=3, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.86ms
2026-01-26 11:45:15.715 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=35, layer_idx=30, chunk_idx=3, key_shape=(1, 32, 128, 128), size=2050.60KB, time=7.72ms
2026-01-26 11:45:15.717 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=36, layer_idx=30, chunk_idx=3, key_shape=(1, 32, 128, 128), size=2050.60KB, time=2.05ms
2026-01-26 11:45:15.719 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=37, layer_idx=31, chunk_idx=3, key_shape=(1, 32, 128, 128), size=2050.60KB, time=2.03ms
2026-01-26 11:45:15.722 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=38, layer_idx=31, chunk_idx=3, key_shape=(1, 32, 128, 128), size=2050.60KB, time=2.63ms
2026-01-26 11:45:15.729 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=41, layer_idx=28, chunk_idx=4, key_shape=(1, 32, 66, 128), size=1058.60KB, time=7.19ms
2026-01-26 11:45:15.729 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:348] - [BROADCAST] EAGLE_STABLE_KV -> targets=[0, 1] | chunk_idx=4, key_shape=(1, 32, 66, 128)
2026-01-26 11:45:15.729 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:313] - [QUEUE] EAGLE_CACHE -> rank 0 | chunk_idx=4, incremental=True, key_shape=(1, 32, 66, 128)
2026-01-26 11:45:15.729 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:313] - [QUEUE] EAGLE_CACHE -> rank 1 | chunk_idx=4, incremental=True, key_shape=(1, 32, 66, 128)
2026-01-26 11:45:15.729 - SpecSoT-Rank2-Comm - INFO - [p2p_comm_manager.py:207] - [BROADCAST] DRAFT_TOKENS -> targets=[0, 1] | draft_shape=(1, 40)
2026-01-26 11:45:15.729 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:211] -   retrieve_shape=(1, 26, 6), mask_shape=(1, 1, 40, 40)
2026-01-26 11:45:15.730 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=42, layer_idx=28, chunk_idx=4, key_shape=(1, 32, 66, 128), size=1058.60KB, time=1.14ms
2026-01-26 11:45:15.731 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:118] - [SEND] DRAFT_TOKENS -> rank 0 | seq_id=51, draft_shape=(1, 40), size=9.52KB, time=0.75ms
2026-01-26 11:45:15.732 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:118] - [SEND] DRAFT_TOKENS -> rank 1 | seq_id=52, draft_shape=(1, 40), size=9.52KB, time=0.35ms
2026-01-26 11:45:15.732 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:776] - [WAIT] 等待接收所有 Cache | expected_base_caches=0, expected_eagle_caches=0, my_layer_range=[28, 32), timeout=60.0s
2026-01-26 11:45:15.733 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:781] -   待接收的 base cache: []
2026-01-26 11:45:15.733 - SpecSoT-Rank2-Comm - INFO - [base_comm_manager.py:858] - [SYNC_OK] 所有 Cache 接收完成 | base_cache=0, eagle_cache=0, wait_time=1.47ms
2026-01-26 11:45:15.733 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=43, layer_idx=29, chunk_idx=4, key_shape=(1, 32, 66, 128), size=1058.60KB, time=1.33ms
2026-01-26 11:45:15.734 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=44, layer_idx=29, chunk_idx=4, key_shape=(1, 32, 66, 128), size=1058.60KB, time=1.21ms
2026-01-26 11:45:15.736 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=45, layer_idx=30, chunk_idx=4, key_shape=(1, 32, 66, 128), size=1058.60KB, time=1.11ms
2026-01-26 11:45:15.737 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=46, layer_idx=30, chunk_idx=4, key_shape=(1, 32, 66, 128), size=1058.60KB, time=1.06ms
2026-01-26 11:45:15.738 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=47, layer_idx=31, chunk_idx=4, key_shape=(1, 32, 66, 128), size=1058.60KB, time=1.11ms
2026-01-26 11:45:15.739 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=48, layer_idx=31, chunk_idx=4, key_shape=(1, 32, 66, 128), size=1058.60KB, time=1.58ms
2026-01-26 11:45:15.742 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:162] - [SEND] EAGLE_CACHE -> rank 0 | seq_id=19, chunk_idx=1, incremental=True, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.94ms
2026-01-26 11:45:15.744 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:162] - [SEND] EAGLE_CACHE -> rank 1 | seq_id=20, chunk_idx=1, incremental=True, key_shape=(1, 32, 128, 128), size=2050.60KB, time=2.09ms
2026-01-26 11:45:15.746 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:162] - [SEND] EAGLE_CACHE -> rank 0 | seq_id=29, chunk_idx=2, incremental=True, key_shape=(1, 32, 128, 128), size=2050.60KB, time=2.19ms
2026-01-26 11:45:15.748 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:162] - [SEND] EAGLE_CACHE -> rank 1 | seq_id=30, chunk_idx=2, incremental=True, key_shape=(1, 32, 128, 128), size=2050.60KB, time=2.20ms
2026-01-26 11:45:15.751 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:162] - [SEND] EAGLE_CACHE -> rank 0 | seq_id=39, chunk_idx=3, incremental=True, key_shape=(1, 32, 128, 128), size=2050.60KB, time=2.22ms
2026-01-26 11:45:15.753 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:162] - [SEND] EAGLE_CACHE -> rank 1 | seq_id=40, chunk_idx=3, incremental=True, key_shape=(1, 32, 128, 128), size=2050.60KB, time=2.24ms
2026-01-26 11:45:15.754 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:162] - [SEND] EAGLE_CACHE -> rank 0 | seq_id=49, chunk_idx=4, incremental=True, key_shape=(1, 32, 66, 128), size=1058.60KB, time=1.38ms
2026-01-26 11:45:15.756 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:162] - [SEND] EAGLE_CACHE -> rank 1 | seq_id=50, chunk_idx=4, incremental=True, key_shape=(1, 32, 66, 128), size=1058.60KB, time=1.11ms
2026-01-26 11:45:27.866 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:102] - [THREAD] 发送线程退出
2026-01-26 11:45:27.935 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:189] - 接收线程退出
2026-01-26 11:45:27.936 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:329] - 通信管理器已停止
