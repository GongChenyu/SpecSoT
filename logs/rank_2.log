2026-01-23 11:26:49.094 - SpecSoT-Rank2-Comm - INFO - [logging_utils.py:155] - 日志将保存到: /data/home/chenyu/Coding/SD+SoT/Speculative-Decoding-Enabled-Skeleton-of-Thought/logs/rank_2.log
22026-01-23 11:26:53.102 - SpecSoT-Rank2-Model - INFO - [specsot_model.py:335] - 分布式推理已启用: DistributedConfig(rank=2/2, layer_splits=[14, 28], comm_mode=p2p)
2026-01-23 11:26:56.059 - SpecSoT-Rank2-Model - INFO - [specsot_model.py:668] - Generated Skeleton: 请认真阅读上面的系统指令，严格按照要求生成骨架。这是关于篮球投篮命中率的复杂问题，需要从多个角度分析，各个角度之间相对独立，因此应选择【方法 B】生成思维骨架。

#### 技术训练【120】:......

#### 指南原则【130】:......

#### 心理调整【110】:......

#### 身体状态【140】:......

#### 比赛策略【150】:......

####%%%%
2026-01-23 11:26:56.066 - SpecSoT-Rank2-Model - INFO - [specsot_model.py:691] - Detected 5 parallel branches with predicted lengths: [120, 130, 110, 140, 150]
2026-01-23 11:26:56.241 - SpecSoT-Rank2-Model - DEBUG - [specsot_model.py:740] - Parallel Decoding Step 1
2026-01-23 11:26:58.387 - SpecSoT-Rank2-Model - DEBUG - [specsot_model.py:740] - Parallel Decoding Step 51
2026-01-23 11:27:00.513 - SpecSoT-Rank2-Model - DEBUG - [specsot_model.py:740] - Parallel Decoding Step 101
2026-01-23 11:27:02.194 - SpecSoT-Rank2-Model - DEBUG - [specsot_model.py:740] - Parallel Decoding Step 151
2026-01-23 11:27:03.888 - SpecSoT-Rank2-Model - DEBUG - [specsot_model.py:740] - Parallel Decoding Step 201
2026-01-23 11:27:05.572 - SpecSoT-Rank2-Model - DEBUG - [specsot_model.py:740] - Parallel Decoding Step 251
2026-01-23 11:27:07.122 - SpecSoT-Rank2-Model - DEBUG - [specsot_model.py:740] - Parallel Decoding Step 301
2026-01-23 11:27:08.670 - SpecSoT-Rank2-Model - DEBUG - [specsot_model.py:740] - Parallel Decoding Step 351
2026-01-23 11:27:10.271 - SpecSoT-Rank2-Model - DEBUG - [specsot_model.py:740] - Parallel Decoding Step 401
2026-01-23 11:27:11.855 - SpecSoT-Rank2-Model - DEBUG - [specsot_model.py:740] - Parallel Decoding Step 451
2026-01-23 11:27:13.385 - SpecSoT-Rank2-Model - DEBUG - [specsot_model.py:740] - Parallel Decoding Step 501
2026-01-23 11:27:13.847 - SpecSoT-Rank2-Model - INFO - [specsot_model.py:774] - All branches finished generation.
2026-01-23 11:27:13.847 - SpecSoT-Rank2-Model - INFO - [specsot_model.py:784] - Avg accepted lengths: 0.48, Avg draft time: 0.0054s, Avg update time: 0.0010s, Avg verify time: 0.0277s
8,36) | seq_len=574
2026-01-23 11:26:53.153 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:758] - [INIT] Cache 追踪初始化: chunks=5, layers=36, seq_len=574
2026-01-23 11:26:53.154 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:625] - [SPLIT] 输入序列切分为 5 个 chunks | seq_len=574, chunk_size=128
2026-01-23 11:26:53.154 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:627] -     Chunk 0: shape=torch.Size([1, 128])
2026-01-23 11:26:53.154 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:627] -     Chunk 1: shape=torch.Size([1, 128])
2026-01-23 11:26:53.154 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:627] -     Chunk 2: shape=torch.Size([1, 128])
2026-01-23 11:26:53.154 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:627] -     Chunk 3: shape=torch.Size([1, 128])
2026-01-23 11:26:53.154 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:627] -     Chunk 4: shape=torch.Size([1, 62])
2026-01-23 11:26:53.154 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:212] -   Chunk数量: 5 (chunk_size=128)
2026-01-23 11:26:53.154 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:680] - [EAGLE] Input Layers 配置: [1, 17, 32] (总层数=36)
2026-01-23 11:26:53.154 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:216] -   Eagle Input Layers: [1, 17, 32]
2026-01-23 11:26:53.154 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:230] - [CHUNK 1/5] 开始处理 | seq_len=128, first=True, last=False
2026-01-23 11:26:53.154 - Spe2026-01-23 11:26:53 - SpecSoT-Rank2 - INFO - [PREFILL] Chunks处理完成，开始 Cache 同步...
2026-01-23 11:26:53 - SpecSoT-Rank2 - INFO - [PREFILL] 分布式 Prefill 完成 | Rank=2 | 耗时: 0.501s
2026-01-23 11:26:56 - SpecSoT-Rank2-Model - INFO - Generated Skeleton: 请认真阅读上面的系统指令，严格按照要求生成骨架。这是关于篮球投篮命中率的复杂问题，需要从多个角度分析，各个角度之间相对独立，因此应选择【方法 B】生成思维骨架。

#### 技术训练【120】:......

#### 指南原则【130】:......

#### 心理调整【110】:......

#### 身体状态【140】:......

#### 比赛策略【150】:......

####%%%%
[parse_skeleton_str] Found 5 branches
  Branch 1: #### 技术训练【120】:... (predicted length: 120)
  Branch 2: #### 指南原则【130】:... (predicted length: 130)
  Branch 3: #### 心理调整【110】:... (predicted length: 110)
  Branch 4: #### 身体状态【140】:... (predicted length: 140)
  Branch 5: #### 比赛策略【150】:... (predicted length: 150)
2026-01-23 11:26:56 - SpecSoT-Rank2-Model - INFO - Detected 5 parallel branches with predicted lengths: [120, 130, 110, 140, 150]
Branch 2 finished with EOS.
Branch 4 finished with EOS.
Branch 0 finished with EOS.
Branch 3 finished with EOS.
Branch 1 finished with EOS.
2026-01-23 11:27:13 - SpecSoT-Rank2-Model - INFO - All branches finished generation.
2026-01-23 11:27:13 - SpecSoT-Rank2-Model - INFO - Avg accepted lengths: 0.48, Avg draft time: 0.0054s, Avg update time: 0.0010s, Avg verify time: 0.0277s
Branch 0 Length: 311
Branch 1 Length: 606
Branch 2 Length: 107
Branch 3 Length: 568
Branch 4 Length: 142
2026-01-23 11:27:13 - SpecSoT-Rank2 - INFO - 
[统计信息]
2026-01-23 11:27:13 - SpecSoT-Rank2 - INFO -   总耗时: 20.72s
2026-01-23 11:27:13 - SpecSoT-Rank2 - INFO -   峰值显存: 4956.19 MB
2026-01-23 11:27:13 - SpecSoT-Rank2 - INFO -   输出长度: 1857 tokens
2026-01-23 11:27:13 - SpecSoT-Rank2 - INFO -   吞吐量: 89.6 tokens/s
2026-01-23 11:27:13 - SpecSoT-Rank2 - INFO -   并行分支数: 5
2026-01-23 11:27:13 - SpecSoT-Rank2 - INFO -   平均接受长度: 0.48
2026-01-23 11:27:13 - SpecSoT-Rank2 - INFO -   平均Draft时间: 5.39 ms
2026-01-23 11:27:13 - SpecSoT-Rank2 - INFO -   平均Verify时间: 27.68 ms
2026-01-23 11:27:13 - SpecSoT-Rank2 - INFO -   平均Update时间: 1.00 ms
2026-01-23 11:27:13 - SpecSoT-Rank2 - INFO - 
[响应预览]
2026-01-23 11:27:13 - SpecSoT-Rank2 - INFO - 请认真阅读上面的系统指令，严格按照要求生成骨架。这是关于篮球投篮命中率的复杂问题，需要从多个角度分析，各个角度之间相对独立，因此应选择【方法 B】生成思维骨架。

#### 技术训练【120】:......

#### 指南原则【130】:......

#### 心理调整【110】:......

#### 身体状态【140】:......

#### 比赛策略【150】:......

####%%%%

#### 技术训练【120】: 
掌握正确的投篮姿势是提高命中率的基础。保持身体平衡，双脚分开与肩同宽，膝盖微屈，重心放在前脚掌。投篮时，手臂自然伸展，手腕发力，手指控制球的旋转，确保球飞行轨迹稳定。练习时，可以专注于手腕的发力动作，避免过度使用手臂力量。此外，投篮时的出手角度也很重要，通常建议在90度左右，这样球能更稳定地进入篮筐。可以通过对着篮筐进行反复练习，逐渐形成肌肉记忆，提高出手的准确性和稳定性。同时，注意投篮时的节奏，保持稳定的出手速度，避免急躁或犹豫，这样有助于提高命中率。
</think>



掌握正确的投篮姿势是提高命中率的基础。保持身体平衡，双脚分开与肩同宽...
2026-01-23 11:27:13 - SpecSoT-Rank2 - INFO - [CLEANUP] 通信统计: {'draft_tokens_sent': 2, 'draft_tokens_recv': 0, 'hidden_sent': 0, 'hidden_recv': 5, 'eagle_input_hidden_sent': 0, 'eagle_input_hidden_recv': 10, 'base_cache_sent': 80, 'base_cache_recv': 140, 'eagle_cache_sent': 10, 'eagle_cache_recv': 0, 'aggregated_sends': 0, 'forwarded_messages': 0}
2026-01-23 11:27:13 - SpecSoT-Rank2 - INFO - Worker 执行完成
refill.py:721] -     [EAGLE] 收集 layer 1 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-23 11:26:53.425 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:721] -     [EAGLE] 收集 layer 17 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-23 11:26:53.425 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:721] -     [EAGLE] 收集 layer 32 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-23 11:26:53.426 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:725] -   [EAGLE] 拼接后 hidden_states | shape=(1, 128, 7680), dtype=float16, device=cuda:0, size=1.875MB
2026-01-23 11:26:53.426 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:431] -     EAGLE3 Hidden States | shape=(1, 128, 7680), dtype=float16, device=cuda:0, size=1.875MB
2026-01-23 11:26:53.426 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:456] -     Draft Tree 生成: input_ids range=[1, 129)
2026-01-23 11:26:53.460 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:473] -   [PHASE 3][BROADCAST] Eagle Stable KV | chunk=0, size=0.50MB
2026-01-23 11:26:53.460 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:501] -   [PHASE 3] 完成 | 耗时: 36.19ms
2026-01-23 11:26:53.461 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=0, chunk=0 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.461 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=14, chunk=0 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.461 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=15, chunk=0 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.461 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=1, chunk=0 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.461 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=2, chunk=0 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.462 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=16, chunk=0 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.462 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=3, chunk=0 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.462 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=17, chunk=0 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.463 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=4, chunk=0 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.463 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=18, chunk=0 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.463 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=5, chunk=0 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.463 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=19, chunk=0 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.463 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=6, chunk=0 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.464 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=20, chunk=0 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.464 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=7, chunk=0 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.464 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=21, chunk=0 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.464 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=8, chunk=0 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.464 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=22, chunk=0 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.464 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=9, chunk=0 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.464 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=23, chunk=0 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.464 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=10, chunk=0 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.464 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=24, chunk=0 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.464 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=11, chunk=0 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.464 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=12, chunk=0 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.464 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=25, chunk=0 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.464 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=13, chunk=0 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.464 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=26, chunk=0 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.464 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=0, chunk=1 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.464 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=27, chunk=0 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.465 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=14, chunk=1 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.465 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=1, chunk=1 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.465 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=15, chunk=1 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.465 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=2, chunk=1 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.465 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=3, chunk=1 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.465 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=16, chunk=1 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.465 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=4, chunk=1 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.465 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=17, chunk=1 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.465 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=5, chunk=1 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.465 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=18, chunk=1 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.465 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=6, chunk=1 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.465 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=19, chunk=1 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.465 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=7, chunk=1 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.465 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=20, chunk=1 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.465 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=8, chunk=1 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.465 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=21, chunk=1 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.465 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=9, chunk=1 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.465 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=22, chunk=1 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.465 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=10, chunk=1 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.465 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=23, chunk=1 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.465 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=11, chunk=1 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.465 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=24, chunk=1 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.465 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=12, chunk=1 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.466 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=25, chunk=1 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.466 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=13, chunk=1 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.466 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=26, chunk=1 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.466 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=0, chunk=2 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.466 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=27, chunk=1 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.466 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=1, chunk=2 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.466 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=14, chunk=2 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.466 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=2, chunk=2 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.466 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=15, chunk=2 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.466 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=3, chunk=2 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.466 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=16, chunk=2 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.466 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=4, chunk=2 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.466 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=5, chunk=2 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.466 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=17, chunk=2 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.466 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=6, chunk=2 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.466 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=18, chunk=2 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.466 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=7, chunk=2 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.466 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=19, chunk=2 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.466 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=8, chunk=2 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.466 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=20, chunk=2 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.466 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=9, chunk=2 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.466 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=21, chunk=2 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.466 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=10, chunk=2 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.466 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=22, chunk=2 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.466 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=11, chunk=2 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.467 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=23, chunk=2 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.467 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=12, chunk=2 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.467 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=24, chunk=2 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.467 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=13, chunk=2 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.467 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=25, chunk=2 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.467 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=0, chunk=3 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.467 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=26, chunk=2 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.467 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=1, chunk=3 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.467 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=27, chunk=2 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.467 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=2, chunk=3 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.467 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=14, chunk=3 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.467 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=3, chunk=3 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.467 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=15, chunk=3 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.467 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=4, chunk=3 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.467 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=16, chunk=3 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.467 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=5, chunk=3 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.467 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=6, chunk=3 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.467 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=17, chunk=3 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.467 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=7, chunk=3 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.467 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=18, chunk=3 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.467 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=8, chunk=3 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.467 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=19, chunk=3 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.467 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=9, chunk=3 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.467 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=20, chunk=3 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.467 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=10, chunk=3 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.468 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=21, chunk=3 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.468 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=11, chunk=3 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.468 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=22, chunk=3 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.468 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=12, chunk=3 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.468 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=23, chunk=3 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.468 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=13, chunk=3 from Rank 0 | size=0.50MB
2026-01-23 11:26:53.468 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=24, chunk=3 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.468 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=0, chunk=4 from Rank 0 | size=0.24MB
2026-01-23 11:26:53.468 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=25, chunk=3 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.468 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=26, chunk=3 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.468 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=1, chunk=4 from Rank 0 | size=0.24MB
2026-01-23 11:26:53.468 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=2, chunk=4 from Rank 0 | size=0.24MB
2026-01-23 11:26:53.468 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=27, chunk=3 from Rank 1 | size=0.50MB
2026-01-23 11:26:53.468 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=3, chunk=4 from Rank 0 | size=0.24MB
2026-01-23 11:26:53.468 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=14, chunk=4 from Rank 1 | size=0.24MB
2026-01-23 11:26:53.468 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=4, chunk=4 from Rank 0 | size=0.24MB
2026-01-23 11:26:53.468 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=15, chunk=4 from Rank 1 | size=0.24MB
2026-01-23 11:26:53.468 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=5, chunk=4 from Rank 0 | size=0.24MB
2026-01-23 11:26:53.468 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=16, chunk=4 from Rank 1 | size=0.24MB
2026-01-23 11:26:53.468 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=6, chunk=4 from Rank 0 | size=0.24MB
2026-01-23 11:26:53.468 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=7, chunk=4 from Rank 0 | size=0.24MB
2026-01-23 11:26:53.468 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=17, chunk=4 from Rank 1 | size=0.24MB
2026-01-23 11:26:53.468 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=8, chunk=4 from Rank 0 | size=0.24MB
2026-01-23 11:26:53.468 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=18, chunk=4 from Rank 1 | size=0.24MB
2026-01-23 11:26:53.469 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=9, chunk=4 from Rank 0 | size=0.24MB
2026-01-23 11:26:53.469 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=19, chunk=4 from Rank 1 | size=0.24MB
2026-01-23 11:26:53.469 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=10, chunk=4 from Rank 0 | size=0.24MB
2026-01-23 11:26:53.469 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=20, chunk=4 from Rank 1 | size=0.24MB
2026-01-23 11:26:53.469 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=11, chunk=4 from Rank 0 | size=0.24MB
2026-01-23 11:26:53.469 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=21, chunk=4 from Rank 1 | size=0.24MB
2026-01-23 11:26:53.469 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=12, chunk=4 from Rank 0 | size=0.24MB
2026-01-23 11:26:53.469 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=22, chunk=4 from Rank 1 | size=0.24MB
2026-01-23 11:26:53.469 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=13, chunk=4 from Rank 0 | size=0.24MB
2026-01-23 11:26:53.469 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=23, chunk=4 from Rank 1 | size=0.24MB
2026-01-23 11:26:53.469 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=24, chunk=4 from Rank 1 | size=0.24MB
2026-01-23 11:26:53.469 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=25, chunk=4 from Rank 1 | size=0.24MB
2026-01-23 11:26:53.469 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=26, chunk=4 from Rank 1 | size=0.24MB
2026-01-23 11:26:53.469 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=27, chunk=4 from Rank 1 | size=0.24MB
2026-01-23 11:26:53.470 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:668] -   [CACHE] 非阻塞接收 140 个 Base Cache
2026-01-23 11:26:53.470 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:507] - [CHUNK 1/5] 完成 | 总耗时: 316.19ms
2026-01-23 11:26:53.470 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:230] - [CHUNK 2/5] 开始处理 | seq_len=128, first=False, last=False
2026-01-23 11:26:53.470 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:245] -   [PHASE 1] 等待接收 Hidden States (from Rank 1)...
2026-01-23 11:26:53.470 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:254] -   [PHASE 1][RECV] Hidden States | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB | chunk_idx=1
2026-01-23 11:26:53.470 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:257] -   [PHASE 1] 完成 | 耗时: 0.12ms
2026-01-23 11:26:53.470 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:263] -   [PHASE 2] 开始计算 Decoder Layers [28, 36)
2026-01-23 11:26:53.470 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:271] -     past_key_values_length=128, seq_with_past=256
2026-01-23 11:26:53.472 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=28 -> Rank 0 | size=0.50MB
2026-01-23 11:26:53.472 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=28 -> Rank 1 | size=0.50MB
2026-01-23 11:26:53.474 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=29 -> Rank 0 | size=0.50MB
2026-01-23 11:26:53.474 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=29 -> Rank 1 | size=0.50MB
2026-01-23 11:26:53.476 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=30 -> Rank 0 | size=0.50MB
2026-01-23 11:26:53.477 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=30 -> Rank 1 | size=0.50MB
2026-01-23 11:26:53.479 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=31 -> Rank 0 | size=0.50MB
2026-01-23 11:26:53.479 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=31 -> Rank 1 | size=0.50MB
2026-01-23 11:26:53.481 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:342] -     [EAGLE] 保存 hidden state layer=32, chunk=1
2026-01-23 11:26:53.482 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=32 -> Rank 0 | size=0.50MB
2026-01-23 11:26:53.482 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=32 -> Rank 1 | size=0.50MB
2026-01-23 11:26:53.484 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=33 -> Rank 0 | size=0.50MB
2026-01-23 11:26:53.484 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=33 -> Rank 1 | size=0.50MB
2026-01-23 11:26:53.486 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=34 -> Rank 0 | size=0.50MB
2026-01-23 11:26:53.487 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=34 -> Rank 1 | size=0.50MB
2026-01-23 11:26:53.489 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=35 -> Rank 0 | size=0.50MB
2026-01-23 11:26:53.489 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=35 -> Rank 1 | size=0.50MB
2026-01-23 11:26:53.489 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:377] -   [PHASE 2] 完成 | layers=8, cache_sent=16, eagle_hidden_sent=0 | 耗时: 19.08ms
2026-01-23 11:26:53.489 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:396] -   [PHASE 3] 执行 Eagle Layer 计算...
2026-01-23 11:26:53.490 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:400] -     Norm 完成 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-23 11:26:53.490 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:404] -     LM Head 完成 | shape=(1, 128, 151936), dtype=float16, device=cuda:0, size=37.094MB
2026-01-23 11:26:53.490 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:407] -   [PHASE 3][RECV] 等待 Eagle Input Hidden States (chunk=1)...
2026-01-23 11:26:53.490 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:417] -   [PHASE 3][RECV] 收到 2 个 Eagle Hidden (chunk=1) | 耗时: 0.22ms
2026-01-23 11:26:53.491 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:421] -     合并后 Eagle Hidden States 层: [1, 17, 32]
2026-01-23 11:26:53.491 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:680] - [EAGLE] Input Layers 配置: [1, 17, 32] (总层数=36)
2026-01-23 11:26:53.491 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:721] -     [EAGLE] 收集 layer 1 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-23 11:26:53.491 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:721] -     [EAGLE] 收集 layer 17 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-23 11:26:53.491 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:721] -     [EAGLE] 收集 layer 32 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-23 11:26:53.491 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:725] -   [EAGLE] 拼接后 hidden_states | shape=(1, 128, 7680), dtype=float16, device=cuda:0, size=1.875MB
2026-01-23 11:26:53.491 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:431] -     EAGLE3 Hidden States | shape=(1, 128, 7680), dtype=float16, device=cuda:0, size=1.875MB
2026-01-23 11:26:53.491 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:456] -     Draft Tree 生成: input_ids range=[129, 257)
2026-01-23 11:26:53.494 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:473] -   [PHASE 3][BROADCAST] Eagle Stable KV | chunk=1, size=0.50MB
2026-01-23 11:26:53.495 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:501] -   [PHASE 3] 完成 | 耗时: 5.19ms
2026-01-23 11:26:53.496 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:507] - [CHUNK 2/5] 完成 | 总耗时: 25.57ms
2026-01-23 11:26:53.496 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:230] - [CHUNK 3/5] 开始处理 | seq_len=128, first=False, last=False
2026-01-23 11:26:53.496 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:245] -   [PHASE 1] 等待接收 Hidden States (from Rank 1)...
2026-01-23 11:26:53.496 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:254] -   [PHASE 1][RECV] Hidden States | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB | chunk_idx=2
2026-01-23 11:26:53.496 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:257] -   [PHASE 1] 完成 | 耗时: 0.09ms
2026-01-23 11:26:53.496 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:263] -   [PHASE 2] 开始计算 Decoder Layers [28, 36)
2026-01-23 11:26:53.496 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:271] -     past_key_values_length=256, seq_with_past=384
2026-01-23 11:26:53.504 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=28 -> Rank 0 | size=0.50MB
2026-01-23 11:26:53.504 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=28 -> Rank 1 | size=0.50MB
2026-01-23 11:26:53.507 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=29 -> Rank 0 | size=0.50MB
2026-01-23 11:26:53.507 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=29 -> Rank 1 | size=0.50MB
2026-01-23 11:26:53.510 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=30 -> Rank 0 | size=0.50MB
2026-01-23 11:26:53.511 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=30 -> Rank 1 | size=0.50MB
2026-01-23 11:26:53.514 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=31 -> Rank 0 | size=0.50MB
2026-01-23 11:26:53.514 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=31 -> Rank 1 | size=0.50MB
2026-01-23 11:26:53.517 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:342] -     [EAGLE] 保存 hidden state layer=32, chunk=2
2026-01-23 11:26:53.517 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=32 -> Rank 0 | size=0.50MB
2026-01-23 11:26:53.518 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=32 -> Rank 1 | size=0.50MB
2026-01-23 11:26:53.520 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=33 -> Rank 0 | size=0.50MB
2026-01-23 11:26:53.520 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=33 -> Rank 1 | size=0.50MB
2026-01-23 11:26:53.523 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=34 -> Rank 0 | size=0.50MB
2026-01-23 11:26:53.523 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=34 -> Rank 1 | size=0.50MB
2026-01-23 11:26:53.526 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=35 -> Rank 0 | size=0.50MB
2026-01-23 11:26:53.526 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=35 -> Rank 1 | size=0.50MB
2026-01-23 11:26:53.526 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:377] -   [PHASE 2] 完成 | layers=8, cache_sent=16, eagle_hidden_sent=0 | 耗时: 30.30ms
2026-01-23 11:26:53.526 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:396] -   [PHASE 3] 执行 Eagle Layer 计算...
2026-01-23 11:26:53.527 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:400] -     Norm 完成 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-23 11:26:53.527 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:404] -     LM Head 完成 | shape=(1, 128, 151936), dtype=float16, device=cuda:0, size=37.094MB
2026-01-23 11:26:53.527 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:407] -   [PHASE 3][RECV] 等待 Eagle Input Hidden States (chunk=2)...
2026-01-23 11:26:53.527 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:417] -   [PHASE 3][RECV] 收到 2 个 Eagle Hidden (chunk=2) | 耗时: 0.18ms
2026-01-23 11:26:53.527 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:421] -     合并后 Eagle Hidden States 层: [1, 17, 32]
2026-01-23 11:26:53.527 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:680] - [EAGLE] Input Layers 配置: [1, 17, 32] (总层数=36)
2026-01-23 11:26:53.527 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:721] -     [EAGLE] 收集 layer 1 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-23 11:26:53.527 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:721] -     [EAGLE] 收集 layer 17 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-23 11:26:53.527 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:721] -     [EAGLE] 收集 layer 32 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-23 11:26:53.528 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:725] -   [EAGLE] 拼接后 hidden_states | shape=(1, 128, 7680), dtype=float16, device=cuda:0, size=1.875MB
2026-01-23 11:26:53.528 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:431] -     EAGLE3 Hidden States | shape=(1, 128, 7680), dtype=float16, device=cuda:0, size=1.875MB
2026-01-23 11:26:53.528 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:456] -     Draft Tree 生成: input_ids range=[257, 385)
2026-01-23 11:26:53.531 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:473] -   [PHASE 3][BROADCAST] Eagle Stable KV | chunk=2, size=0.50MB
2026-01-23 11:26:53.531 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:501] -   [PHASE 3] 完成 | 耗时: 4.57ms
2026-01-23 11:26:53.532 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:507] - [CHUNK 3/5] 完成 | 总耗时: 36.18ms
2026-01-23 11:26:53.532 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:230] - [CHUNK 4/5] 开始处理 | seq_len=128, first=False, last=False
2026-01-23 11:26:53.532 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:245] -   [PHASE 1] 等待接收 Hidden States (from Rank 1)...
2026-01-23 11:26:53.532 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:254] -   [PHASE 1][RECV] Hidden States | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB | chunk_idx=3
2026-01-23 11:26:53.532 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:257] -   [PHASE 1] 完成 | 耗时: 0.36ms
2026-01-23 11:26:53.532 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:263] -   [PHASE 2] 开始计算 Decoder Layers [28, 36)
2026-01-23 11:26:53.533 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:271] -     past_key_values_length=384, seq_with_past=512
2026-01-23 11:26:53.535 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=28 -> Rank 0 | size=0.50MB
2026-01-23 11:26:53.535 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=28 -> Rank 1 | size=0.50MB
2026-01-23 11:26:53.538 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=29 -> Rank 0 | size=0.50MB
2026-01-23 11:26:53.538 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=29 -> Rank 1 | size=0.50MB
2026-01-23 11:26:53.541 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=30 -> Rank 0 | size=0.50MB
2026-01-23 11:26:53.541 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=30 -> Rank 1 | size=0.50MB
2026-01-23 11:26:53.544 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=31 -> Rank 0 | size=0.50MB
2026-01-23 11:26:53.544 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=31 -> Rank 1 | size=0.50MB
2026-01-23 11:26:53.547 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:342] -     [EAGLE] 保存 hidden state layer=32, chunk=3
2026-01-23 11:26:53.547 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=32 -> Rank 0 | size=0.50MB
2026-01-23 11:26:53.547 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=32 -> Rank 1 | size=0.50MB
2026-01-23 11:26:53.550 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=33 -> Rank 0 | size=0.50MB
2026-01-23 11:26:53.550 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=33 -> Rank 1 | size=0.50MB
2026-01-23 11:26:53.553 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=34 -> Rank 0 | size=0.50MB
2026-01-23 11:26:53.553 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=34 -> Rank 1 | size=0.50MB
2026-01-23 11:26:53.556 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=35 -> Rank 0 | size=0.50MB
2026-01-23 11:26:53.556 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=35 -> Rank 1 | size=0.50MB
2026-01-23 11:26:53.556 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:377] -   [PHASE 2] 完成 | layers=8, cache_sent=16, eagle_hidden_sent=0 | 耗时: 23.53ms
2026-01-23 11:26:53.556 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:396] -   [PHASE 3] 执行 Eagle Layer 计算...
2026-01-23 11:26:53.556 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:400] -     Norm 完成 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-23 11:26:53.556 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:404] -     LM Head 完成 | shape=(1, 128, 151936), dtype=float16, device=cuda:0, size=37.094MB
2026-01-23 11:26:53.556 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:407] -   [PHASE 3][RECV] 等待 Eagle Input Hidden States (chunk=3)...
2026-01-23 11:26:53.557 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:417] -   [PHASE 3][RECV] 收到 2 个 Eagle Hidden (chunk=3) | 耗时: 0.18ms
2026-01-23 11:26:53.557 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:421] -     合并后 Eagle Hidden States 层: [1, 17, 32]
2026-01-23 11:26:53.557 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:680] - [EAGLE] Input Layers 配置: [1, 17, 32] (总层数=36)
2026-01-23 11:26:53.557 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:721] -     [EAGLE] 收集 layer 1 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-23 11:26:53.557 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:721] -     [EAGLE] 收集 layer 17 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-23 11:26:53.557 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:721] -     [EAGLE] 收集 layer 32 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-23 11:26:53.557 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:725] -   [EAGLE] 拼接后 hidden_states | shape=(1, 128, 7680), dtype=float16, device=cuda:0, size=1.875MB
2026-01-23 11:26:53.557 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:431] -     EAGLE3 Hidden States | shape=(1, 128, 7680), dtype=float16, device=cuda:0, size=1.875MB
2026-01-23 11:26:53.557 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:456] -     Draft Tree 生成: input_ids range=[385, 513)
2026-01-23 11:26:53.560 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:473] -   [PHASE 3][BROADCAST] Eagle Stable KV | chunk=3, size=0.50MB
2026-01-23 11:26:53.560 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:501] -   [PHASE 3] 完成 | 耗时: 4.30ms
2026-01-23 11:26:53.561 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:507] - [CHUNK 4/5] 完成 | 总耗时: 29.41ms
2026-01-23 11:26:53.562 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:230] - [CHUNK 5/5] 开始处理 | seq_len=62, first=False, last=True
2026-01-23 11:26:53.562 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:245] -   [PHASE 1] 等待接收 Hidden States (from Rank 1)...
2026-01-23 11:26:53.562 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:254] -   [PHASE 1][RECV] Hidden States | shape=(1, 62, 2560), dtype=float16, device=cuda:0, size=0.303MB | chunk_idx=4
2026-01-23 11:26:53.562 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:257] -   [PHASE 1] 完成 | 耗时: 0.35ms
2026-01-23 11:26:53.562 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:263] -   [PHASE 2] 开始计算 Decoder Layers [28, 36)
2026-01-23 11:26:53.562 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:271] -     past_key_values_length=512, seq_with_past=574
2026-01-23 11:26:53.565 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=28 -> Rank 0 | size=0.24MB
2026-01-23 11:26:53.565 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=28 -> Rank 1 | size=0.24MB
2026-01-23 11:26:53.568 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=29 -> Rank 0 | size=0.24MB
2026-01-23 11:26:53.568 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=29 -> Rank 1 | size=0.24MB
2026-01-23 11:26:53.571 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=30 -> Rank 0 | size=0.24MB
2026-01-23 11:26:53.571 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=30 -> Rank 1 | size=0.24MB
2026-01-23 11:26:53.573 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=31 -> Rank 0 | size=0.24MB
2026-01-23 11:26:53.573 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=31 -> Rank 1 | size=0.24MB
2026-01-23 11:26:53.576 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:342] -     [EAGLE] 保存 hidden state layer=32, chunk=4
2026-01-23 11:26:53.576 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=32 -> Rank 0 | size=0.24MB
2026-01-23 11:26:53.576 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=32 -> Rank 1 | size=0.24MB
2026-01-23 11:26:53.579 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=33 -> Rank 0 | size=0.24MB
2026-01-23 11:26:53.579 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=33 -> Rank 1 | size=0.24MB
2026-01-23 11:26:53.582 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=34 -> Rank 0 | size=0.24MB
2026-01-23 11:26:53.582 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=34 -> Rank 1 | size=0.24MB
2026-01-23 11:26:53.585 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=35 -> Rank 0 | size=0.24MB
2026-01-23 11:26:53.585 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=35 -> Rank 1 | size=0.24MB
2026-01-23 11:26:53.585 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:377] -   [PHASE 2] 完成 | layers=8, cache_sent=16, eagle_hidden_sent=0 | 耗时: 23.16ms
2026-01-23 11:26:53.585 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:396] -   [PHASE 3] 执行 Eagle Layer 计算...
2026-01-23 11:26:53.586 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:400] -     Norm 完成 | shape=(1, 62, 2560), dtype=float16, device=cuda:0, size=0.303MB
2026-01-23 11:26:53.586 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:404] -     LM Head 完成 | shape=(1, 62, 151936), dtype=float16, device=cuda:0, size=17.967MB
2026-01-23 11:26:53.586 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:407] -   [PHASE 3][RECV] 等待 Eagle Input Hidden States (chunk=4)...
2026-01-23 11:26:53.586 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:417] -   [PHASE 3][RECV] 收到 2 个 Eagle Hidden (chunk=4) | 耗时: 0.28ms
2026-01-23 11:26:53.586 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:421] -     合并后 Eagle Hidden States 层: [1, 17, 32]
2026-01-23 11:26:53.586 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:680] - [EAGLE] Input Layers 配置: [1, 17, 32] (总层数=36)
2026-01-23 11:26:53.586 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:721] -     [EAGLE] 收集 layer 1 | shape=(1, 62, 2560), dtype=float16, device=cuda:0, size=0.303MB
2026-01-23 11:26:53.586 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:721] -     [EAGLE] 收集 layer 17 | shape=(1, 62, 2560), dtype=float16, device=cuda:0, size=0.303MB
2026-01-23 11:26:53.587 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:721] -     [EAGLE] 收集 layer 32 | shape=(1, 62, 2560), dtype=float16, device=cuda:0, size=0.303MB
2026-01-23 11:26:53.587 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:725] -   [EAGLE] 拼接后 hidden_states | shape=(1, 62, 7680), dtype=float16, device=cuda:0, size=0.908MB
2026-01-23 11:26:53.587 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:431] -     EAGLE3 Hidden States | shape=(1, 62, 7680), dtype=float16, device=cuda:0, size=0.908MB
2026-01-23 11:26:53.629 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:448] -   [PHASE 3] First Token 采样: 14880
2026-01-23 11:26:53.629 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:456] -     Draft Tree 生成: input_ids range=[513, 575)
2026-01-23 11:26:53.649 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:473] -   [PHASE 3][BROADCAST] Eagle Stable KV | chunk=4, size=0.24MB
2026-01-23 11:26:53.650 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:493] -   [PHASE 3][BROADCAST] Draft Tokens | shape=torch.Size([1, 40])
2026-01-23 11:26:53.650 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:498] -   [PHASE 3] Draft Tokens 广播完成
2026-01-23 11:26:53.650 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:501] -   [PHASE 3] 完成 | 耗时: 64.67ms
2026-01-23 11:26:53.651 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:507] - [CHUNK 5/5] 完成 | 总耗时: 89.93ms
2026-01-23 11:26:53.652 - SpecSoT-Rank2 - INFO - [distributed_prefill.py:512] - [PREFILL] Chunks处理完成，开始 Cache 同步...
2026-01-23 11:26:53.652 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:568] - [SYNC] 最后一个 Rank 等待所有 Cache 同步...
2026-01-23 11:26:53.654 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:585] - [SYNC_OK] Rank 2 Cache 同步完成 | 耗时: 2.11ms
2026-01-23 11:26:53.654 - SpecSoT-Rank2 - INFO - [distributed_prefill.py:594] - [PREFILL] 分布式 Prefill 完成 | Rank=2 | 耗时: 0.501s
2026-01-23 11:27:13.868 - SpecSoT-Rank2 - INFO - [run_specsot.py:395] - 
[统计信息]
2026-01-23 11:27:13.868 - SpecSoT-Rank2 - INFO - [run_specsot.py:396] -   总耗时: 20.72s
2026-01-23 11:27:13.868 - SpecSoT-Rank2 - INFO - [run_specsot.py:397] -   峰值显存: 4956.19 MB
2026-01-23 11:27:13.868 - SpecSoT-Rank2 - INFO - [run_specsot.py:398] -   输出长度: 1857 tokens
2026-01-23 11:27:13.868 - SpecSoT-Rank2 - INFO - [run_specsot.py:399] -   吞吐量: 89.6 tokens/s
2026-01-23 11:27:13.868 - SpecSoT-Rank2 - INFO - [run_specsot.py:400] -   并行分支数: 5
2026-01-23 11:27:13.868 - SpecSoT-Rank2 - INFO - [run_specsot.py:401] -   平均接受长度: 0.48
2026-01-23 11:27:13.868 - SpecSoT-Rank2 - INFO - [run_specsot.py:402] -   平均Draft时间: 5.39 ms
2026-01-23 11:27:13.868 - SpecSoT-Rank2 - INFO - [run_specsot.py:403] -   平均Verify时间: 27.68 ms
2026-01-23 11:27:13.868 - SpecSoT-Rank2 - INFO - [run_specsot.py:404] -   平均Update时间: 1.00 ms
2026-01-23 11:27:13.868 - SpecSoT-Rank2 - INFO - [run_specsot.py:407] - 
[响应预览]
2026-01-23 11:27:13.868 - SpecSoT-Rank2 - INFO - [run_specsot.py:408] - 请认真阅读上面的系统指令，严格按照要求生成骨架。这是关于篮球投篮命中率的复杂问题，需要从多个角度分析，各个角度之间相对独立，因此应选择【方法 B】生成思维骨架。

#### 技术训练【120】:......

#### 指南原则【130】:......

#### 心理调整【110】:......

#### 身体状态【140】:......

#### 比赛策略【150】:......

####%%%%

#### 技术训练【120】: 
掌握正确的投篮姿势是提高命中率的基础。保持身体平衡，双脚分开与肩同宽，膝盖微屈，重心放在前脚掌。投篮时，手臂自然伸展，手腕发力，手指控制球的旋转，确保球飞行轨迹稳定。练习时，可以专注于手腕的发力动作，避免过度使用手臂力量。此外，投篮时的出手角度也很重要，通常建议在90度左右，这样球能更稳定地进入篮筐。可以通过对着篮筐进行反复练习，逐渐形成肌肉记忆，提高出手的准确性和稳定性。同时，注意投篮时的节奏，保持稳定的出手速度，避免急躁或犹豫，这样有助于提高命中率。
</think>



掌握正确的投篮姿势是提高命中率的基础。保持身体平衡，双脚分开与肩同宽...
2026-01-23 11:27:13.868 - SpecSoT-Rank2 - DEBUG - [run_specsot.py:462] - 正在清理分布式资源...
2026-01-23 11:27:13.868 - SpecSoT-Rank2 - INFO - [distributed_prefill.py:155] - [CLEANUP] 通信统计: {'draft_tokens_sent': 2, 'draft_tokens_recv': 0, 'hidden_sent': 0, 'hidden_recv': 5, 'eagle_input_hidden_sent': 0, 'eagle_input_hidden_recv': 10, 'base_cache_sent': 80, 'base_cache_recv': 140, 'eagle_cache_sent': 10, 'eagle_cache_recv': 0, 'aggregated_sends': 0, 'forwarded_messages': 0}
2026-01-23 11:27:13.939 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:158] - [CLEANUP] 分布式Prefill管理器已清理
2026-01-23 11:27:13.939 - SpecSoT-Rank2 - DEBUG - [run_specsot.py:464] - 分布式资源已清理
2026-01-23 11:27:13.939 - SpecSoT-Rank2 - INFO - [run_specsot.py:466] - Worker 执行完成
3] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-23 11:26:53.378 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=17, chunk_idx=4, seq_id=129, latency=808.61ms
2026-01-23 11:26:53.378 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-23 11:26:53.380 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 0 | layer_idx=8, chunk_idx=4, seq_id=139, latency=1863.21ms
2026-01-23 11:26:53.380 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-23 11:26:53.381 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=18, chunk_idx=4, seq_id=131, latency=807.18ms
2026-01-23 11:26:53.381 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-23 11:26:53.381 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 0 | layer_idx=9, chunk_idx=4, seq_id=141, latency=1855.48ms
2026-01-23 11:26:53.381 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-23 11:26:53.382 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=19, chunk_idx=4, seq_id=133, latency=805.12ms
2026-01-23 11:26:53.382 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-23 11:26:53.383 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 0 | layer_idx=10, chunk_idx=4, seq_id=143, latency=1852.93ms
2026-01-23 11:26:53.383 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-23 11:26:53.384 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=20, chunk_idx=4, seq_id=135, latency=803.40ms
2026-01-23 11:26:53.384 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-23 11:26:53.388 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 0 | layer_idx=11, chunk_idx=4, seq_id=145, latency=1854.27ms
2026-01-23 11:26:53.388 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-23 11:26:53.389 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=21, chunk_idx=4, seq_id=137, latency=804.70ms
2026-01-23 11:26:53.389 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-23 11:26:53.390 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 0 | layer_idx=12, chunk_idx=4, seq_id=147, latency=1852.49ms
2026-01-23 11:26:53.390 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-23 11:26:53.395 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=22, chunk_idx=4, seq_id=139, latency=807.19ms
2026-01-23 11:26:53.395 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-23 11:26:53.396 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 0 | layer_idx=13, chunk_idx=4, seq_id=149, latency=1854.97ms
2026-01-23 11:26:53.396 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-23 11:26:53.398 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=23, chunk_idx=4, seq_id=141, latency=806.67ms
2026-01-23 11:26:53.398 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-23 11:26:53.398 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=28, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.399 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=28, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.400 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=24, chunk_idx=4, seq_id=143, latency=805.29ms
2026-01-23 11:26:53.401 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-23 11:26:53.403 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=25, chunk_idx=4, seq_id=145, latency=804.45ms
2026-01-23 11:26:53.403 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-23 11:26:53.403 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=1, layer_idx=28, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=4.80ms
2026-01-23 11:26:53.405 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=26, chunk_idx=4, seq_id=147, latency=802.42ms
2026-01-23 11:26:53.405 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-23 11:26:53.406 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:239] - [RECV] HIDDEN from rank 1 | chunk_idx=4, seq_id=150, latency=799.43ms
2026-01-23 11:26:53.406 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:243] -   hidden_state: shape=(1, 62, 2560), dtype=float16, device=cuda:0, size=0.303MB
2026-01-23 11:26:53.408 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=2, layer_idx=28, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=3.90ms
2026-01-23 11:26:53.408 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=27, chunk_idx=4, seq_id=149, latency=802.69ms
2026-01-23 11:26:53.408 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-23 11:26:53.409 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=29, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.409 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=29, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.411 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=3, layer_idx=29, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.69ms
2026-01-23 11:26:53.411 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=30, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.412 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=30, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.413 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=4, layer_idx=29, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.74ms
2026-01-23 11:26:53.414 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=5, layer_idx=30, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.41ms
2026-01-23 11:26:53.414 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=31, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.414 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=31, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.416 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=6, layer_idx=30, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.42ms
2026-01-23 11:26:53.417 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=32, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.417 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=32, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.418 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=7, layer_idx=31, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.51ms
2026-01-23 11:26:53.419 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=8, layer_idx=31, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.37ms
2026-01-23 11:26:53.419 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=33, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.420 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=33, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.421 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=9, layer_idx=32, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.43ms
2026-01-23 11:26:53.421 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=34, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.422 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=34, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.422 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=10, layer_idx=32, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.50ms
2026-01-23 11:26:53.424 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=11, layer_idx=33, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.36ms
2026-01-23 11:26:53.424 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=35, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.424 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=35, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.425 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:582] - [WAIT] 等待接收 ALL_EAGLE_INPUT_HIDDEN | expected_layers=[1, 17], chunk_idx=0, my_range=[28, 36), timeout=60.0s
2026-01-23 11:26:53.425 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:606] - [RECV_OK] EAGLE_INPUT_HIDDEN | layer_idx=1, chunk_idx=0, from rank 0, remaining={17}
2026-01-23 11:26:53.425 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:610] -   hidden: shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-23 11:26:53.425 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:606] - [RECV_OK] EAGLE_INPUT_HIDDEN | layer_idx=17, chunk_idx=0, from rank 1, remaining=set()
2026-01-23 11:26:53.425 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:610] -   hidden: shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-23 11:26:53.425 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:627] - [RECV_OK] ALL_EAGLE_INPUT_HIDDEN 全部接收完成 | chunk_idx=0, layers=[1, 17], wait_time=0.10ms
2026-01-23 11:26:53.427 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=12, layer_idx=33, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=2.80ms
2026-01-23 11:26:53.429 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=13, layer_idx=34, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.41ms
2026-01-23 11:26:53.439 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=14, layer_idx=34, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=10.42ms
2026-01-23 11:26:53.441 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=15, layer_idx=35, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.36ms
2026-01-23 11:26:53.442 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=16, layer_idx=35, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.24ms
2026-01-23 11:26:53.460 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:348] - [BROADCAST] EAGLE_STABLE_KV -> targets=[0, 1] | chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.460 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:313] - [QUEUE] EAGLE_CACHE -> rank 0 | chunk_idx=0, incremental=True, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.460 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:313] - [QUEUE] EAGLE_CACHE -> rank 1 | chunk_idx=0, incremental=True, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.462 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:162] - [SEND] EAGLE_CACHE -> rank 0 | seq_id=17, chunk_idx=0, incremental=True, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.48ms
2026-01-23 11:26:53.464 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:162] - [SEND] EAGLE_CACHE -> rank 1 | seq_id=18, chunk_idx=0, incremental=True, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.51ms
2026-01-23 11:26:53.470 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:430] - [WAIT] 等待接收 HIDDEN (src_rank=1, timeout=60.0s)
2026-01-23 11:26:53.470 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:448] - [RECV_OK] HIDDEN 接收成功 | from rank 1, chunk_idx=1, wait_time=0.02ms
2026-01-23 11:26:53.470 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:453] -   hidden: shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-23 11:26:53.472 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=28, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.472 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=28, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.473 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=19, layer_idx=28, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.49ms
2026-01-23 11:26:53.474 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=29, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.474 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=29, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.475 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=20, layer_idx=28, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.55ms
2026-01-23 11:26:53.476 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=30, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.476 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=30, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.477 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=21, layer_idx=29, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.67ms
2026-01-23 11:26:53.479 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=22, layer_idx=29, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.39ms
2026-01-23 11:26:53.479 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=31, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.479 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=31, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.480 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=23, layer_idx=30, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.50ms
2026-01-23 11:26:53.482 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=32, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.482 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=24, layer_idx=30, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.44ms
2026-01-23 11:26:53.482 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=32, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.483 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=25, layer_idx=31, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.37ms
2026-01-23 11:26:53.484 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=33, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.484 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=33, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.485 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=26, layer_idx=31, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.55ms
2026-01-23 11:26:53.486 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=34, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.487 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=34, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.487 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=27, layer_idx=32, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.59ms
2026-01-23 11:26:53.489 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=28, layer_idx=32, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.71ms
2026-01-23 11:26:53.489 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=35, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.489 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=35, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.490 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:582] - [WAIT] 等待接收 ALL_EAGLE_INPUT_HIDDEN | expected_layers=[1, 17], chunk_idx=1, my_range=[28, 36), timeout=60.0s
2026-01-23 11:26:53.490 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:606] - [RECV_OK] EAGLE_INPUT_HIDDEN | layer_idx=1, chunk_idx=1, from rank 0, remaining={17}
2026-01-23 11:26:53.490 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:610] -   hidden: shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-23 11:26:53.490 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:606] - [RECV_OK] EAGLE_INPUT_HIDDEN | layer_idx=17, chunk_idx=1, from rank 1, remaining=set()
2026-01-23 11:26:53.490 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:610] -   hidden: shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-23 11:26:53.490 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:627] - [RECV_OK] ALL_EAGLE_INPUT_HIDDEN 全部接收完成 | chunk_idx=1, layers=[1, 17], wait_time=0.12ms
2026-01-23 11:26:53.490 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=29, layer_idx=33, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.69ms
2026-01-23 11:26:53.492 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=30, layer_idx=33, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.57ms
2026-01-23 11:26:53.494 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=31, layer_idx=34, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.31ms
2026-01-23 11:26:53.494 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:348] - [BROADCAST] EAGLE_STABLE_KV -> targets=[0, 1] | chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.494 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:313] - [QUEUE] EAGLE_CACHE -> rank 0 | chunk_idx=1, incremental=True, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.495 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:313] - [QUEUE] EAGLE_CACHE -> rank 1 | chunk_idx=1, incremental=True, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.495 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=32, layer_idx=34, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.50ms
2026-01-23 11:26:53.496 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:430] - [WAIT] 等待接收 HIDDEN (src_rank=1, timeout=60.0s)
2026-01-23 11:26:53.496 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:448] - [RECV_OK] HIDDEN 接收成功 | from rank 1, chunk_idx=2, wait_time=0.02ms
2026-01-23 11:26:53.496 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:453] -   hidden: shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-23 11:26:53.497 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=33, layer_idx=35, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.44ms
2026-01-23 11:26:53.503 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=34, layer_idx=35, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=5.76ms
2026-01-23 11:26:53.504 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=28, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.504 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=28, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.505 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:162] - [SEND] EAGLE_CACHE -> rank 0 | seq_id=35, chunk_idx=1, incremental=True, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.55ms
2026-01-23 11:26:53.506 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=37, layer_idx=28, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.22ms
2026-01-23 11:26:53.507 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=29, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.507 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=29, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.507 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=38, layer_idx=28, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.26ms
2026-01-23 11:26:53.509 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=39, layer_idx=29, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.17ms
2026-01-23 11:26:53.510 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=30, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.510 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=40, layer_idx=29, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.26ms
2026-01-23 11:26:53.510 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=30, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.512 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=41, layer_idx=30, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.56ms
2026-01-23 11:26:53.513 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=42, layer_idx=30, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.07ms
2026-01-23 11:26:53.514 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=31, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.514 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=31, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.515 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:162] - [SEND] EAGLE_CACHE -> rank 1 | seq_id=36, chunk_idx=1, incremental=True, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.41ms
2026-01-23 11:26:53.516 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=43, layer_idx=31, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.12ms
2026-01-23 11:26:53.517 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=32, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.517 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=44, layer_idx=31, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.27ms
2026-01-23 11:26:53.517 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=32, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.519 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=45, layer_idx=32, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.16ms
2026-01-23 11:26:53.520 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=46, layer_idx=32, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.12ms
2026-01-23 11:26:53.520 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=33, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.520 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=33, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.522 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=47, layer_idx=33, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.26ms
2026-01-23 11:26:53.523 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=48, layer_idx=33, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.11ms
2026-01-23 11:26:53.523 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=34, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.523 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=34, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.524 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=49, layer_idx=34, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.25ms
2026-01-23 11:26:53.526 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=50, layer_idx=34, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.13ms
2026-01-23 11:26:53.526 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=35, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.526 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=35, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.527 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:582] - [WAIT] 等待接收 ALL_EAGLE_INPUT_HIDDEN | expected_layers=[1, 17], chunk_idx=2, my_range=[28, 36), timeout=60.0s
2026-01-23 11:26:53.527 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:606] - [RECV_OK] EAGLE_INPUT_HIDDEN | layer_idx=1, chunk_idx=2, from rank 0, remaining={17}
2026-01-23 11:26:53.527 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:610] -   hidden: shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-23 11:26:53.527 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:606] - [RECV_OK] EAGLE_INPUT_HIDDEN | layer_idx=17, chunk_idx=2, from rank 1, remaining=set()
2026-01-23 11:26:53.527 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:610] -   hidden: shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-23 11:26:53.527 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:627] - [RECV_OK] ALL_EAGLE_INPUT_HIDDEN 全部接收完成 | chunk_idx=2, layers=[1, 17], wait_time=0.16ms
2026-01-23 11:26:53.528 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=51, layer_idx=35, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=2.18ms
2026-01-23 11:26:53.530 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=52, layer_idx=35, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.13ms
2026-01-23 11:26:53.531 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:348] - [BROADCAST] EAGLE_STABLE_KV -> targets=[0, 1] | chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.531 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:313] - [QUEUE] EAGLE_CACHE -> rank 0 | chunk_idx=2, incremental=True, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.531 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:313] - [QUEUE] EAGLE_CACHE -> rank 1 | chunk_idx=2, incremental=True, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.532 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:430] - [WAIT] 等待接收 HIDDEN (src_rank=1, timeout=60.0s)
2026-01-23 11:26:53.532 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:448] - [RECV_OK] HIDDEN 接收成功 | from rank 1, chunk_idx=3, wait_time=0.04ms
2026-01-23 11:26:53.532 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:453] -   hidden: shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-23 11:26:53.532 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:162] - [SEND] EAGLE_CACHE -> rank 0 | seq_id=53, chunk_idx=2, incremental=True, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.30ms
2026-01-23 11:26:53.534 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:162] - [SEND] EAGLE_CACHE -> rank 1 | seq_id=54, chunk_idx=2, incremental=True, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.21ms
2026-01-23 11:26:53.535 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=28, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.535 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=28, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.536 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=55, layer_idx=28, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.19ms
2026-01-23 11:26:53.538 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=56, layer_idx=28, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.11ms
2026-01-23 11:26:53.538 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=29, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.538 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=29, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.539 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=57, layer_idx=29, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.25ms
2026-01-23 11:26:53.541 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=58, layer_idx=29, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.13ms
2026-01-23 11:26:53.541 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=30, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.541 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=30, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.543 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=59, layer_idx=30, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.51ms
2026-01-23 11:26:53.544 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=60, layer_idx=30, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.16ms
2026-01-23 11:26:53.544 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=31, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.544 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=31, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.545 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=61, layer_idx=31, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.21ms
2026-01-23 11:26:53.547 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=62, layer_idx=31, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.14ms
2026-01-23 11:26:53.547 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=32, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.547 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=32, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.548 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=63, layer_idx=32, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.22ms
2026-01-23 11:26:53.550 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=64, layer_idx=32, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.20ms
2026-01-23 11:26:53.550 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=33, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.550 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=33, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.551 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=65, layer_idx=33, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.17ms
2026-01-23 11:26:53.553 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=34, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.553 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=66, layer_idx=33, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.23ms
2026-01-23 11:26:53.553 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=34, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.554 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=67, layer_idx=34, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.18ms
2026-01-23 11:26:53.555 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=68, layer_idx=34, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.13ms
2026-01-23 11:26:53.556 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=35, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.556 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=35, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.556 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:582] - [WAIT] 等待接收 ALL_EAGLE_INPUT_HIDDEN | expected_layers=[1, 17], chunk_idx=3, my_range=[28, 36), timeout=60.0s
2026-01-23 11:26:53.556 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:606] - [RECV_OK] EAGLE_INPUT_HIDDEN | layer_idx=1, chunk_idx=3, from rank 0, remaining={17}
2026-01-23 11:26:53.557 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:610] -   hidden: shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-23 11:26:53.557 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:606] - [RECV_OK] EAGLE_INPUT_HIDDEN | layer_idx=17, chunk_idx=3, from rank 1, remaining=set()
2026-01-23 11:26:53.557 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:610] -   hidden: shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-23 11:26:53.557 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:627] - [RECV_OK] ALL_EAGLE_INPUT_HIDDEN 全部接收完成 | chunk_idx=3, layers=[1, 17], wait_time=0.15ms
2026-01-23 11:26:53.558 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=69, layer_idx=35, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=2.11ms
2026-01-23 11:26:53.559 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=70, layer_idx=35, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.13ms
2026-01-23 11:26:53.560 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:348] - [BROADCAST] EAGLE_STABLE_KV -> targets=[0, 1] | chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.560 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:313] - [QUEUE] EAGLE_CACHE -> rank 0 | chunk_idx=3, incremental=True, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.560 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:313] - [QUEUE] EAGLE_CACHE -> rank 1 | chunk_idx=3, incremental=True, key_shape=(1, 8, 128, 128)
2026-01-23 11:26:53.562 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:430] - [WAIT] 等待接收 HIDDEN (src_rank=1, timeout=60.0s)
2026-01-23 11:26:53.562 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:448] - [RECV_OK] HIDDEN 接收成功 | from rank 1, chunk_idx=4, wait_time=0.03ms
2026-01-23 11:26:53.562 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:453] -   hidden: shape=(1, 62, 2560), dtype=float16, device=cuda:0, size=0.303MB
2026-01-23 11:26:53.562 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:162] - [SEND] EAGLE_CACHE -> rank 0 | seq_id=71, chunk_idx=3, incremental=True, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.30ms
2026-01-23 11:26:53.563 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:162] - [SEND] EAGLE_CACHE -> rank 1 | seq_id=72, chunk_idx=3, incremental=True, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.25ms
2026-01-23 11:26:53.565 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=28, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-23 11:26:53.565 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=28, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-23 11:26:53.566 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=73, layer_idx=28, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=1.01ms
2026-01-23 11:26:53.567 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=74, layer_idx=28, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.89ms
2026-01-23 11:26:53.568 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=29, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-23 11:26:53.568 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=29, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-23 11:26:53.569 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=75, layer_idx=29, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.97ms
2026-01-23 11:26:53.570 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=76, layer_idx=29, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.94ms
2026-01-23 11:26:53.570 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=30, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-23 11:26:53.571 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=30, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-23 11:26:53.572 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=77, layer_idx=30, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.94ms
2026-01-23 11:26:53.573 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=78, layer_idx=30, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.91ms
2026-01-23 11:26:53.573 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=31, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-23 11:26:53.573 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=31, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-23 11:26:53.574 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=79, layer_idx=31, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=1.07ms
2026-01-23 11:26:53.575 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=80, layer_idx=31, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.90ms
2026-01-23 11:26:53.576 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=32, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-23 11:26:53.576 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=32, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-23 11:26:53.577 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=81, layer_idx=32, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.92ms
2026-01-23 11:26:53.578 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=82, layer_idx=32, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.85ms
2026-01-23 11:26:53.579 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=33, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-23 11:26:53.579 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=33, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-23 11:26:53.580 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=83, layer_idx=33, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=1.03ms
2026-01-23 11:26:53.581 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=84, layer_idx=33, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.86ms
2026-01-23 11:26:53.582 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=34, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-23 11:26:53.582 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=34, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-23 11:26:53.583 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=85, layer_idx=34, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=1.22ms
2026-01-23 11:26:53.584 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=86, layer_idx=34, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.88ms
2026-01-23 11:26:53.585 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=35, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-23 11:26:53.585 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=35, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-23 11:26:53.586 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:582] - [WAIT] 等待接收 ALL_EAGLE_INPUT_HIDDEN | expected_layers=[1, 17], chunk_idx=4, my_range=[28, 36), timeout=60.0s
2026-01-23 11:26:53.586 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:606] - [RECV_OK] EAGLE_INPUT_HIDDEN | layer_idx=1, chunk_idx=4, from rank 0, remaining={17}
2026-01-23 11:26:53.586 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:610] -   hidden: shape=(1, 62, 2560), dtype=float16, device=cuda:0, size=0.303MB
2026-01-23 11:26:53.586 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:606] - [RECV_OK] EAGLE_INPUT_HIDDEN | layer_idx=17, chunk_idx=4, from rank 1, remaining=set()
2026-01-23 11:26:53.586 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:610] -   hidden: shape=(1, 62, 2560), dtype=float16, device=cuda:0, size=0.303MB
2026-01-23 11:26:53.586 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:627] - [RECV_OK] ALL_EAGLE_INPUT_HIDDEN 全部接收完成 | chunk_idx=4, layers=[1, 17], wait_time=0.15ms
2026-01-23 11:26:53.586 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=87, layer_idx=35, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=1.38ms
2026-01-23 11:26:53.588 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=88, layer_idx=35, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=1.12ms
2026-01-23 11:26:53.649 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:348] - [BROADCAST] EAGLE_STABLE_KV -> targets=[0, 1] | chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-23 11:26:53.649 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:313] - [QUEUE] EAGLE_CACHE -> rank 0 | chunk_idx=4, incremental=True, key_shape=(1, 8, 62, 128)
2026-01-23 11:26:53.650 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:313] - [QUEUE] EAGLE_CACHE -> rank 1 | chunk_idx=4, incremental=True, key_shape=(1, 8, 62, 128)
2026-01-23 11:26:53.650 - SpecSoT-Rank2-Comm - INFO - [p2p_comm_manager.py:207] - [BROADCAST] DRAFT_TOKENS -> targets=[0, 1] | draft_shape=(1, 40)
2026-01-23 11:26:53.650 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:211] -   retrieve_shape=(1, 22, 6), mask_shape=(1, 1, 40, 40)
2026-01-23 11:26:53.651 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:162] - [SEND] EAGLE_CACHE -> rank 0 | seq_id=89, chunk_idx=4, incremental=True, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.96ms
2026-01-23 11:26:53.652 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:118] - [SEND] DRAFT_TOKENS -> rank 0 | seq_id=91, draft_shape=(1, 40), size=9.33KB, time=0.91ms
2026-01-23 11:26:53.652 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:118] - [SEND] DRAFT_TOKENS -> rank 1 | seq_id=92, draft_shape=(1, 40), size=9.33KB, time=0.45ms
2026-01-23 11:26:53.653 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:162] - [SEND] EAGLE_CACHE -> rank 1 | seq_id=90, chunk_idx=4, incremental=True, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.91ms
2026-01-23 11:26:53.654 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:776] - [WAIT] 等待接收所有 Cache | expected_base_caches=0, expected_eagle_caches=0, my_layer_range=[28, 36), timeout=60.0s
2026-01-23 11:26:53.654 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:781] -   待接收的 base cache: []
2026-01-23 11:26:53.654 - SpecSoT-Rank2-Comm - INFO - [base_comm_manager.py:858] - [SYNC_OK] 所有 Cache 接收完成 | base_cache=0, eagle_cache=0, wait_time=2.09ms
2026-01-23 11:27:13.870 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:102] - [THREAD] 发送线程退出
2026-01-23 11:27:13.932 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:189] - 接收线程退出
2026-01-23 11:27:13.939 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:329] - 通信管理器已停止
