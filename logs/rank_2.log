2026-01-22 22:57:41.865 - SpecSoT-Rank2-Comm - INFO - [logging_utils.py:155] - æ—¥å¿—å°†ä¿å­˜åˆ°: /data/home/chenyu/Coding/SD+SoT/Speculative-Decoding-Enabled-Skeleton-of-Thought/logs/rank_2.log
22026-01-22 22:57:45.872 - SpecSoT-Rank2-Model - INFO - [specsot_model.py:320] - åˆ†å¸ƒå¼æ¨ç†å·²å¯ç”¨: DistributedConfig(rank=2/2, layer_splits=[14, 28], comm_mode=p2p)
2026-01-22 22:57:49.219 - SpecSoT-Rank2-Model - INFO - [specsot_model.py:650] - Generated Skeleton: åˆ†æè¿™ä¸ªé—®é¢˜æ˜¯å¦å±äºéœ€è¦æ‹†è§£è§„åˆ’çš„â€œå¤æ‚ä»»åŠ¡â€ï¼š

é—®é¢˜è¦æ±‚â€œè¯¦ç»†å»ºè®®â€ï¼Œæ¶‰åŠå¤šä¸ªç‹¬ç«‹çš„æ–¹é¢ï¼Œå¦‚æŠ€æœ¯åŠ¨ä½œã€è®­ç»ƒæ–¹æ³•ã€å¿ƒç†å› ç´ ã€åœºåœ°æ¡ä»¶ç­‰ï¼Œè¿™äº›éƒ¨åˆ†å¯ä»¥å¹¶è¡Œè€ƒè™‘ï¼Œå› æ­¤å±äºå¤æ‚ä»»åŠ¡ï¼Œå¿…é¡»æ‹†è§£è§„åˆ’ã€‚

æ‰§è¡Œæ–¹æ³•Bï¼Œç”Ÿæˆæ€ç»´éª¨æ¶ï¼š

#### æŠ€æœ¯åŠ¨ä½œè§„èŒƒã€212ã€‘:......

#### è®­ç»ƒè®¡åˆ’åˆ¶å®šã€189ã€‘:......

#### å¿ƒç†ç´ è´¨æå‡ã€199ã€‘:......

#### åœºåœ°ä¸è£…å¤‡ä¼˜åŒ–ã€156ã€‘:......

#### æ¯”èµ›ç»éªŒç§¯ç´¯ã€204ã€‘:......

####%%%%
2026-01-22 22:57:49.225 - SpecSoT-Rank2-Model - INFO - [specsot_model.py:673] - Detected 5 parallel branches with predicted lengths: [200, 200, 200, 200, 200]
2026-01-22 22:57:49.402 - SpecSoT-Rank2-Model - DEBUG - [specsot_model.py:722] - Parallel Decoding Step 1
2026-01-22 22:57:51.591 - SpecSoT-Rank2-Model - DEBUG - [specsot_model.py:722] - Parallel Decoding Step 51
2026-01-22 22:57:53.850 - SpecSoT-Rank2-Model - DEBUG - [specsot_model.py:722] - Parallel Decoding Step 101
2026-01-22 22:57:55.760 - SpecSoT-Rank2-Model - DEBUG - [specsot_model.py:722] - Parallel Decoding Step 151
2026-01-22 22:57:57.479 - SpecSoT-Rank2-Model - DEBUG - [specsot_model.py:722] - Parallel Decoding Step 201
2026-01-22 22:57:59.185 - SpecSoT-Rank2-Model - DEBUG - [specsot_model.py:722] - Parallel Decoding Step 251
2026-01-22 22:58:00.766 - SpecSoT-Rank2-Model - DEBUG - [specsot_model.py:722] - Parallel Decoding Step 301
2026-01-22 22:58:02.340 - SpecSoT-Rank2-Model - DEBUG - [specsot_model.py:722] - Parallel Decoding Step 351
2026-01-22 22:58:03.949 - SpecSoT-Rank2-Model - DEBUG - [specsot_model.py:722] - Parallel Decoding Step 401
2026-01-22 22:58:05.586 - SpecSoT-Rank2-Model - DEBUG - [specsot_model.py:722] - Parallel Decoding Step 451
2026-01-22 22:58:06.879 - SpecSoT-Rank2-Model - INFO - [specsot_model.py:756] - All branches finished generation.
2026-01-22 22:58:06.879 - SpecSoT-Rank2-Model - INFO - [specsot_model.py:766] - Avg accepted lengths: 0.53, Avg draft time: 0.0056s, Avg update time: 0.0011s, Avg verify time: 0.0289s
len=574
2026-01-22 22:57:45.921 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:758] - [INIT] Cache è¿½è¸ªåˆå§‹åŒ–: chunks=5, layers=36, seq_len=574
2026-01-22 22:57:45.921 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:625] - [SPLIT] è¾“å…¥åºåˆ—åˆ‡åˆ†ä¸º 5 ä¸ª chunks | seq_len=574, chunk_size=128
2026-01-22 22:57:45.921 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:627] -     Chunk 0: shape=torch.Size([1, 128])
2026-01-22 22:57:45.921 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:627] -     Chunk 1: shape=torch.Size([1, 128])
2026-01-22 22:57:45.921 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:627] -     Chunk 2: shape=torch.Size([1, 128])
2026-01-22 22:57:45.921 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:627] -     Chunk 3: shape=torch.Size([1, 128])
2026-01-22 22:57:45.922 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:627] -     Chunk 4: shape=torch.Size([1, 62])
2026-01-22 22:57:45.922 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:212] -   Chunkæ•°é‡: 5 (chunk_size=128)
2026-01-22 22:57:45.922 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:680] - [EAGLE] Input Layers é…ç½®: [1, 17, 32] (æ€»å±‚æ•°=36)
2026-01-22 22:57:45.922 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:216] -   Eagle Input Layers: [1, 17, 32]
2026-01-22 22:57:45.922 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:230] - [CH2026-01-22 22:57:46 - SpecSoT-Rank2 - INFO - [PREFILL] Chunkså¤„ç†å®Œæˆï¼Œå¼€å§‹ Cache åŒæ­¥...
2026-01-22 22:57:46 - SpecSoT-Rank2 - INFO - [PREFILL] åˆ†å¸ƒå¼ Prefill å®Œæˆ | Rank=2 | è€—æ—¶: 0.470s
2026-01-22 22:57:49 - SpecSoT-Rank2-Model - INFO - Generated Skeleton: åˆ†æè¿™ä¸ªé—®é¢˜æ˜¯å¦å±äºéœ€è¦æ‹†è§£è§„åˆ’çš„â€œå¤æ‚ä»»åŠ¡â€ï¼š

é—®é¢˜è¦æ±‚â€œè¯¦ç»†å»ºè®®â€ï¼Œæ¶‰åŠå¤šä¸ªç‹¬ç«‹çš„æ–¹é¢ï¼Œå¦‚æŠ€æœ¯åŠ¨ä½œã€è®­ç»ƒæ–¹æ³•ã€å¿ƒç†å› ç´ ã€åœºåœ°æ¡ä»¶ç­‰ï¼Œè¿™äº›éƒ¨åˆ†å¯ä»¥å¹¶è¡Œè€ƒè™‘ï¼Œå› æ­¤å±äºå¤æ‚ä»»åŠ¡ï¼Œå¿…é¡»æ‹†è§£è§„åˆ’ã€‚

æ‰§è¡Œæ–¹æ³•Bï¼Œç”Ÿæˆæ€ç»´éª¨æ¶ï¼š

#### æŠ€æœ¯åŠ¨ä½œè§„èŒƒã€212ã€‘:......

#### è®­ç»ƒè®¡åˆ’åˆ¶å®šã€189ã€‘:......

#### å¿ƒç†ç´ è´¨æå‡ã€199ã€‘:......

#### åœºåœ°ä¸è£…å¤‡ä¼˜åŒ–ã€156ã€‘:......

#### æ¯”èµ›ç»éªŒç§¯ç´¯ã€204ã€‘:......

####%%%%
2026-01-22 22:57:49 - SpecSoT-Rank2-Model - INFO - Detected 5 parallel branches with predicted lengths: [200, 200, 200, 200, 200]
Branch 0 finished with EOS.
Branch 1 finished with EOS.
Branch 4 finished with EOS.
Branch 3 finished with EOS.
Branch 2 finished with EOS.
2026-01-22 22:58:06 - SpecSoT-Rank2-Model - INFO - All branches finished generation.
2026-01-22 22:58:06 - SpecSoT-Rank2-Model - INFO - Avg accepted lengths: 0.53, Avg draft time: 0.0056s, Avg update time: 0.0011s, Avg verify time: 0.0289s
Branch 0 Length: 122
Branch 1 Length: 171
Branch 2 Length: 586
Branch 3 Length: 567
Branch 4 Length: 309
2026-01-22 22:58:06 - SpecSoT-Rank2 - INFO - 
[ç»Ÿè®¡ä¿¡æ¯]
2026-01-22 22:58:06 - SpecSoT-Rank2 - INFO -   æ€»è€—æ—¶: 20.99s
2026-01-22 22:58:06 - SpecSoT-Rank2 - INFO -   å³°å€¼æ˜¾å­˜: 4474.25 MB
2026-01-22 22:58:06 - SpecSoT-Rank2 - INFO -   è¾“å‡ºé•¿åº¦: 1901 tokens
2026-01-22 22:58:06 - SpecSoT-Rank2 - INFO -   ååé‡: 90.6 tokens/s
2026-01-22 22:58:06 - SpecSoT-Rank2 - INFO -   å¹¶è¡Œåˆ†æ”¯æ•°: 5
2026-01-22 22:58:06 - SpecSoT-Rank2 - INFO -   å¹³å‡æ¥å—é•¿åº¦: 0.53
2026-01-22 22:58:06 - SpecSoT-Rank2 - INFO -   å¹³å‡Draftæ—¶é—´: 5.59 ms
2026-01-22 22:58:06 - SpecSoT-Rank2 - INFO -   å¹³å‡Verifyæ—¶é—´: 28.90 ms
2026-01-22 22:58:06 - SpecSoT-Rank2 - INFO -   å¹³å‡Updateæ—¶é—´: 1.06 ms
2026-01-22 22:58:06 - SpecSoT-Rank2 - INFO - 
[å“åº”é¢„è§ˆ]
2026-01-22 22:58:06 - SpecSoT-Rank2 - INFO - åˆ†æè¿™ä¸ªé—®é¢˜æ˜¯å¦å±äºéœ€è¦æ‹†è§£è§„åˆ’çš„â€œå¤æ‚ä»»åŠ¡â€ï¼š

é—®é¢˜è¦æ±‚â€œè¯¦ç»†å»ºè®®â€ï¼Œæ¶‰åŠå¤šä¸ªç‹¬ç«‹çš„æ–¹é¢ï¼Œå¦‚æŠ€æœ¯åŠ¨ä½œã€è®­ç»ƒæ–¹æ³•ã€å¿ƒç†å› ç´ ã€åœºåœ°æ¡ä»¶ç­‰ï¼Œè¿™äº›éƒ¨åˆ†å¯ä»¥å¹¶è¡Œè€ƒè™‘ï¼Œå› æ­¤å±äºå¤æ‚ä»»åŠ¡ï¼Œå¿…é¡»æ‹†è§£è§„åˆ’ã€‚

æ‰§è¡Œæ–¹æ³•Bï¼Œç”Ÿæˆæ€ç»´éª¨æ¶ï¼š

#### æŠ€æœ¯åŠ¨ä½œè§„èŒƒã€212ã€‘:......

#### è®­ç»ƒè®¡åˆ’åˆ¶å®šã€189ã€‘:......

#### å¿ƒç†ç´ è´¨æå‡ã€199ã€‘:......

#### åœºåœ°ä¸è£…å¤‡ä¼˜åŒ–ã€156ã€‘:......

#### æ¯”èµ›ç»éªŒç§¯ç´¯ã€204ã€‘:......

####%%%%

#### æŠ€æœ¯åŠ¨ä½œè§„èŒƒã€212ã€‘: 
æ­£ç¡®çš„æŠ•ç¯®å§¿åŠ¿æ˜¯ä¿æŒèº«ä½“å¹³è¡¡ï¼ŒåŒè„šåˆ†å¼€ä¸è‚©åŒå®½ï¼Œè†ç›–å¾®å±ˆï¼Œé‡å¿ƒæ”¾åœ¨å‰è„šæŒã€‚å‡ºæ‰‹æ—¶ï¼Œæ‰‹è‡‚è‡ªç„¶ä¼¸ç›´ï¼Œæ‰‹è…•ä¸‹å‹ï¼Œçƒä»æŒ‡å°–å¼¹å‡ºã€‚ç»ƒä¹ æ—¶è¦æ³¨æ„ä¿æŒæ‰‹è‡‚ä¸èº«ä½“æˆç›´çº¿ï¼Œé¿å…è¿‡åº¦å¼¯æ›²æˆ–ä¼¸ç›´ã€‚æ­¤å¤–ï¼ŒæŠ•ç¯®æ—¶çš„å‘åŠ›é¡ºåºä¹Ÿå¾ˆé‡è¦ï¼Œå…ˆè¹¬åœ°ï¼Œå†è½¬èƒ¯ï¼Œæœ€åå‡ºæ‰‹ï¼Œç¡®ä¿åŠ¨ä½œè¿è´¯ã€‚å¯ä»¥é€šè¿‡æ…¢åŠ¨ä½œç»ƒä¹ å’Œå½•åƒå›æ”¾æ¥çº æ­£é”™è¯¯åŠ¨ä½œï¼Œæé«˜åŠ¨ä½œçš„å‡†ç¡®æ€§å’Œç¨³å®šæ€§ã€‚


#### è®­ç»ƒè®¡åˆ’åˆ¶å®šã€189ã€‘: 
åˆ¶å®šç§‘å­¦çš„è®­ç»ƒè®¡åˆ’æ˜¯æé«˜æŠ•ç¯®å‘½ä¸­ç‡çš„å…³é”®ã€‚é¦–å…ˆï¼Œè¦æ˜ç¡®è®­ç»ƒç›®æ ‡ï¼Œä¾‹å¦‚æå‡è¿œè·ç¦»æŠ•ç¯®èƒ½åŠ›æˆ–å¢å¼ºè¿‘è·ç¦»æŠ•ç¯®çš„...
2026-01-22 22:58:06 - SpecSoT-Rank2 - INFO - [CLEANUP] é€šä¿¡ç»Ÿè®¡: {'draft_tokens_sent': 2, 'draft_tokens_recv': 0, 'hidden_sent': 0, 'hidden_recv': 5, 'eagle_input_hidden_sent': 0, 'eagle_input_hidden_recv': 10, 'base_cache_sent': 80, 'base_cache_recv': 140, 'eagle_cache_sent': 10, 'eagle_cache_recv': 0, 'aggregated_sends': 0, 'forwarded_messages': 0}
2026-01-22 22:58:06 - SpecSoT-Rank2 - INFO - Worker æ‰§è¡Œå®Œæˆ
—æ—¶: 0.12ms
2026-01-22 22:57:46.183 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:421] -     åˆå¹¶å Eagle Hidden States å±‚: [1, 17, 32]
2026-01-22 22:57:46.183 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:680] - [EAGLE] Input Layers é…ç½®: [1, 17, 32] (æ€»å±‚æ•°=36)
2026-01-22 22:57:46.183 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:721] -     [EAGLE] æ”¶é›† layer 1 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 22:57:46.183 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:721] -     [EAGLE] æ”¶é›† layer 17 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 22:57:46.183 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:721] -     [EAGLE] æ”¶é›† layer 32 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 22:57:46.183 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:725] -   [EAGLE] æ‹¼æ¥å hidden_states | shape=(1, 128, 7680), dtype=float16, device=cuda:0, size=1.875MB
2026-01-22 22:57:46.183 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:431] -     EAGLE3 Hidden States | shape=(1, 128, 7680), dtype=float16, device=cuda:0, size=1.875MB
2026-01-22 22:57:46.183 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:456] -     Draft Tree ç”Ÿæˆ: input_ids range=[1, 129)
2026-01-22 22:57:46.212 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:473] -   [PHASE 3][BROADCAST] Eagle Stable KV | chunk=0, size=0.50MB
2026-01-22 22:57:46.212 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:501] -   [PHASE 3] å®Œæˆ | è€—æ—¶: 29.88ms
2026-01-22 22:57:46.212 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=0, chunk=0 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.212 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=14, chunk=0 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.212 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=15, chunk=0 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.212 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=1, chunk=0 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.213 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=16, chunk=0 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.213 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=2, chunk=0 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.213 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=3, chunk=0 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.213 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=17, chunk=0 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.213 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=4, chunk=0 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.214 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=18, chunk=0 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.214 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=5, chunk=0 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.214 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=19, chunk=0 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.214 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=6, chunk=0 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.214 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=20, chunk=0 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.214 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=7, chunk=0 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.214 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=21, chunk=0 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.215 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=8, chunk=0 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.215 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=22, chunk=0 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.215 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=9, chunk=0 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.215 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=23, chunk=0 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.215 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=10, chunk=0 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.215 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=24, chunk=0 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.215 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=25, chunk=0 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.216 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=11, chunk=0 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.216 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=26, chunk=0 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.216 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=12, chunk=0 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.216 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=13, chunk=0 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.216 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=27, chunk=0 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.216 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=0, chunk=1 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.216 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=14, chunk=1 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.216 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=1, chunk=1 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.216 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=15, chunk=1 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.216 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=2, chunk=1 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.216 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=16, chunk=1 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.216 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=3, chunk=1 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.216 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=4, chunk=1 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.216 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=17, chunk=1 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.216 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=5, chunk=1 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.216 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=18, chunk=1 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.216 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=6, chunk=1 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.216 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=19, chunk=1 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.216 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=7, chunk=1 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.216 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=20, chunk=1 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.216 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=8, chunk=1 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.216 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=21, chunk=1 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.216 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=9, chunk=1 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.216 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=22, chunk=1 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.216 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=10, chunk=1 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.217 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=23, chunk=1 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.217 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=11, chunk=1 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.217 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=24, chunk=1 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.217 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=25, chunk=1 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.217 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=12, chunk=1 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.217 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=26, chunk=1 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.217 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=13, chunk=1 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.217 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=0, chunk=2 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.217 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=27, chunk=1 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.217 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=1, chunk=2 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.217 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=14, chunk=2 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.217 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=2, chunk=2 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.217 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=15, chunk=2 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.217 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=3, chunk=2 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.217 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=16, chunk=2 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.217 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=4, chunk=2 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.217 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=5, chunk=2 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.217 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=17, chunk=2 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.217 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=6, chunk=2 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.217 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=18, chunk=2 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.217 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=7, chunk=2 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.217 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=19, chunk=2 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.217 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=8, chunk=2 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.217 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=20, chunk=2 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.217 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=9, chunk=2 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.218 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=21, chunk=2 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.218 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=10, chunk=2 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.218 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=22, chunk=2 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.218 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=11, chunk=2 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.218 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=23, chunk=2 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.218 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=12, chunk=2 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.218 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=24, chunk=2 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.218 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=13, chunk=2 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.218 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=25, chunk=2 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.218 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=0, chunk=3 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.218 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=26, chunk=2 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.218 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=1, chunk=3 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.218 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=27, chunk=2 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.218 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=2, chunk=3 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.218 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=14, chunk=3 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.218 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=3, chunk=3 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.218 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=15, chunk=3 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.218 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=4, chunk=3 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.218 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=16, chunk=3 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.218 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=5, chunk=3 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.218 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=6, chunk=3 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.218 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=17, chunk=3 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.218 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=7, chunk=3 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.218 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=18, chunk=3 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.218 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=8, chunk=3 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.218 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=19, chunk=3 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.219 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=9, chunk=3 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.219 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=20, chunk=3 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.219 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=10, chunk=3 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.219 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=21, chunk=3 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.219 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=11, chunk=3 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.219 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=22, chunk=3 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.219 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=12, chunk=3 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.219 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=23, chunk=3 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.219 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=13, chunk=3 from Rank 0 | size=0.50MB
2026-01-22 22:57:46.219 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=24, chunk=3 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.219 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=0, chunk=4 from Rank 0 | size=0.24MB
2026-01-22 22:57:46.219 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=25, chunk=3 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.219 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=26, chunk=3 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.219 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=1, chunk=4 from Rank 0 | size=0.24MB
2026-01-22 22:57:46.219 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=2, chunk=4 from Rank 0 | size=0.24MB
2026-01-22 22:57:46.219 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=27, chunk=3 from Rank 1 | size=0.50MB
2026-01-22 22:57:46.219 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=3, chunk=4 from Rank 0 | size=0.24MB
2026-01-22 22:57:46.219 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=14, chunk=4 from Rank 1 | size=0.24MB
2026-01-22 22:57:46.219 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=4, chunk=4 from Rank 0 | size=0.24MB
2026-01-22 22:57:46.219 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=15, chunk=4 from Rank 1 | size=0.24MB
2026-01-22 22:57:46.219 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=5, chunk=4 from Rank 0 | size=0.24MB
2026-01-22 22:57:46.219 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=16, chunk=4 from Rank 1 | size=0.24MB
2026-01-22 22:57:46.219 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=6, chunk=4 from Rank 0 | size=0.24MB
2026-01-22 22:57:46.219 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=7, chunk=4 from Rank 0 | size=0.24MB
2026-01-22 22:57:46.219 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=17, chunk=4 from Rank 1 | size=0.24MB
2026-01-22 22:57:46.220 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=8, chunk=4 from Rank 0 | size=0.24MB
2026-01-22 22:57:46.220 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=18, chunk=4 from Rank 1 | size=0.24MB
2026-01-22 22:57:46.220 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=9, chunk=4 from Rank 0 | size=0.24MB
2026-01-22 22:57:46.220 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=19, chunk=4 from Rank 1 | size=0.24MB
2026-01-22 22:57:46.220 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=10, chunk=4 from Rank 0 | size=0.24MB
2026-01-22 22:57:46.220 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=20, chunk=4 from Rank 1 | size=0.24MB
2026-01-22 22:57:46.220 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=11, chunk=4 from Rank 0 | size=0.24MB
2026-01-22 22:57:46.220 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=21, chunk=4 from Rank 1 | size=0.24MB
2026-01-22 22:57:46.220 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=12, chunk=4 from Rank 0 | size=0.24MB
2026-01-22 22:57:46.220 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=22, chunk=4 from Rank 1 | size=0.24MB
2026-01-22 22:57:46.220 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=13, chunk=4 from Rank 0 | size=0.24MB
2026-01-22 22:57:46.220 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=23, chunk=4 from Rank 1 | size=0.24MB
2026-01-22 22:57:46.220 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=24, chunk=4 from Rank 1 | size=0.24MB
2026-01-22 22:57:46.220 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=25, chunk=4 from Rank 1 | size=0.24MB
2026-01-22 22:57:46.220 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=26, chunk=4 from Rank 1 | size=0.24MB
2026-01-22 22:57:46.220 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:665] -   [RECV][CACHE] layer=27, chunk=4 from Rank 1 | size=0.24MB
2026-01-22 22:57:46.221 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:668] -   [CACHE] éé˜»å¡æ¥æ”¶ 140 ä¸ª Base Cache
2026-01-22 22:57:46.221 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:507] - [CHUNK 1/5] å®Œæˆ | æ€»è€—æ—¶: 299.58ms
2026-01-22 22:57:46.221 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:230] - [CHUNK 2/5] å¼€å§‹å¤„ç† | seq_len=128, first=False, last=False
2026-01-22 22:57:46.221 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:245] -   [PHASE 1] ç­‰å¾…æ¥æ”¶ Hidden States (from Rank 1)...
2026-01-22 22:57:46.221 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:254] -   [PHASE 1][RECV] Hidden States | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB | chunk_idx=1
2026-01-22 22:57:46.221 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:257] -   [PHASE 1] å®Œæˆ | è€—æ—¶: 0.10ms
2026-01-22 22:57:46.221 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:263] -   [PHASE 2] å¼€å§‹è®¡ç®— Decoder Layers [28, 36)
2026-01-22 22:57:46.221 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:271] -     past_key_values_length=128, seq_with_past=256
2026-01-22 22:57:46.223 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=28 -> Rank 0 | size=0.50MB
2026-01-22 22:57:46.223 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=28 -> Rank 1 | size=0.50MB
2026-01-22 22:57:46.225 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=29 -> Rank 0 | size=0.50MB
2026-01-22 22:57:46.225 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=29 -> Rank 1 | size=0.50MB
2026-01-22 22:57:46.227 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=30 -> Rank 0 | size=0.50MB
2026-01-22 22:57:46.228 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=30 -> Rank 1 | size=0.50MB
2026-01-22 22:57:46.229 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=31 -> Rank 0 | size=0.50MB
2026-01-22 22:57:46.230 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=31 -> Rank 1 | size=0.50MB
2026-01-22 22:57:46.231 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:342] -     [EAGLE] ä¿å­˜ hidden state layer=32, chunk=1
2026-01-22 22:57:46.232 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=32 -> Rank 0 | size=0.50MB
2026-01-22 22:57:46.232 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=32 -> Rank 1 | size=0.50MB
2026-01-22 22:57:46.234 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=33 -> Rank 0 | size=0.50MB
2026-01-22 22:57:46.234 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=33 -> Rank 1 | size=0.50MB
2026-01-22 22:57:46.236 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=34 -> Rank 0 | size=0.50MB
2026-01-22 22:57:46.237 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=34 -> Rank 1 | size=0.50MB
2026-01-22 22:57:46.239 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=35 -> Rank 0 | size=0.50MB
2026-01-22 22:57:46.239 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=35 -> Rank 1 | size=0.50MB
2026-01-22 22:57:46.239 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:377] -   [PHASE 2] å®Œæˆ | layers=8, cache_sent=16, eagle_hidden_sent=0 | è€—æ—¶: 17.53ms
2026-01-22 22:57:46.239 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:396] -   [PHASE 3] æ‰§è¡Œ Eagle Layer è®¡ç®—...
2026-01-22 22:57:46.239 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:400] -     Norm å®Œæˆ | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 22:57:46.240 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:404] -     LM Head å®Œæˆ | shape=(1, 128, 151936), dtype=float16, device=cuda:0, size=37.094MB
2026-01-22 22:57:46.240 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:407] -   [PHASE 3][RECV] ç­‰å¾… Eagle Input Hidden States (chunk=1)...
2026-01-22 22:57:46.240 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:417] -   [PHASE 3][RECV] æ”¶åˆ° 2 ä¸ª Eagle Hidden (chunk=1) | è€—æ—¶: 0.20ms
2026-01-22 22:57:46.240 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:421] -     åˆå¹¶å Eagle Hidden States å±‚: [1, 17, 32]
2026-01-22 22:57:46.240 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:680] - [EAGLE] Input Layers é…ç½®: [1, 17, 32] (æ€»å±‚æ•°=36)
2026-01-22 22:57:46.240 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:721] -     [EAGLE] æ”¶é›† layer 1 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 22:57:46.240 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:721] -     [EAGLE] æ”¶é›† layer 17 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 22:57:46.240 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:721] -     [EAGLE] æ”¶é›† layer 32 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 22:57:46.240 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:725] -   [EAGLE] æ‹¼æ¥å hidden_states | shape=(1, 128, 7680), dtype=float16, device=cuda:0, size=1.875MB
2026-01-22 22:57:46.240 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:431] -     EAGLE3 Hidden States | shape=(1, 128, 7680), dtype=float16, device=cuda:0, size=1.875MB
2026-01-22 22:57:46.240 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:456] -     Draft Tree ç”Ÿæˆ: input_ids range=[129, 257)
2026-01-22 22:57:46.243 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:473] -   [PHASE 3][BROADCAST] Eagle Stable KV | chunk=1, size=0.50MB
2026-01-22 22:57:46.244 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:501] -   [PHASE 3] å®Œæˆ | è€—æ—¶: 4.75ms
2026-01-22 22:57:46.245 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:507] - [CHUNK 2/5] å®Œæˆ | æ€»è€—æ—¶: 23.61ms
2026-01-22 22:57:46.245 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:230] - [CHUNK 3/5] å¼€å§‹å¤„ç† | seq_len=128, first=False, last=False
2026-01-22 22:57:46.245 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:245] -   [PHASE 1] ç­‰å¾…æ¥æ”¶ Hidden States (from Rank 1)...
2026-01-22 22:57:46.245 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:254] -   [PHASE 1][RECV] Hidden States | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB | chunk_idx=2
2026-01-22 22:57:46.245 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:257] -   [PHASE 1] å®Œæˆ | è€—æ—¶: 0.08ms
2026-01-22 22:57:46.245 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:263] -   [PHASE 2] å¼€å§‹è®¡ç®— Decoder Layers [28, 36)
2026-01-22 22:57:46.245 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:271] -     past_key_values_length=256, seq_with_past=384
2026-01-22 22:57:46.252 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=28 -> Rank 0 | size=0.50MB
2026-01-22 22:57:46.252 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=28 -> Rank 1 | size=0.50MB
2026-01-22 22:57:46.255 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=29 -> Rank 0 | size=0.50MB
2026-01-22 22:57:46.255 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=29 -> Rank 1 | size=0.50MB
2026-01-22 22:57:46.257 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=30 -> Rank 0 | size=0.50MB
2026-01-22 22:57:46.257 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=30 -> Rank 1 | size=0.50MB
2026-01-22 22:57:46.259 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=31 -> Rank 0 | size=0.50MB
2026-01-22 22:57:46.259 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=31 -> Rank 1 | size=0.50MB
2026-01-22 22:57:46.261 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:342] -     [EAGLE] ä¿å­˜ hidden state layer=32, chunk=2
2026-01-22 22:57:46.262 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=32 -> Rank 0 | size=0.50MB
2026-01-22 22:57:46.262 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=32 -> Rank 1 | size=0.50MB
2026-01-22 22:57:46.265 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=33 -> Rank 0 | size=0.50MB
2026-01-22 22:57:46.265 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=33 -> Rank 1 | size=0.50MB
2026-01-22 22:57:46.268 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=34 -> Rank 0 | size=0.50MB
2026-01-22 22:57:46.268 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=34 -> Rank 1 | size=0.50MB
2026-01-22 22:57:46.271 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=35 -> Rank 0 | size=0.50MB
2026-01-22 22:57:46.271 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=35 -> Rank 1 | size=0.50MB
2026-01-22 22:57:46.271 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:377] -   [PHASE 2] å®Œæˆ | layers=8, cache_sent=16, eagle_hidden_sent=0 | è€—æ—¶: 26.13ms
2026-01-22 22:57:46.271 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:396] -   [PHASE 3] æ‰§è¡Œ Eagle Layer è®¡ç®—...
2026-01-22 22:57:46.272 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:400] -     Norm å®Œæˆ | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 22:57:46.272 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:404] -     LM Head å®Œæˆ | shape=(1, 128, 151936), dtype=float16, device=cuda:0, size=37.094MB
2026-01-22 22:57:46.272 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:407] -   [PHASE 3][RECV] ç­‰å¾… Eagle Input Hidden States (chunk=2)...
2026-01-22 22:57:46.272 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:417] -   [PHASE 3][RECV] æ”¶åˆ° 2 ä¸ª Eagle Hidden (chunk=2) | è€—æ—¶: 0.44ms
2026-01-22 22:57:46.272 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:421] -     åˆå¹¶å Eagle Hidden States å±‚: [1, 17, 32]
2026-01-22 22:57:46.272 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:680] - [EAGLE] Input Layers é…ç½®: [1, 17, 32] (æ€»å±‚æ•°=36)
2026-01-22 22:57:46.272 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:721] -     [EAGLE] æ”¶é›† layer 1 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 22:57:46.272 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:721] -     [EAGLE] æ”¶é›† layer 17 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 22:57:46.272 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:721] -     [EAGLE] æ”¶é›† layer 32 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 22:57:46.273 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:725] -   [EAGLE] æ‹¼æ¥å hidden_states | shape=(1, 128, 7680), dtype=float16, device=cuda:0, size=1.875MB
2026-01-22 22:57:46.273 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:431] -     EAGLE3 Hidden States | shape=(1, 128, 7680), dtype=float16, device=cuda:0, size=1.875MB
2026-01-22 22:57:46.273 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:456] -     Draft Tree ç”Ÿæˆ: input_ids range=[257, 385)
2026-01-22 22:57:46.276 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:473] -   [PHASE 3][BROADCAST] Eagle Stable KV | chunk=2, size=0.50MB
2026-01-22 22:57:46.276 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:501] -   [PHASE 3] å®Œæˆ | è€—æ—¶: 4.83ms
2026-01-22 22:57:46.277 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:507] - [CHUNK 3/5] å®Œæˆ | æ€»è€—æ—¶: 32.22ms
2026-01-22 22:57:46.277 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:230] - [CHUNK 4/5] å¼€å§‹å¤„ç† | seq_len=128, first=False, last=False
2026-01-22 22:57:46.277 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:245] -   [PHASE 1] ç­‰å¾…æ¥æ”¶ Hidden States (from Rank 1)...
2026-01-22 22:57:46.277 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:254] -   [PHASE 1][RECV] Hidden States | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB | chunk_idx=3
2026-01-22 22:57:46.277 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:257] -   [PHASE 1] å®Œæˆ | è€—æ—¶: 0.31ms
2026-01-22 22:57:46.278 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:263] -   [PHASE 2] å¼€å§‹è®¡ç®— Decoder Layers [28, 36)
2026-01-22 22:57:46.278 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:271] -     past_key_values_length=384, seq_with_past=512
2026-01-22 22:57:46.280 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=28 -> Rank 0 | size=0.50MB
2026-01-22 22:57:46.280 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=28 -> Rank 1 | size=0.50MB
2026-01-22 22:57:46.283 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=29 -> Rank 0 | size=0.50MB
2026-01-22 22:57:46.283 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=29 -> Rank 1 | size=0.50MB
2026-01-22 22:57:46.286 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=30 -> Rank 0 | size=0.50MB
2026-01-22 22:57:46.286 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=30 -> Rank 1 | size=0.50MB
2026-01-22 22:57:46.289 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=31 -> Rank 0 | size=0.50MB
2026-01-22 22:57:46.289 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=31 -> Rank 1 | size=0.50MB
2026-01-22 22:57:46.291 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:342] -     [EAGLE] ä¿å­˜ hidden state layer=32, chunk=3
2026-01-22 22:57:46.291 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=32 -> Rank 0 | size=0.50MB
2026-01-22 22:57:46.292 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=32 -> Rank 1 | size=0.50MB
2026-01-22 22:57:46.294 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=33 -> Rank 0 | size=0.50MB
2026-01-22 22:57:46.294 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=33 -> Rank 1 | size=0.50MB
2026-01-22 22:57:46.297 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=34 -> Rank 0 | size=0.50MB
2026-01-22 22:57:46.297 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=34 -> Rank 1 | size=0.50MB
2026-01-22 22:57:46.300 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=35 -> Rank 0 | size=0.50MB
2026-01-22 22:57:46.300 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=35 -> Rank 1 | size=0.50MB
2026-01-22 22:57:46.300 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:377] -   [PHASE 2] å®Œæˆ | layers=8, cache_sent=16, eagle_hidden_sent=0 | è€—æ—¶: 22.18ms
2026-01-22 22:57:46.300 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:396] -   [PHASE 3] æ‰§è¡Œ Eagle Layer è®¡ç®—...
2026-01-22 22:57:46.300 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:400] -     Norm å®Œæˆ | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 22:57:46.300 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:404] -     LM Head å®Œæˆ | shape=(1, 128, 151936), dtype=float16, device=cuda:0, size=37.094MB
2026-01-22 22:57:46.300 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:407] -   [PHASE 3][RECV] ç­‰å¾… Eagle Input Hidden States (chunk=3)...
2026-01-22 22:57:46.301 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:417] -   [PHASE 3][RECV] æ”¶åˆ° 2 ä¸ª Eagle Hidden (chunk=3) | è€—æ—¶: 0.35ms
2026-01-22 22:57:46.301 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:421] -     åˆå¹¶å Eagle Hidden States å±‚: [1, 17, 32]
2026-01-22 22:57:46.301 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:680] - [EAGLE] Input Layers é…ç½®: [1, 17, 32] (æ€»å±‚æ•°=36)
2026-01-22 22:57:46.301 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:721] -     [EAGLE] æ”¶é›† layer 1 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 22:57:46.301 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:721] -     [EAGLE] æ”¶é›† layer 17 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 22:57:46.301 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:721] -     [EAGLE] æ”¶é›† layer 32 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 22:57:46.301 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:725] -   [EAGLE] æ‹¼æ¥å hidden_states | shape=(1, 128, 7680), dtype=float16, device=cuda:0, size=1.875MB
2026-01-22 22:57:46.301 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:431] -     EAGLE3 Hidden States | shape=(1, 128, 7680), dtype=float16, device=cuda:0, size=1.875MB
2026-01-22 22:57:46.301 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:456] -     Draft Tree ç”Ÿæˆ: input_ids range=[385, 513)
2026-01-22 22:57:46.304 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:473] -   [PHASE 3][BROADCAST] Eagle Stable KV | chunk=3, size=0.50MB
2026-01-22 22:57:46.304 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:501] -   [PHASE 3] å®Œæˆ | è€—æ—¶: 4.44ms
2026-01-22 22:57:46.305 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:507] - [CHUNK 4/5] å®Œæˆ | æ€»è€—æ—¶: 28.13ms
2026-01-22 22:57:46.305 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:230] - [CHUNK 5/5] å¼€å§‹å¤„ç† | seq_len=62, first=False, last=True
2026-01-22 22:57:46.305 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:245] -   [PHASE 1] ç­‰å¾…æ¥æ”¶ Hidden States (from Rank 1)...
2026-01-22 22:57:46.306 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:254] -   [PHASE 1][RECV] Hidden States | shape=(1, 62, 2560), dtype=float16, device=cuda:0, size=0.303MB | chunk_idx=4
2026-01-22 22:57:46.306 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:257] -   [PHASE 1] å®Œæˆ | è€—æ—¶: 0.14ms
2026-01-22 22:57:46.306 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:263] -   [PHASE 2] å¼€å§‹è®¡ç®— Decoder Layers [28, 36)
2026-01-22 22:57:46.306 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:271] -     past_key_values_length=512, seq_with_past=574
2026-01-22 22:57:46.308 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=28 -> Rank 0 | size=0.24MB
2026-01-22 22:57:46.309 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=28 -> Rank 1 | size=0.24MB
2026-01-22 22:57:46.311 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=29 -> Rank 0 | size=0.24MB
2026-01-22 22:57:46.312 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=29 -> Rank 1 | size=0.24MB
2026-01-22 22:57:46.314 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=30 -> Rank 0 | size=0.24MB
2026-01-22 22:57:46.314 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=30 -> Rank 1 | size=0.24MB
2026-01-22 22:57:46.317 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=31 -> Rank 0 | size=0.24MB
2026-01-22 22:57:46.317 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=31 -> Rank 1 | size=0.24MB
2026-01-22 22:57:46.319 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:342] -     [EAGLE] ä¿å­˜ hidden state layer=32, chunk=4
2026-01-22 22:57:46.319 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=32 -> Rank 0 | size=0.24MB
2026-01-22 22:57:46.320 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=32 -> Rank 1 | size=0.24MB
2026-01-22 22:57:46.322 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=33 -> Rank 0 | size=0.24MB
2026-01-22 22:57:46.322 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=33 -> Rank 1 | size=0.24MB
2026-01-22 22:57:46.324 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=34 -> Rank 0 | size=0.24MB
2026-01-22 22:57:46.325 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=34 -> Rank 1 | size=0.24MB
2026-01-22 22:57:46.327 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=35 -> Rank 0 | size=0.24MB
2026-01-22 22:57:46.328 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=35 -> Rank 1 | size=0.24MB
2026-01-22 22:57:46.328 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:377] -   [PHASE 2] å®Œæˆ | layers=8, cache_sent=16, eagle_hidden_sent=0 | è€—æ—¶: 22.21ms
2026-01-22 22:57:46.328 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:396] -   [PHASE 3] æ‰§è¡Œ Eagle Layer è®¡ç®—...
2026-01-22 22:57:46.328 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:400] -     Norm å®Œæˆ | shape=(1, 62, 2560), dtype=float16, device=cuda:0, size=0.303MB
2026-01-22 22:57:46.328 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:404] -     LM Head å®Œæˆ | shape=(1, 62, 151936), dtype=float16, device=cuda:0, size=17.967MB
2026-01-22 22:57:46.329 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:407] -   [PHASE 3][RECV] ç­‰å¾… Eagle Input Hidden States (chunk=4)...
2026-01-22 22:57:46.329 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:417] -   [PHASE 3][RECV] æ”¶åˆ° 2 ä¸ª Eagle Hidden (chunk=4) | è€—æ—¶: 0.20ms
2026-01-22 22:57:46.329 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:421] -     åˆå¹¶å Eagle Hidden States å±‚: [1, 17, 32]
2026-01-22 22:57:46.329 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:680] - [EAGLE] Input Layers é…ç½®: [1, 17, 32] (æ€»å±‚æ•°=36)
2026-01-22 22:57:46.329 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:721] -     [EAGLE] æ”¶é›† layer 1 | shape=(1, 62, 2560), dtype=float16, device=cuda:0, size=0.303MB
2026-01-22 22:57:46.329 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:721] -     [EAGLE] æ”¶é›† layer 17 | shape=(1, 62, 2560), dtype=float16, device=cuda:0, size=0.303MB
2026-01-22 22:57:46.329 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:721] -     [EAGLE] æ”¶é›† layer 32 | shape=(1, 62, 2560), dtype=float16, device=cuda:0, size=0.303MB
2026-01-22 22:57:46.329 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:725] -   [EAGLE] æ‹¼æ¥å hidden_states | shape=(1, 62, 7680), dtype=float16, device=cuda:0, size=0.908MB
2026-01-22 22:57:46.329 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:431] -     EAGLE3 Hidden States | shape=(1, 62, 7680), dtype=float16, device=cuda:0, size=0.908MB
2026-01-22 22:57:46.367 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:448] -   [PHASE 3] First Token é‡‡æ ·: 101042
2026-01-22 22:57:46.367 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:456] -     Draft Tree ç”Ÿæˆ: input_ids range=[513, 575)
2026-01-22 22:57:46.386 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:473] -   [PHASE 3][BROADCAST] Eagle Stable KV | chunk=4, size=0.24MB
2026-01-22 22:57:46.386 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:493] -   [PHASE 3][BROADCAST] Draft Tokens | shape=torch.Size([1, 40])
2026-01-22 22:57:46.386 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:498] -   [PHASE 3] Draft Tokens å¹¿æ’­å®Œæˆ
2026-01-22 22:57:46.386 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:501] -   [PHASE 3] å®Œæˆ | è€—æ—¶: 58.40ms
2026-01-22 22:57:46.388 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:507] - [CHUNK 5/5] å®Œæˆ | æ€»è€—æ—¶: 82.43ms
2026-01-22 22:57:46.388 - SpecSoT-Rank2 - INFO - [distributed_prefill.py:512] - [PREFILL] Chunkså¤„ç†å®Œæˆï¼Œå¼€å§‹ Cache åŒæ­¥...
2026-01-22 22:57:46.388 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:568] - [SYNC] æœ€åä¸€ä¸ª Rank ç­‰å¾…æ‰€æœ‰ Cache åŒæ­¥...
2026-01-22 22:57:46.390 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:585] - [SYNC_OK] Rank 2 Cache åŒæ­¥å®Œæˆ | è€—æ—¶: 2.25ms
2026-01-22 22:57:46.390 - SpecSoT-Rank2 - INFO - [distributed_prefill.py:594] - [PREFILL] åˆ†å¸ƒå¼ Prefill å®Œæˆ | Rank=2 | è€—æ—¶: 0.470s
2026-01-22 22:58:06.898 - SpecSoT-Rank2 - INFO - [run_specsot.py:392] - 
[ç»Ÿè®¡ä¿¡æ¯]
2026-01-22 22:58:06.898 - SpecSoT-Rank2 - INFO - [run_specsot.py:393] -   æ€»è€—æ—¶: 20.99s
2026-01-22 22:58:06.898 - SpecSoT-Rank2 - INFO - [run_specsot.py:394] -   å³°å€¼æ˜¾å­˜: 4474.25 MB
2026-01-22 22:58:06.898 - SpecSoT-Rank2 - INFO - [run_specsot.py:395] -   è¾“å‡ºé•¿åº¦: 1901 tokens
2026-01-22 22:58:06.898 - SpecSoT-Rank2 - INFO - [run_specsot.py:396] -   ååé‡: 90.6 tokens/s
2026-01-22 22:58:06.898 - SpecSoT-Rank2 - INFO - [run_specsot.py:397] -   å¹¶è¡Œåˆ†æ”¯æ•°: 5
2026-01-22 22:58:06.898 - SpecSoT-Rank2 - INFO - [run_specsot.py:398] -   å¹³å‡æ¥å—é•¿åº¦: 0.53
2026-01-22 22:58:06.898 - SpecSoT-Rank2 - INFO - [run_specsot.py:399] -   å¹³å‡Draftæ—¶é—´: 5.59 ms
2026-01-22 22:58:06.898 - SpecSoT-Rank2 - INFO - [run_specsot.py:400] -   å¹³å‡Verifyæ—¶é—´: 28.90 ms
2026-01-22 22:58:06.898 - SpecSoT-Rank2 - INFO - [run_specsot.py:401] -   å¹³å‡Updateæ—¶é—´: 1.06 ms
2026-01-22 22:58:06.898 - SpecSoT-Rank2 - INFO - [run_specsot.py:404] - 
[å“åº”é¢„è§ˆ]
2026-01-22 22:58:06.898 - SpecSoT-Rank2 - INFO - [run_specsot.py:405] - åˆ†æè¿™ä¸ªé—®é¢˜æ˜¯å¦å±äºéœ€è¦æ‹†è§£è§„åˆ’çš„â€œå¤æ‚ä»»åŠ¡â€ï¼š

é—®é¢˜è¦æ±‚â€œè¯¦ç»†å»ºè®®â€ï¼Œæ¶‰åŠå¤šä¸ªç‹¬ç«‹çš„æ–¹é¢ï¼Œå¦‚æŠ€æœ¯åŠ¨ä½œã€è®­ç»ƒæ–¹æ³•ã€å¿ƒç†å› ç´ ã€åœºåœ°æ¡ä»¶ç­‰ï¼Œè¿™äº›éƒ¨åˆ†å¯ä»¥å¹¶è¡Œè€ƒè™‘ï¼Œå› æ­¤å±äºå¤æ‚ä»»åŠ¡ï¼Œå¿…é¡»æ‹†è§£è§„åˆ’ã€‚

æ‰§è¡Œæ–¹æ³•Bï¼Œç”Ÿæˆæ€ç»´éª¨æ¶ï¼š

#### æŠ€æœ¯åŠ¨ä½œè§„èŒƒã€212ã€‘:......

#### è®­ç»ƒè®¡åˆ’åˆ¶å®šã€189ã€‘:......

#### å¿ƒç†ç´ è´¨æå‡ã€199ã€‘:......

#### åœºåœ°ä¸è£…å¤‡ä¼˜åŒ–ã€156ã€‘:......

#### æ¯”èµ›ç»éªŒç§¯ç´¯ã€204ã€‘:......

####%%%%

#### æŠ€æœ¯åŠ¨ä½œè§„èŒƒã€212ã€‘: 
æ­£ç¡®çš„æŠ•ç¯®å§¿åŠ¿æ˜¯ä¿æŒèº«ä½“å¹³è¡¡ï¼ŒåŒè„šåˆ†å¼€ä¸è‚©åŒå®½ï¼Œè†ç›–å¾®å±ˆï¼Œé‡å¿ƒæ”¾åœ¨å‰è„šæŒã€‚å‡ºæ‰‹æ—¶ï¼Œæ‰‹è‡‚è‡ªç„¶ä¼¸ç›´ï¼Œæ‰‹è…•ä¸‹å‹ï¼Œçƒä»æŒ‡å°–å¼¹å‡ºã€‚ç»ƒä¹ æ—¶è¦æ³¨æ„ä¿æŒæ‰‹è‡‚ä¸èº«ä½“æˆç›´çº¿ï¼Œé¿å…è¿‡åº¦å¼¯æ›²æˆ–ä¼¸ç›´ã€‚æ­¤å¤–ï¼ŒæŠ•ç¯®æ—¶çš„å‘åŠ›é¡ºåºä¹Ÿå¾ˆé‡è¦ï¼Œå…ˆè¹¬åœ°ï¼Œå†è½¬èƒ¯ï¼Œæœ€åå‡ºæ‰‹ï¼Œç¡®ä¿åŠ¨ä½œè¿è´¯ã€‚å¯ä»¥é€šè¿‡æ…¢åŠ¨ä½œç»ƒä¹ å’Œå½•åƒå›æ”¾æ¥çº æ­£é”™è¯¯åŠ¨ä½œï¼Œæé«˜åŠ¨ä½œçš„å‡†ç¡®æ€§å’Œç¨³å®šæ€§ã€‚


#### è®­ç»ƒè®¡åˆ’åˆ¶å®šã€189ã€‘: 
åˆ¶å®šç§‘å­¦çš„è®­ç»ƒè®¡åˆ’æ˜¯æé«˜æŠ•ç¯®å‘½ä¸­ç‡çš„å…³é”®ã€‚é¦–å…ˆï¼Œè¦æ˜ç¡®è®­ç»ƒç›®æ ‡ï¼Œä¾‹å¦‚æå‡è¿œè·ç¦»æŠ•ç¯®èƒ½åŠ›æˆ–å¢å¼ºè¿‘è·ç¦»æŠ•ç¯®çš„...
2026-01-22 22:58:06.898 - SpecSoT-Rank2 - DEBUG - [run_specsot.py:459] - æ­£åœ¨æ¸…ç†åˆ†å¸ƒå¼èµ„æº...
2026-01-22 22:58:06.898 - SpecSoT-Rank2 - INFO - [distributed_prefill.py:155] - [CLEANUP] é€šä¿¡ç»Ÿè®¡: {'draft_tokens_sent': 2, 'draft_tokens_recv': 0, 'hidden_sent': 0, 'hidden_recv': 5, 'eagle_input_hidden_sent': 0, 'eagle_input_hidden_recv': 10, 'base_cache_sent': 80, 'base_cache_recv': 140, 'eagle_cache_sent': 10, 'eagle_cache_recv': 0, 'aggregated_sends': 0, 'forwarded_messages': 0}
2026-01-22 22:58:06.997 - SpecSoT-Rank2 - DEBUG - [distributed_prefill.py:158] - [CLEANUP] åˆ†å¸ƒå¼Prefillç®¡ç†å™¨å·²æ¸…ç†
2026-01-22 22:58:06.997 - SpecSoT-Rank2 - DEBUG - [run_specsot.py:461] - åˆ†å¸ƒå¼èµ„æºå·²æ¸…ç†
2026-01-22 22:58:06.997 - SpecSoT-Rank2 - INFO - [run_specsot.py:463] - Worker æ‰§è¡Œå®Œæˆ
22 22:57:46.135 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-22 22:57:46.137 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=17, chunk_idx=4, seq_id=129, latency=1395.90ms
2026-01-22 22:57:46.137 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-22 22:57:46.138 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 0 | layer_idx=8, chunk_idx=4, seq_id=139, latency=2003.52ms
2026-01-22 22:57:46.138 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-22 22:57:46.139 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=18, chunk_idx=4, seq_id=131, latency=1396.04ms
2026-01-22 22:57:46.139 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-22 22:57:46.140 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 0 | layer_idx=9, chunk_idx=4, seq_id=141, latency=2001.93ms
2026-01-22 22:57:46.140 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-22 22:57:46.141 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=19, chunk_idx=4, seq_id=133, latency=1397.06ms
2026-01-22 22:57:46.141 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-22 22:57:46.142 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 0 | layer_idx=10, chunk_idx=4, seq_id=143, latency=2000.65ms
2026-01-22 22:57:46.142 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-22 22:57:46.143 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=20, chunk_idx=4, seq_id=135, latency=1397.25ms
2026-01-22 22:57:46.143 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-22 22:57:46.143 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 0 | layer_idx=11, chunk_idx=4, seq_id=145, latency=1998.73ms
2026-01-22 22:57:46.144 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-22 22:57:46.144 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=21, chunk_idx=4, seq_id=137, latency=1397.49ms
2026-01-22 22:57:46.144 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-22 22:57:46.148 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 0 | layer_idx=12, chunk_idx=4, seq_id=147, latency=2000.57ms
2026-01-22 22:57:46.149 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-22 22:57:46.149 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=22, chunk_idx=4, seq_id=139, latency=1400.90ms
2026-01-22 22:57:46.149 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-22 22:57:46.150 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 0 | layer_idx=13, chunk_idx=4, seq_id=149, latency=1998.90ms
2026-01-22 22:57:46.150 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-22 22:57:46.155 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=23, chunk_idx=4, seq_id=141, latency=1405.54ms
2026-01-22 22:57:46.155 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-22 22:57:46.158 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=24, chunk_idx=4, seq_id=143, latency=1406.56ms
2026-01-22 22:57:46.158 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-22 22:57:46.158 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=28, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.158 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=28, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.160 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=25, chunk_idx=4, seq_id=145, latency=1407.15ms
2026-01-22 22:57:46.160 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-22 22:57:46.162 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=26, chunk_idx=4, seq_id=147, latency=1407.54ms
2026-01-22 22:57:46.162 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-22 22:57:46.163 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:239] - [RECV] HIDDEN from rank 1 | chunk_idx=4, seq_id=150, latency=1407.33ms
2026-01-22 22:57:46.163 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:243] -   hidden_state: shape=(1, 62, 2560), dtype=float16, device=cuda:0, size=0.303MB
2026-01-22 22:57:46.163 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=1, layer_idx=28, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=4.76ms
2026-01-22 22:57:46.165 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 1 | layer_idx=27, chunk_idx=4, seq_id=149, latency=1409.23ms
2026-01-22 22:57:46.165 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
  value: shape=(1, 8, 62, 128), dtype=float16, device=cuda:0, size=0.121MB
2026-01-22 22:57:46.166 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=2, layer_idx=28, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=2.05ms
2026-01-22 22:57:46.166 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=29, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.167 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=29, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.168 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=3, layer_idx=29, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.64ms
2026-01-22 22:57:46.169 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=30, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.169 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=30, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.170 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=4, layer_idx=29, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.73ms
2026-01-22 22:57:46.172 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=31, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.172 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=5, layer_idx=30, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.53ms
2026-01-22 22:57:46.172 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=31, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.173 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=6, layer_idx=30, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.45ms
2026-01-22 22:57:46.174 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=32, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.174 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=32, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.175 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=7, layer_idx=31, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.57ms
2026-01-22 22:57:46.176 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=33, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.177 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=33, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.177 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=8, layer_idx=31, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.60ms
2026-01-22 22:57:46.178 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=9, layer_idx=32, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.36ms
2026-01-22 22:57:46.179 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=34, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.179 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=34, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.180 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=10, layer_idx=32, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.50ms
2026-01-22 22:57:46.181 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=35, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.182 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=11, layer_idx=33, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.41ms
2026-01-22 22:57:46.182 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=35, chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.183 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:582] - [WAIT] ç­‰å¾…æ¥æ”¶ ALL_EAGLE_INPUT_HIDDEN | expected_layers=[1, 17], chunk_idx=0, my_range=[28, 36), timeout=60.0s
2026-01-22 22:57:46.183 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:606] - [RECV_OK] EAGLE_INPUT_HIDDEN | layer_idx=1, chunk_idx=0, from rank 0, remaining={17}
2026-01-22 22:57:46.183 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:610] -   hidden: shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 22:57:46.183 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:606] - [RECV_OK] EAGLE_INPUT_HIDDEN | layer_idx=17, chunk_idx=0, from rank 1, remaining=set()
2026-01-22 22:57:46.183 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:610] -   hidden: shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 22:57:46.183 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:627] - [RECV_OK] ALL_EAGLE_INPUT_HIDDEN å…¨éƒ¨æ¥æ”¶å®Œæˆ | chunk_idx=0, layers=[1, 17], wait_time=0.10ms
2026-01-22 22:57:46.184 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=12, layer_idx=33, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=2.47ms
2026-01-22 22:57:46.186 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=13, layer_idx=34, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.38ms
2026-01-22 22:57:46.194 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=14, layer_idx=34, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=7.98ms
2026-01-22 22:57:46.195 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=15, layer_idx=35, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.32ms
2026-01-22 22:57:46.197 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=16, layer_idx=35, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.21ms
2026-01-22 22:57:46.212 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:348] - [BROADCAST] EAGLE_STABLE_KV -> targets=[0, 1] | chunk_idx=0, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.212 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:313] - [QUEUE] EAGLE_CACHE -> rank 0 | chunk_idx=0, incremental=True, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.212 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:313] - [QUEUE] EAGLE_CACHE -> rank 1 | chunk_idx=0, incremental=True, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.213 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:162] - [SEND] EAGLE_CACHE -> rank 0 | seq_id=17, chunk_idx=0, incremental=True, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.60ms
2026-01-22 22:57:46.215 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:162] - [SEND] EAGLE_CACHE -> rank 1 | seq_id=18, chunk_idx=0, incremental=True, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.47ms
2026-01-22 22:57:46.221 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:430] - [WAIT] ç­‰å¾…æ¥æ”¶ HIDDEN (src_rank=1, timeout=60.0s)
2026-01-22 22:57:46.221 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:448] - [RECV_OK] HIDDEN æ¥æ”¶æˆåŠŸ | from rank 1, chunk_idx=1, wait_time=0.02ms
2026-01-22 22:57:46.221 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:453] -   hidden: shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 22:57:46.223 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=28, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.223 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=28, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.224 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=19, layer_idx=28, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.41ms
2026-01-22 22:57:46.225 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=29, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.225 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=29, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.226 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=20, layer_idx=28, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.49ms
2026-01-22 22:57:46.227 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=30, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.227 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=30, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.228 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=21, layer_idx=29, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.49ms
2026-01-22 22:57:46.229 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=22, layer_idx=29, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.27ms
2026-01-22 22:57:46.229 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=31, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.230 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=31, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.231 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=23, layer_idx=30, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.40ms
2026-01-22 22:57:46.232 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=32, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.232 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=24, layer_idx=30, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.43ms
2026-01-22 22:57:46.232 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=32, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.234 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=25, layer_idx=31, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.28ms
2026-01-22 22:57:46.234 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=33, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.234 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=33, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.235 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=26, layer_idx=31, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.42ms
2026-01-22 22:57:46.236 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=34, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.237 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=34, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.237 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=27, layer_idx=32, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.44ms
2026-01-22 22:57:46.238 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=28, layer_idx=32, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.29ms
2026-01-22 22:57:46.239 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=35, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.239 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=35, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.240 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:582] - [WAIT] ç­‰å¾…æ¥æ”¶ ALL_EAGLE_INPUT_HIDDEN | expected_layers=[1, 17], chunk_idx=1, my_range=[28, 36), timeout=60.0s
2026-01-22 22:57:46.240 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:606] - [RECV_OK] EAGLE_INPUT_HIDDEN | layer_idx=1, chunk_idx=1, from rank 0, remaining={17}
2026-01-22 22:57:46.240 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:610] -   hidden: shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 22:57:46.240 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:606] - [RECV_OK] EAGLE_INPUT_HIDDEN | layer_idx=17, chunk_idx=1, from rank 1, remaining=set()
2026-01-22 22:57:46.240 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:610] -   hidden: shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 22:57:46.240 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:627] - [RECV_OK] ALL_EAGLE_INPUT_HIDDEN å…¨éƒ¨æ¥æ”¶å®Œæˆ | chunk_idx=1, layers=[1, 17], wait_time=0.10ms
2026-01-22 22:57:46.240 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=29, layer_idx=33, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.62ms
2026-01-22 22:57:46.242 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=30, layer_idx=33, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.41ms
2026-01-22 22:57:46.243 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=31, layer_idx=34, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.25ms
2026-01-22 22:57:46.244 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:348] - [BROADCAST] EAGLE_STABLE_KV -> targets=[0, 1] | chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.244 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:313] - [QUEUE] EAGLE_CACHE -> rank 0 | chunk_idx=1, incremental=True, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.244 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:313] - [QUEUE] EAGLE_CACHE -> rank 1 | chunk_idx=1, incremental=True, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.245 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=32, layer_idx=34, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.40ms
2026-01-22 22:57:46.245 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:430] - [WAIT] ç­‰å¾…æ¥æ”¶ HIDDEN (src_rank=1, timeout=60.0s)
2026-01-22 22:57:46.245 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:448] - [RECV_OK] HIDDEN æ¥æ”¶æˆåŠŸ | from rank 1, chunk_idx=2, wait_time=0.02ms
2026-01-22 22:57:46.245 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:453] -   hidden: shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 22:57:46.246 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=33, layer_idx=35, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.34ms
2026-01-22 22:57:46.251 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=34, layer_idx=35, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=5.02ms
2026-01-22 22:57:46.252 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=28, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.252 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=28, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.253 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:162] - [SEND] EAGLE_CACHE -> rank 0 | seq_id=35, chunk_idx=1, incremental=True, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.41ms
2026-01-22 22:57:46.254 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=37, layer_idx=28, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.07ms
2026-01-22 22:57:46.255 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=29, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.255 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=29, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.255 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=38, layer_idx=28, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.14ms
2026-01-22 22:57:46.256 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=39, layer_idx=29, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.05ms
2026-01-22 22:57:46.257 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=30, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.257 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=30, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.257 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=40, layer_idx=29, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.18ms
2026-01-22 22:57:46.258 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=31, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.259 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=31, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.259 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=41, layer_idx=30, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.35ms
2026-01-22 22:57:46.260 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=42, layer_idx=30, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.05ms
2026-01-22 22:57:46.261 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=43, layer_idx=31, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.07ms
2026-01-22 22:57:46.262 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=32, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.262 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=32, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.263 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=44, layer_idx=31, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.09ms
2026-01-22 22:57:46.264 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=45, layer_idx=32, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.06ms
2026-01-22 22:57:46.265 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=33, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.265 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=33, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.265 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=46, layer_idx=32, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.36ms
2026-01-22 22:57:46.267 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=47, layer_idx=33, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.12ms
2026-01-22 22:57:46.268 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=34, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.268 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=48, layer_idx=33, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.20ms
2026-01-22 22:57:46.268 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=34, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.269 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=49, layer_idx=34, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.09ms
2026-01-22 22:57:46.271 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=50, layer_idx=34, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.11ms
2026-01-22 22:57:46.271 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=35, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.271 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=35, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.272 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:582] - [WAIT] ç­‰å¾…æ¥æ”¶ ALL_EAGLE_INPUT_HIDDEN | expected_layers=[1, 17], chunk_idx=2, my_range=[28, 36), timeout=60.0s
2026-01-22 22:57:46.272 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:606] - [RECV_OK] EAGLE_INPUT_HIDDEN | layer_idx=1, chunk_idx=2, from rank 0, remaining={17}
2026-01-22 22:57:46.272 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:610] -   hidden: shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 22:57:46.272 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:606] - [RECV_OK] EAGLE_INPUT_HIDDEN | layer_idx=17, chunk_idx=2, from rank 1, remaining=set()
2026-01-22 22:57:46.272 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:610] -   hidden: shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 22:57:46.272 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:627] - [RECV_OK] ALL_EAGLE_INPUT_HIDDEN å…¨éƒ¨æ¥æ”¶å®Œæˆ | chunk_idx=2, layers=[1, 17], wait_time=0.31ms
2026-01-22 22:57:46.272 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:162] - [SEND] EAGLE_CACHE -> rank 1 | seq_id=36, chunk_idx=1, incremental=True, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.55ms
2026-01-22 22:57:46.274 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=51, layer_idx=35, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.22ms
2026-01-22 22:57:46.275 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=52, layer_idx=35, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.09ms
2026-01-22 22:57:46.276 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:348] - [BROADCAST] EAGLE_STABLE_KV -> targets=[0, 1] | chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.276 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:313] - [QUEUE] EAGLE_CACHE -> rank 0 | chunk_idx=2, incremental=True, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.276 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:313] - [QUEUE] EAGLE_CACHE -> rank 1 | chunk_idx=2, incremental=True, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.277 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:430] - [WAIT] ç­‰å¾…æ¥æ”¶ HIDDEN (src_rank=1, timeout=60.0s)
2026-01-22 22:57:46.277 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:448] - [RECV_OK] HIDDEN æ¥æ”¶æˆåŠŸ | from rank 1, chunk_idx=3, wait_time=0.03ms
2026-01-22 22:57:46.277 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:453] -   hidden: shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 22:57:46.277 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:162] - [SEND] EAGLE_CACHE -> rank 0 | seq_id=53, chunk_idx=2, incremental=True, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.28ms
2026-01-22 22:57:46.279 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:162] - [SEND] EAGLE_CACHE -> rank 1 | seq_id=54, chunk_idx=2, incremental=True, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.21ms
2026-01-22 22:57:46.280 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=28, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.280 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=28, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.281 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=55, layer_idx=28, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.09ms
2026-01-22 22:57:46.282 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=56, layer_idx=28, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.07ms
2026-01-22 22:57:46.283 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=29, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.283 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=29, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.284 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=57, layer_idx=29, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.08ms
2026-01-22 22:57:46.285 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=58, layer_idx=29, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.06ms
2026-01-22 22:57:46.285 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=30, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.286 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=30, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.287 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=59, layer_idx=30, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.45ms
2026-01-22 22:57:46.288 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=60, layer_idx=30, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.08ms
2026-01-22 22:57:46.289 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=31, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.289 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=31, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.290 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=61, layer_idx=31, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.16ms
2026-01-22 22:57:46.291 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=62, layer_idx=31, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.06ms
2026-01-22 22:57:46.291 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=32, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.291 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=32, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.293 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=63, layer_idx=32, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.19ms
2026-01-22 22:57:46.294 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=64, layer_idx=32, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.03ms
2026-01-22 22:57:46.294 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=33, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.294 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=33, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.295 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=65, layer_idx=33, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.07ms
2026-01-22 22:57:46.297 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=66, layer_idx=33, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.02ms
2026-01-22 22:57:46.297 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=34, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.297 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=34, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.298 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=67, layer_idx=34, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.14ms
2026-01-22 22:57:46.299 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=68, layer_idx=34, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.06ms
2026-01-22 22:57:46.299 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=35, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.300 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=35, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.300 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:582] - [WAIT] ç­‰å¾…æ¥æ”¶ ALL_EAGLE_INPUT_HIDDEN | expected_layers=[1, 17], chunk_idx=3, my_range=[28, 36), timeout=60.0s
2026-01-22 22:57:46.300 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:606] - [RECV_OK] EAGLE_INPUT_HIDDEN | layer_idx=1, chunk_idx=3, from rank 0, remaining={17}
2026-01-22 22:57:46.300 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:610] -   hidden: shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 22:57:46.300 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:606] - [RECV_OK] EAGLE_INPUT_HIDDEN | layer_idx=17, chunk_idx=3, from rank 1, remaining=set()
2026-01-22 22:57:46.300 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:610] -   hidden: shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-22 22:57:46.300 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:627] - [RECV_OK] ALL_EAGLE_INPUT_HIDDEN å…¨éƒ¨æ¥æ”¶å®Œæˆ | chunk_idx=3, layers=[1, 17], wait_time=0.27ms
2026-01-22 22:57:46.302 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=69, layer_idx=35, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=2.10ms
2026-01-22 22:57:46.303 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=70, layer_idx=35, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.10ms
2026-01-22 22:57:46.304 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:348] - [BROADCAST] EAGLE_STABLE_KV -> targets=[0, 1] | chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.304 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:313] - [QUEUE] EAGLE_CACHE -> rank 0 | chunk_idx=3, incremental=True, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.304 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:313] - [QUEUE] EAGLE_CACHE -> rank 1 | chunk_idx=3, incremental=True, key_shape=(1, 8, 128, 128)
2026-01-22 22:57:46.305 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:430] - [WAIT] ç­‰å¾…æ¥æ”¶ HIDDEN (src_rank=1, timeout=60.0s)
2026-01-22 22:57:46.305 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:448] - [RECV_OK] HIDDEN æ¥æ”¶æˆåŠŸ | from rank 1, chunk_idx=4, wait_time=0.03ms
2026-01-22 22:57:46.305 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:453] -   hidden: shape=(1, 62, 2560), dtype=float16, device=cuda:0, size=0.303MB
2026-01-22 22:57:46.306 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:162] - [SEND] EAGLE_CACHE -> rank 0 | seq_id=71, chunk_idx=3, incremental=True, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.39ms
2026-01-22 22:57:46.307 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:162] - [SEND] EAGLE_CACHE -> rank 1 | seq_id=72, chunk_idx=3, incremental=True, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.06ms
2026-01-22 22:57:46.308 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=28, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-22 22:57:46.309 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=28, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-22 22:57:46.310 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=73, layer_idx=28, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.96ms
2026-01-22 22:57:46.310 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=74, layer_idx=28, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.85ms
2026-01-22 22:57:46.311 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=29, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-22 22:57:46.311 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=29, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-22 22:57:46.312 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=75, layer_idx=29, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.92ms
2026-01-22 22:57:46.313 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=76, layer_idx=29, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.80ms
2026-01-22 22:57:46.314 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=30, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-22 22:57:46.314 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=30, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-22 22:57:46.315 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=77, layer_idx=30, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.96ms
2026-01-22 22:57:46.316 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=78, layer_idx=30, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.83ms
2026-01-22 22:57:46.316 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=31, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-22 22:57:46.317 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=31, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-22 22:57:46.317 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=79, layer_idx=31, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.84ms
2026-01-22 22:57:46.318 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=80, layer_idx=31, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.81ms
2026-01-22 22:57:46.319 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=32, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-22 22:57:46.319 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=32, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-22 22:57:46.320 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=81, layer_idx=32, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.86ms
2026-01-22 22:57:46.321 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=82, layer_idx=32, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.82ms
2026-01-22 22:57:46.322 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=33, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-22 22:57:46.322 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=33, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-22 22:57:46.323 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=83, layer_idx=33, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=1.01ms
2026-01-22 22:57:46.324 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=84, layer_idx=33, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.84ms
2026-01-22 22:57:46.324 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=34, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-22 22:57:46.325 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=34, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-22 22:57:46.326 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=85, layer_idx=34, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=1.16ms
2026-01-22 22:57:46.327 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=86, layer_idx=34, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.83ms
2026-01-22 22:57:46.327 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=35, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-22 22:57:46.328 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 1 | layer_idx=35, chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-22 22:57:46.329 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:582] - [WAIT] ç­‰å¾…æ¥æ”¶ ALL_EAGLE_INPUT_HIDDEN | expected_layers=[1, 17], chunk_idx=4, my_range=[28, 36), timeout=60.0s
2026-01-22 22:57:46.329 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:606] - [RECV_OK] EAGLE_INPUT_HIDDEN | layer_idx=1, chunk_idx=4, from rank 0, remaining={17}
2026-01-22 22:57:46.329 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:610] -   hidden: shape=(1, 62, 2560), dtype=float16, device=cuda:0, size=0.303MB
2026-01-22 22:57:46.329 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:606] - [RECV_OK] EAGLE_INPUT_HIDDEN | layer_idx=17, chunk_idx=4, from rank 1, remaining=set()
2026-01-22 22:57:46.329 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:610] -   hidden: shape=(1, 62, 2560), dtype=float16, device=cuda:0, size=0.303MB
2026-01-22 22:57:46.329 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:627] - [RECV_OK] ALL_EAGLE_INPUT_HIDDEN å…¨éƒ¨æ¥æ”¶å®Œæˆ | chunk_idx=4, layers=[1, 17], wait_time=0.15ms
2026-01-22 22:57:46.329 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=87, layer_idx=35, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=1.47ms
2026-01-22 22:57:46.330 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 1 | seq_id=88, layer_idx=35, chunk_idx=4, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.81ms
2026-01-22 22:57:46.386 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:348] - [BROADCAST] EAGLE_STABLE_KV -> targets=[0, 1] | chunk_idx=4, key_shape=(1, 8, 62, 128)
2026-01-22 22:57:46.386 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:313] - [QUEUE] EAGLE_CACHE -> rank 0 | chunk_idx=4, incremental=True, key_shape=(1, 8, 62, 128)
2026-01-22 22:57:46.386 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:313] - [QUEUE] EAGLE_CACHE -> rank 1 | chunk_idx=4, incremental=True, key_shape=(1, 8, 62, 128)
2026-01-22 22:57:46.386 - SpecSoT-Rank2-Comm - INFO - [p2p_comm_manager.py:207] - [BROADCAST] DRAFT_TOKENS -> targets=[0, 1] | draft_shape=(1, 40)
2026-01-22 22:57:46.386 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:211] -   retrieve_shape=(1, 22, 6), mask_shape=(1, 1, 40, 40)
2026-01-22 22:57:46.387 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:162] - [SEND] EAGLE_CACHE -> rank 0 | seq_id=89, chunk_idx=4, incremental=True, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.96ms
2026-01-22 22:57:46.388 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:118] - [SEND] DRAFT_TOKENS -> rank 0 | seq_id=91, draft_shape=(1, 40), size=9.33KB, time=0.85ms
2026-01-22 22:57:46.389 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:118] - [SEND] DRAFT_TOKENS -> rank 1 | seq_id=92, draft_shape=(1, 40), size=9.33KB, time=0.43ms
2026-01-22 22:57:46.390 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:162] - [SEND] EAGLE_CACHE -> rank 1 | seq_id=90, chunk_idx=4, incremental=True, key_shape=(1, 8, 62, 128), size=250.60KB, time=0.87ms
2026-01-22 22:57:46.390 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:776] - [WAIT] ç­‰å¾…æ¥æ”¶æ‰€æœ‰ Cache | expected_base_caches=0, expected_eagle_caches=0, my_layer_range=[28, 36), timeout=60.0s
2026-01-22 22:57:46.390 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:781] -   å¾…æ¥æ”¶çš„ base cache: []
2026-01-22 22:57:46.390 - SpecSoT-Rank2-Comm - INFO - [base_comm_manager.py:858] - [SYNC_OK] æ‰€æœ‰ Cache æ¥æ”¶å®Œæˆ | base_cache=0, eagle_cache=0, wait_time=2.22ms
2026-01-22 22:58:06.906 - SpecSoT-Rank2-Comm - DEBUG - [p2p_comm_manager.py:102] - [THREAD] å‘é€çº¿ç¨‹é€€å‡º
2026-01-22 22:58:06.992 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:189] - æ¥æ”¶çº¿ç¨‹é€€å‡º
2026-01-22 22:58:06.997 - SpecSoT-Rank2-Comm - DEBUG - [base_comm_manager.py:329] - é€šä¿¡ç®¡ç†å™¨å·²åœæ­¢
