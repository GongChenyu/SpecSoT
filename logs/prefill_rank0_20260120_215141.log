2026-01-20 21:51:41.351 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:181] - [INIT] 初始化ZMQ通信管理器 | mode=p2p, base_port=45000
2026-01-20 21:51:42.354 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:193] - [INIT] 等待其他节点就绪 (3.0秒)...
2026-01-20 21:51:45.358 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:198] - [INIT] 通信管理器已启动
2026-01-20 21:51:45.392 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:255] - ============================================================
2026-01-20 21:51:45.393 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:256] - [PREFILL] 开始分布式 Prefill 阶段
2026-01-20 21:51:45.393 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:257] - ============================================================
2026-01-20 21:51:45.393 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:258] -   Rank: 0/2
2026-01-20 21:51:45.393 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:259] -   负责层范围: [0, 14)
2026-01-20 21:51:45.393 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:260] -   输入序列长度: 568
2026-01-20 21:51:45.393 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:261] -   模型总层数: 36
2026-01-20 21:51:45.393 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:809] - [INIT] Cache 追踪初始化: chunks=5, layers=36, seq_len=568
2026-01-20 21:51:45.393 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:676] - [SPLIT] 输入序列切分为 5 个 chunks | seq_len=568, chunk_size=128
2026-01-20 21:51:45.393 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:678] -     Chunk 0: shape=torch.Size([1, 128])
2026-01-20 21:51:45.393 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:678] -     Chunk 1: shape=torch.Size([1, 128])
2026-01-20 21:51:45.393 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:678] -     Chunk 2: shape=torch.Size([1, 128])
2026-01-20 21:51:45.393 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:678] -     Chunk 3: shape=torch.Size([1, 128])
2026-01-20 21:51:45.393 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:678] -     Chunk 4: shape=torch.Size([1, 56])
2026-01-20 21:51:45.393 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:268] -   Chunk数量: 5 (chunk_size=128)
2026-01-20 21:51:45.393 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:731] - [EAGLE] Input Layers 配置: [2, 18, 33] (总层数=36)
2026-01-20 21:51:45.393 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:272] -   Eagle Input Layers: [2, 18, 33]
2026-01-20 21:51:45.393 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:286] - 
[CHUNK 1/5] 开始处理 | seq_len=128, first=True, last=False
2026-01-20 21:51:45.394 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:295] -   [PHASE 1] 执行 Embedding...
2026-01-20 21:51:45.446 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:297] -   [PHASE 1] Embedding 完成 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-20 21:51:45.446 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:313] -   [PHASE 1] 完成 | 耗时: 52.34ms
2026-01-20 21:51:45.446 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:319] -   [PHASE 2] 开始计算 Decoder Layers [0, 14)
2026-01-20 21:51:45.446 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:327] -     past_key_values_length=0, seq_with_past=128
2026-01-20 21:51:45.570 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=0 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.571 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=0 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.575 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=1 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.575 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=1 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.579 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:407] -     [SEND][EAGLE] hidden state layer=2 -> Rank 2
2026-01-20 21:51:45.579 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=2 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.579 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=2 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.583 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=3 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.583 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=3 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.587 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=4 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.587 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=4 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.591 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=5 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.591 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=5 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.594 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=6 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.595 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=6 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.598 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=7 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.598 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=7 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.601 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=8 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.601 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=8 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.604 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=9 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.605 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=9 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.607 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=10 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.608 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=10 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.610 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=11 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.611 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=11 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.613 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=12 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.613 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=12 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.616 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=13 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.616 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=13 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.617 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:432] -   [PHASE 2] 完成 | layers=14, cache_sent=28, eagle_hidden_sent=1 | 耗时: 170.72ms
2026-01-20 21:51:45.617 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:442] -   [PHASE 3][SEND] Hidden States -> Rank 1
2026-01-20 21:51:45.617 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:448] -     Hidden States 发送完成 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-20 21:51:45.617 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:547] -   [PHASE 3] 完成 | 耗时: 0.15ms
2026-01-20 21:51:45.618 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:553] - [CHUNK 1/5] 完成 | 总耗时: 224.49ms
2026-01-20 21:51:45.618 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:286] - 
[CHUNK 2/5] 开始处理 | seq_len=128, first=False, last=False
2026-01-20 21:51:45.618 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:295] -   [PHASE 1] 执行 Embedding...
2026-01-20 21:51:45.618 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:297] -   [PHASE 1] Embedding 完成 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-20 21:51:45.618 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:313] -   [PHASE 1] 完成 | 耗时: 0.18ms
2026-01-20 21:51:45.618 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:319] -   [PHASE 2] 开始计算 Decoder Layers [0, 14)
2026-01-20 21:51:45.619 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:327] -     past_key_values_length=128, seq_with_past=256
2026-01-20 21:51:45.622 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=0 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.623 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=0 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.625 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=1 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.626 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=1 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.629 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:407] -     [SEND][EAGLE] hidden state layer=2 -> Rank 2
2026-01-20 21:51:45.629 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=2 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.629 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=2 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.634 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=3 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.634 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=3 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.637 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=4 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.638 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=4 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.641 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=5 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.642 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=5 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.644 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=6 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.645 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=6 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.648 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=7 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.648 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=7 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.651 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=8 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.651 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=8 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.654 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=9 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.655 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=9 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.658 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=10 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.658 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=10 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.661 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=11 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.662 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=11 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.664 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=12 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.665 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=12 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.668 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=13 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.668 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=13 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.668 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:432] -   [PHASE 2] 完成 | layers=14, cache_sent=28, eagle_hidden_sent=1 | 耗时: 49.64ms
2026-01-20 21:51:45.668 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:442] -   [PHASE 3][SEND] Hidden States -> Rank 1
2026-01-20 21:51:45.668 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:448] -     Hidden States 发送完成 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-20 21:51:45.669 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:547] -   [PHASE 3] 完成 | 耗时: 0.38ms
2026-01-20 21:51:45.670 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:553] - [CHUNK 2/5] 完成 | 总耗时: 51.51ms
2026-01-20 21:51:45.670 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:286] - 
[CHUNK 3/5] 开始处理 | seq_len=128, first=False, last=False
2026-01-20 21:51:45.670 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:295] -   [PHASE 1] 执行 Embedding...
2026-01-20 21:51:45.670 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:297] -   [PHASE 1] Embedding 完成 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-20 21:51:45.670 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:313] -   [PHASE 1] 完成 | 耗时: 0.20ms
2026-01-20 21:51:45.670 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:319] -   [PHASE 2] 开始计算 Decoder Layers [0, 14)
2026-01-20 21:51:45.670 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:327] -     past_key_values_length=256, seq_with_past=384
2026-01-20 21:51:45.675 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=0 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.675 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=0 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.678 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=1 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.679 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=1 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.682 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:407] -     [SEND][EAGLE] hidden state layer=2 -> Rank 2
2026-01-20 21:51:45.682 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=2 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.683 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=2 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.687 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=3 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.687 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=3 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.690 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=4 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.690 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=4 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.693 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=5 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.694 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=5 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.696 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=6 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.697 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=6 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.700 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=7 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.700 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=7 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.703 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=8 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.703 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=8 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.706 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=9 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.706 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=9 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.710 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=10 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.710 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=10 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.713 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=11 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.713 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=11 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.716 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=12 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.717 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=12 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.719 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=13 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.720 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=13 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.720 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:432] -   [PHASE 2] 完成 | layers=14, cache_sent=28, eagle_hidden_sent=1 | 耗时: 49.80ms
2026-01-20 21:51:45.720 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:442] -   [PHASE 3][SEND] Hidden States -> Rank 1
2026-01-20 21:51:45.720 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:448] -     Hidden States 发送完成 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-20 21:51:45.720 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:547] -   [PHASE 3] 完成 | 耗时: 0.20ms
2026-01-20 21:51:45.721 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:553] - [CHUNK 3/5] 完成 | 总耗时: 51.57ms
2026-01-20 21:51:45.722 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:286] - 
[CHUNK 4/5] 开始处理 | seq_len=128, first=False, last=False
2026-01-20 21:51:45.722 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:295] -   [PHASE 1] 执行 Embedding...
2026-01-20 21:51:45.722 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:297] -   [PHASE 1] Embedding 完成 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-20 21:51:45.722 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:313] -   [PHASE 1] 完成 | 耗时: 0.19ms
2026-01-20 21:51:45.722 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:319] -   [PHASE 2] 开始计算 Decoder Layers [0, 14)
2026-01-20 21:51:45.723 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:327] -     past_key_values_length=384, seq_with_past=512
2026-01-20 21:51:45.726 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=0 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.727 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=0 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.730 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=1 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.730 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=1 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.733 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:407] -     [SEND][EAGLE] hidden state layer=2 -> Rank 2
2026-01-20 21:51:45.734 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=2 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.734 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=2 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.737 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=3 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.737 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=3 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.740 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=4 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.741 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=4 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.744 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=5 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.744 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=5 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.747 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=6 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.747 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=6 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.750 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=7 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.750 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=7 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.753 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=8 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.754 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=8 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.757 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=9 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.757 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=9 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.760 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=10 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.761 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=10 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.764 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=11 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.764 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=11 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.767 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=12 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.767 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=12 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.771 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=13 -> Rank 1 | size=0.50MB
2026-01-20 21:51:45.771 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=13 -> Rank 2 | size=0.50MB
2026-01-20 21:51:45.771 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:432] -   [PHASE 2] 完成 | layers=14, cache_sent=28, eagle_hidden_sent=1 | 耗时: 49.29ms
2026-01-20 21:51:45.771 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:442] -   [PHASE 3][SEND] Hidden States -> Rank 1
2026-01-20 21:51:45.771 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:448] -     Hidden States 发送完成 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-20 21:51:45.771 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:547] -   [PHASE 3] 完成 | 耗时: 0.22ms
2026-01-20 21:51:45.773 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:553] - [CHUNK 4/5] 完成 | 总耗时: 51.03ms
2026-01-20 21:51:45.773 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:286] - 
[CHUNK 5/5] 开始处理 | seq_len=56, first=False, last=True
2026-01-20 21:51:45.773 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:295] -   [PHASE 1] 执行 Embedding...
2026-01-20 21:51:45.773 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:297] -   [PHASE 1] Embedding 完成 | shape=(1, 56, 2560), dtype=float16, device=cuda:0, size=0.273MB
2026-01-20 21:51:45.773 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:313] -   [PHASE 1] 完成 | 耗时: 0.20ms
2026-01-20 21:51:45.773 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:319] -   [PHASE 2] 开始计算 Decoder Layers [0, 14)
2026-01-20 21:51:45.773 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:327] -     past_key_values_length=512, seq_with_past=568
2026-01-20 21:51:45.777 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=0 -> Rank 1 | size=0.22MB
2026-01-20 21:51:45.777 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=0 -> Rank 2 | size=0.22MB
2026-01-20 21:51:45.780 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=1 -> Rank 1 | size=0.22MB
2026-01-20 21:51:45.781 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=1 -> Rank 2 | size=0.22MB
2026-01-20 21:51:45.784 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:407] -     [SEND][EAGLE] hidden state layer=2 -> Rank 2
2026-01-20 21:51:45.784 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=2 -> Rank 1 | size=0.22MB
2026-01-20 21:51:45.784 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=2 -> Rank 2 | size=0.22MB
2026-01-20 21:51:45.787 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=3 -> Rank 1 | size=0.22MB
2026-01-20 21:51:45.788 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=3 -> Rank 2 | size=0.22MB
2026-01-20 21:51:45.791 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=4 -> Rank 1 | size=0.22MB
2026-01-20 21:51:45.791 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=4 -> Rank 2 | size=0.22MB
2026-01-20 21:51:45.794 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=5 -> Rank 1 | size=0.22MB
2026-01-20 21:51:45.794 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=5 -> Rank 2 | size=0.22MB
2026-01-20 21:51:45.797 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=6 -> Rank 1 | size=0.22MB
2026-01-20 21:51:45.797 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=6 -> Rank 2 | size=0.22MB
2026-01-20 21:51:45.800 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=7 -> Rank 1 | size=0.22MB
2026-01-20 21:51:45.801 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=7 -> Rank 2 | size=0.22MB
2026-01-20 21:51:45.803 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=8 -> Rank 1 | size=0.22MB
2026-01-20 21:51:45.804 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=8 -> Rank 2 | size=0.22MB
2026-01-20 21:51:45.806 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=9 -> Rank 1 | size=0.22MB
2026-01-20 21:51:45.807 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=9 -> Rank 2 | size=0.22MB
2026-01-20 21:51:45.810 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=10 -> Rank 1 | size=0.22MB
2026-01-20 21:51:45.810 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=10 -> Rank 2 | size=0.22MB
2026-01-20 21:51:45.817 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=11 -> Rank 1 | size=0.22MB
2026-01-20 21:51:45.818 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=11 -> Rank 2 | size=0.22MB
2026-01-20 21:51:45.821 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=12 -> Rank 1 | size=0.22MB
2026-01-20 21:51:45.821 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=12 -> Rank 2 | size=0.22MB
2026-01-20 21:51:45.824 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=13 -> Rank 1 | size=0.22MB
2026-01-20 21:51:45.824 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=13 -> Rank 2 | size=0.22MB
2026-01-20 21:51:45.825 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:432] -   [PHASE 2] 完成 | layers=14, cache_sent=28, eagle_hidden_sent=1 | 耗时: 51.54ms
2026-01-20 21:51:45.825 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:442] -   [PHASE 3][SEND] Hidden States -> Rank 1
2026-01-20 21:51:45.825 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:448] -     Hidden States 发送完成 | shape=(1, 56, 2560), dtype=float16, device=cuda:0, size=0.273MB
2026-01-20 21:51:45.825 - DistPrefill-Rank0 - DEBUG - [distributed_prefill.py:547] -   [PHASE 3] 完成 | 耗时: 0.21ms
2026-01-20 21:51:45.826 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:553] - [CHUNK 5/5] 完成 | 总耗时: 53.57ms
2026-01-20 21:51:45.826 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:558] - 
============================================================
2026-01-20 21:51:45.827 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:559] - [POST-CHUNK] 所有 Chunks 处理完成，开始同步阶段
2026-01-20 21:51:45.827 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:560] - ============================================================
2026-01-20 21:51:45.827 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:566] - [RECV] 等待 Draft Tokens (from Rank 2)...
2026-01-20 21:51:48.085 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:577] - [RECV] Draft Tokens 接收完成 | shape=torch.Size([1, 40]) | 耗时: 2258.07ms
2026-01-20 21:51:48.085 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:580] - [SYNC] 等待所有 Cache 同步...
2026-01-20 21:51:48.097 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:597] - [SYNC_OK] Rank 0 Cache 同步完成 | 耗时: 12.14ms
2026-01-20 21:51:48.097 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:606] - ============================================================
2026-01-20 21:51:48.097 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:607] - [PREFILL] 分布式 Prefill 完成 | 总耗时: 2.705s
2026-01-20 21:51:48.097 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:608] - ============================================================
2026-01-20 21:51:53.643 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:205] - [CLEANUP] 通信统计: {'draft_tokens_sent': 0, 'draft_tokens_recv': 1, 'hidden_sent': 5, 'hidden_recv': 0, 'eagle_input_hidden_sent': 5, 'eagle_input_hidden_recv': 0, 'base_cache_sent': 140, 'base_cache_recv': 110, 'eagle_cache_sent': 0, 'eagle_cache_recv': 5, 'aggregated_sends': 0, 'forwarded_messages': 0}
2026-01-20 21:51:53.735 - DistPrefill-Rank0 - INFO - [distributed_prefill.py:208] - [CLEANUP] 分布式Prefill管理器已清理
