2026-01-26 11:45:09.705 - SpecSoT-Rank1-Comm - INFO - [logging_utils.py:155] - 日志将保存到: /data/home/chenyu/Coding/SD+SoT/SpecSoT/logs/rank_1.log
22026-01-26 11:45:13.715 - SpecSoT-Rank1-Model - INFO - [specsot_model.py:348] - 分布式推理已启用: DistributedConfig(rank=1/2, layer_splits=[14, 28], comm_mode=p2p)
2026-01-26 11:45:13.715 - SpecSoT-Rank1-Model - INFO - [specsot_model.py:168] - 预初始化 VocabScanner 和 SemanticLogitsProcessor...
2026-01-26 11:45:13.733 - SpecSoT-Rank1-Model - INFO - [specsot_m2026-01-26 11:45:13.739 - SpecSoT-Rank1 - INFO - [run_spec2026-01-26 11:45:13.766 - SpecSoT-Rank1-Model - INFO - [specsot_model.py:661] - 使用 FSM 语义约束进行骨架生成
2026-01-26 11:45:16.330 - SpecSoT-Rank1-Model - INFO - [specsot_model.py:719] - Generated Skeleton:  [PLAN]
1.<154><Search>[-]Top 3 Cities in China
2.<543><Search>[-]Top 3 Cities in China
3.<456><Search>[-]Top 3 Cities in China
[END]</s><s>
2026-01-26 11:45:16.330 - SpecSoT-Rank1-Model - INFO - [specsot_model.py:726] - Skeleton generation completed in 2.571s
2026-01-26 11:45:16.331 - SpecSoT-Rank1-Model - INFO - [specsot_model.py:745] - Detected 3 parallel tasks: ['Top 3 Cities in China', 'Top 3 Cities in China', 'Top 3 Cities in China']
2026-01-26 11:45:16.332 - SpecSoT-Rank1-Model - INFO - [specsot_model.py:755] - Predicted lengths: [154, 543, 456]
2026-01-26 11:45:16.425 - SpecSoT-Rank1-Model - DEBUG - [specsot_model.py:803] - Parallel Decoding Step 1
2026-01-26 11:45:18.146 - SpecSoT-Rank1-Model - DEBUG - [specsot_model.py:803] - Parallel Decoding Step 51
2026-01-26 11:45:19.945 - SpecSoT-Rank1-Model - DEBUG - [specsot_model.py:803] - Parallel Decoding Step 101
2026-01-26 11:45:21.842 - SpecSoT-Rank1-Model - DEBUG - [specsot_model.py:803] - Parallel Decoding Step 151
2026-01-26 11:45:23.817 - SpecSoT-Rank1-Model - DEBUG - [specsot_model.py:803] - Parallel Decoding Step 201
2026-01-26 11:45:25.904 - SpecSoT-Rank1-Model - DEBUG - [specsot_model.py:803] - Parallel Decoding Step 251
2026-01-26 11:45:28.059 - SpecSoT-Rank1-Model - WARNING - [specsot_model.py:799] - Incomplete branches due to KV cache limit: [0, 1, 2]
2026-01-26 11:45:28.059 - SpecSoT-Rank1-Model - INFO - [specsot_model.py:843] - Avg accepted lengths: 6.41, Avg draft time: 0.0074s, Avg update time: 0.0009s, Avg verify time: 0.0307s
2026-01-26 11:45:28.059 - SpecSoT-Rank1-Model - INFO - [specsot_model.py:852] - Parallel decoding completed in 11.726s
 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:212] -   Chunk数量: 5 (chunk_size=128)
2026-01-26 11:45:13.772 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:675] - [EAGLE] Input Layers 配置: [1, 15, 28] (总层数=32)
2026-01-26 11:45:13.773 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:216] -   Eagle Input Layers: [1, 15, 28]
2026-01-26 11:45:13.773 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:230] - [CHUNK 1/5] 开始处理 | seq_len=128, first=True, last=False
2026-01-26 11:45:13.773 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:245] -   [PHASE 1] 等待接收 Hidden States (from Rank 0)...
2026-01-26 11:45:13.773 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:254] -   [PHASE 1][RECV] Hidden States | shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB | chunk_idx=0
2026-01-26 11:45:13.773 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:257] -   [PHASE 1] 完成 | 耗时: 0.62ms
2026-01-26 11:45:13.773 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:263] -   [PHASE 2] 开始计算 Decoder Layers [14, 28)
2026-01-26 11:45:13.774 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:271] -     past_key_values_length=0, seq_with_past=128
2026-01-26 11:45:14.015 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=14 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.015 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=14 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.020 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=15 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.020 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=15 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.022 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=16 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.022 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=16 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.025 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=17 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.026 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=17 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.030 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=18 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.030 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND]2026-01-26 11:45:14 - SpecSoT-Rank1 - INFO - [PREFILL] Chunks处理完成，开始 Cache 同步...
2026-01-26 11:45:15 - SpecSoT-Rank1 - INFO - [PREFILL] 分布式 Prefill 完成 | Rank=1 | 耗时: 1.987s
2026-01-26 11:45:16 - SpecSoT-Rank1-Model - INFO - Generated Skeleton:  [PLAN]
1.<154><Search>[-]Top 3 Cities in China
2.<543><Search>[-]Top 3 Cities in China
3.<456><Search>[-]Top 3 Cities in China
[END]</s><s>
2026-01-26 11:45:16 - SpecSoT-Rank1-Model - INFO - Skeleton generation completed in 2.571s
2026-01-26 11:45:16 - SpecSoT-Rank1-Model - INFO - Detected 3 parallel tasks: ['Top 3 Cities in China', 'Top 3 Cities in China', 'Top 3 Cities in China']
2026-01-26 11:45:16 - SpecSoT-Rank1-Model - INFO - Predicted lengths: [154, 543, 456]
Stopping due to KV cache limit: peak 3691 >= max 3678
2026-01-26 11:45:28 - SpecSoT-Rank1-Model - WARNING - Incomplete branches due to KV cache limit: [0, 1, 2]
2026-01-26 11:45:28 - SpecSoT-Rank1-Model - INFO - Avg accepted lengths: 6.41, Avg draft time: 0.0074s, Avg update time: 0.0009s, Avg verify time: 0.0307s
2026-01-26 11:45:28 - SpecSoT-Rank1-Model - INFO - Parallel decoding completed in 11.726s
2026-01-26 11:45:28 - SpecSoT-Rank1 - INFO - 
[统计信息]
2026-01-26 11:45:28 - SpecSoT-Rank1 - INFO -   推理时间: 14.30s
2026-01-26 11:45:28 - SpecSoT-Rank1 - INFO -   Skeleton阶段时间: 2.57s
2026-01-26 11:45:28 - SpecSoT-Rank1 - INFO -   Parallel阶段时间: 11.73s
2026-01-26 11:45:28 - SpecSoT-Rank1 - INFO -   峰值显存: 3552.38 MB
2026-01-26 11:45:28 - SpecSoT-Rank1 - INFO -   输出长度: 2914 tokens
2026-01-26 11:45:28 - SpecSoT-Rank1 - INFO -   吞吐量: 203.8 tokens/s
2026-01-26 11:45:28 - SpecSoT-Rank1 - INFO -   并行分支数: 3
2026-01-26 11:45:28 - SpecSoT-Rank1 - INFO -   平均接受长度: 6.41
2026-01-26 11:45:28 - SpecSoT-Rank1 - INFO -   平均Draft时间: 7.41 ms
2026-01-26 11:45:28 - SpecSoT-Rank1 - INFO -   平均Verify时间: 30.72 ms
2026-01-26 11:45:28 - SpecSoT-Rank1 - INFO -   平均Update时间: 0.86 ms
2026-01-26 11:45:28 - SpecSoT-Rank1 - INFO - 
[响应预览]
2026-01-26 11:45:28 - SpecSoT-Rank1 - INFO - [PLAN]
1.<154><Search>[-]Top 3 Cities in China
2.<543><Search>[-]Top 3 Cities in China
3.<456><Search>[-]Top 3 Cities in China
[END] 

## 1. Top 3 Cities in China
 China is home to some of the most populous and influential cities in the world. With a population of over 1.4 billion people, the country is a major player in global politics, economics, and culture. Here are the top 3 cities in China that you should know about:

1. Beijing: The capital of China, Beijing is a city with a rich history and a vibrant present. It is home to some of the country's most iconic landmarks, including the Great Wall of China, the Forbidden City, and the Temple of Heaven. The city is also a hub for technology and innovation, with a thriving startup scene and a number of world-class universities.
2. Shanghai: Known as the "Pearl of the Orient," Shanghai is China's largest city and one of the world's most important financial centers. It is home to some of the country's most impressive skyscrapers, as well...
2026-01-26 11:45:28 - SpecSoT-Rank1 - INFO - [CLEANUP] 通信统计: {'draft_tokens_sent': 0, 'draft_tokens_recv': 1, 'hidden_sent': 5, 'hidden_recv': 5, 'eagle_input_hidden_sent': 0, 'eagle_input_hidden_recv': 0, 'base_cache_sent': 140, 'base_cache_recv': 90, 'eagle_cache_sent': 0, 'eagle_cache_recv': 5, 'aggregated_sends': 0, 'forwarded_messages': 0}
2026-01-26 11:45:28 - SpecSoT-Rank1 - INFO - Worker 执行完成
k 0 | size=2.00MB
2026-01-26 11:45:14.061 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=4, chunk=0 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.062 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=5, chunk=0 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.062 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=6, chunk=0 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.062 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=7, chunk=0 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.062 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=8, chunk=0 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.062 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=9, chunk=0 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.063 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=10, chunk=0 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.063 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=11, chunk=0 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.063 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=12, chunk=0 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.063 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=13, chunk=0 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.063 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=0, chunk=1 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.064 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=1, chunk=1 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.064 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=2, chunk=1 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.064 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=3, chunk=1 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.064 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=4, chunk=1 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.064 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=5, chunk=1 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.064 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=6, chunk=1 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.065 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=7, chunk=1 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.065 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=8, chunk=1 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.065 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=9, chunk=1 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.065 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=10, chunk=1 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.065 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=11, chunk=1 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.065 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=12, chunk=1 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.066 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=13, chunk=1 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.067 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=0, chunk=2 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.067 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=1, chunk=2 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.067 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=2, chunk=2 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.067 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=3, chunk=2 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.067 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=4, chunk=2 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.067 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=5, chunk=2 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.068 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=6, chunk=2 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.068 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=7, chunk=2 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.068 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=8, chunk=2 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.068 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=9, chunk=2 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.068 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=10, chunk=2 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.068 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=11, chunk=2 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.069 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=12, chunk=2 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.070 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=13, chunk=2 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.070 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=0, chunk=3 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.070 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=1, chunk=3 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.070 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=2, chunk=3 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.070 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=3, chunk=3 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.070 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=4, chunk=3 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.070 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=5, chunk=3 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.071 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=6, chunk=3 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.071 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=7, chunk=3 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.071 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=8, chunk=3 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.071 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=9, chunk=3 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.072 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=10, chunk=3 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.073 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=11, chunk=3 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.073 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=12, chunk=3 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.073 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=13, chunk=3 from Rank 0 | size=2.00MB
2026-01-26 11:45:14.073 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=0, chunk=4 from Rank 0 | size=1.03MB
2026-01-26 11:45:14.073 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=1, chunk=4 from Rank 0 | size=1.03MB
2026-01-26 11:45:14.074 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=2, chunk=4 from Rank 0 | size=1.03MB
2026-01-26 11:45:14.074 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=3, chunk=4 from Rank 0 | size=1.03MB
2026-01-26 11:45:14.074 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=4, chunk=4 from Rank 0 | size=1.03MB
2026-01-26 11:45:14.074 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=5, chunk=4 from Rank 0 | size=1.03MB
2026-01-26 11:45:14.074 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=6, chunk=4 from Rank 0 | size=1.03MB
2026-01-26 11:45:14.076 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=7, chunk=4 from Rank 0 | size=1.03MB
2026-01-26 11:45:14.076 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=8, chunk=4 from Rank 0 | size=1.03MB
2026-01-26 11:45:14.076 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=9, chunk=4 from Rank 0 | size=1.03MB
2026-01-26 11:45:14.076 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=10, chunk=4 from Rank 0 | size=1.03MB
2026-01-26 11:45:14.076 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=11, chunk=4 from Rank 0 | size=1.03MB
2026-01-26 11:45:14.077 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=12, chunk=4 from Rank 0 | size=1.03MB
2026-01-26 11:45:14.077 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=13, chunk=4 from Rank 0 | size=1.03MB
2026-01-26 11:45:14.078 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:663] -   [CACHE] 非阻塞接收 70 个 Base Cache
2026-01-26 11:45:14.079 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:502] - [CHUNK 1/5] 完成 | 总耗时: 306.71ms
2026-01-26 11:45:14.079 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:230] - [CHUNK 2/5] 开始处理 | seq_len=128, first=False, last=False
2026-01-26 11:45:14.080 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:245] -   [PHASE 1] 等待接收 Hidden States (from Rank 0)...
2026-01-26 11:45:14.080 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:254] -   [PHASE 1][RECV] Hidden States | shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB | chunk_idx=1
2026-01-26 11:45:14.080 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:257] -   [PHASE 1] 完成 | 耗时: 0.30ms
2026-01-26 11:45:14.080 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:263] -   [PHASE 2] 开始计算 Decoder Layers [14, 28)
2026-01-26 11:45:14.080 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:271] -     past_key_values_length=128, seq_with_past=256
2026-01-26 11:45:14.085 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=14 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.085 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=14 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.088 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=15 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.088 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=15 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.091 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=16 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.091 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=16 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.095 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=17 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.095 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=17 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.098 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=18 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.098 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=18 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.102 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=19 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.102 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=19 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.108 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=20 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.108 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=20 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.112 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=21 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.112 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=21 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.118 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=22 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.118 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=22 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.122 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=23 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.123 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=23 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.126 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=24 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.128 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=24 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.133 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=25 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.133 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=25 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.137 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=26 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.138 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=26 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.143 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=27 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.144 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=27 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.144 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:377] -   [PHASE 2] 完成 | layers=14, cache_sent=28, eagle_hidden_sent=0 | 耗时: 63.71ms
2026-01-26 11:45:14.144 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:387] -   [PHASE 3][SEND] Hidden States -> Rank 2
2026-01-26 11:45:14.144 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:393] -     Hidden States 发送完成 | shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:14.144 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:496] -   [PHASE 3] 完成 | 耗时: 0.29ms
2026-01-26 11:45:14.145 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:502] - [CHUNK 2/5] 完成 | 总耗时: 65.79ms
2026-01-26 11:45:14.145 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:230] - [CHUNK 3/5] 开始处理 | seq_len=128, first=False, last=False
2026-01-26 11:45:14.145 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:245] -   [PHASE 1] 等待接收 Hidden States (from Rank 0)...
2026-01-26 11:45:14.146 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:254] -   [PHASE 1][RECV] Hidden States | shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB | chunk_idx=2
2026-01-26 11:45:14.146 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:257] -   [PHASE 1] 完成 | 耗时: 0.34ms
2026-01-26 11:45:14.146 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:263] -   [PHASE 2] 开始计算 Decoder Layers [14, 28)
2026-01-26 11:45:14.146 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:271] -     past_key_values_length=256, seq_with_past=384
2026-01-26 11:45:14.153 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=14 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.153 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=14 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.156 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=15 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.156 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=15 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.158 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=16 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.159 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=16 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.162 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=17 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.162 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=17 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.165 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=18 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.165 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=18 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.167 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=19 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.168 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=19 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.170 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=20 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.170 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=20 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.173 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=21 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.173 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=21 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.175 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=22 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.176 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=22 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.178 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=23 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.178 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=23 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.181 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=24 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.181 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=24 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.183 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=25 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.184 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=25 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.186 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=26 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.186 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=26 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.189 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=27 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.189 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=27 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.189 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:377] -   [PHASE 2] 完成 | layers=14, cache_sent=28, eagle_hidden_sent=0 | 耗时: 43.05ms
2026-01-26 11:45:14.189 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:387] -   [PHASE 3][SEND] Hidden States -> Rank 2
2026-01-26 11:45:14.189 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:393] -     Hidden States 发送完成 | shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:14.190 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:496] -   [PHASE 3] 完成 | 耗时: 0.40ms
2026-01-26 11:45:14.191 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:502] - [CHUNK 3/5] 完成 | 总耗时: 45.34ms
2026-01-26 11:45:14.191 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:230] - [CHUNK 4/5] 开始处理 | seq_len=128, first=False, last=False
2026-01-26 11:45:14.191 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:245] -   [PHASE 1] 等待接收 Hidden States (from Rank 0)...
2026-01-26 11:45:14.191 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:254] -   [PHASE 1][RECV] Hidden States | shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB | chunk_idx=3
2026-01-26 11:45:14.191 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:257] -   [PHASE 1] 完成 | 耗时: 0.21ms
2026-01-26 11:45:14.191 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:263] -   [PHASE 2] 开始计算 Decoder Layers [14, 28)
2026-01-26 11:45:14.191 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:271] -     past_key_values_length=384, seq_with_past=512
2026-01-26 11:45:14.195 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=14 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.195 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=14 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.197 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=15 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.198 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=15 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.200 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=16 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.201 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=16 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.204 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=17 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.204 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=17 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.206 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=18 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.206 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=18 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.209 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=19 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.209 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=19 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.212 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=20 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.212 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=20 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.215 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=21 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.215 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=21 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.217 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=22 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.218 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=22 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.220 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=23 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.220 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=23 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.223 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=24 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.223 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=24 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.226 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=25 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.226 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=25 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.229 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=26 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.229 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=26 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.232 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=27 -> Rank 0 | size=2.00MB
2026-01-26 11:45:14.232 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=27 -> Rank 2 | size=2.00MB
2026-01-26 11:45:14.232 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:377] -   [PHASE 2] 完成 | layers=14, cache_sent=28, eagle_hidden_sent=0 | 耗时: 40.72ms
2026-01-26 11:45:14.232 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:387] -   [PHASE 3][SEND] Hidden States -> Rank 2
2026-01-26 11:45:14.232 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:393] -     Hidden States 发送完成 | shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:14.233 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:496] -   [PHASE 3] 完成 | 耗时: 0.66ms
2026-01-26 11:45:14.234 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:502] - [CHUNK 4/5] 完成 | 总耗时: 42.92ms
2026-01-26 11:45:14.234 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:230] - [CHUNK 5/5] 开始处理 | seq_len=66, first=False, last=True
2026-01-26 11:45:14.234 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:245] -   [PHASE 1] 等待接收 Hidden States (from Rank 0)...
2026-01-26 11:45:14.234 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:254] -   [PHASE 1][RECV] Hidden States | shape=(1, 66, 4096), dtype=float16, device=cuda:0, size=0.516MB | chunk_idx=4
2026-01-26 11:45:14.234 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:257] -   [PHASE 1] 完成 | 耗时: 0.22ms
2026-01-26 11:45:14.234 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:263] -   [PHASE 2] 开始计算 Decoder Layers [14, 28)
2026-01-26 11:45:14.234 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:271] -     past_key_values_length=512, seq_with_past=578
2026-01-26 11:45:14.239 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=14 -> Rank 0 | size=1.03MB
2026-01-26 11:45:14.239 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=14 -> Rank 2 | size=1.03MB
2026-01-26 11:45:14.242 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=15 -> Rank 0 | size=1.03MB
2026-01-26 11:45:14.242 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=15 -> Rank 2 | size=1.03MB
2026-01-26 11:45:14.245 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=16 -> Rank 0 | size=1.03MB
2026-01-26 11:45:14.246 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=16 -> Rank 2 | size=1.03MB
2026-01-26 11:45:14.249 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=17 -> Rank 0 | size=1.03MB
2026-01-26 11:45:14.249 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=17 -> Rank 2 | size=1.03MB
2026-01-26 11:45:14.252 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=18 -> Rank 0 | size=1.03MB
2026-01-26 11:45:14.252 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=18 -> Rank 2 | size=1.03MB
2026-01-26 11:45:14.255 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=19 -> Rank 0 | size=1.03MB
2026-01-26 11:45:14.255 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=19 -> Rank 2 | size=1.03MB
2026-01-26 11:45:14.258 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=20 -> Rank 0 | size=1.03MB
2026-01-26 11:45:14.258 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=20 -> Rank 2 | size=1.03MB
2026-01-26 11:45:14.261 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=21 -> Rank 0 | size=1.03MB
2026-01-26 11:45:14.261 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=21 -> Rank 2 | size=1.03MB
2026-01-26 11:45:14.264 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=22 -> Rank 0 | size=1.03MB
2026-01-26 11:45:14.264 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=22 -> Rank 2 | size=1.03MB
2026-01-26 11:45:14.267 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=23 -> Rank 0 | size=1.03MB
2026-01-26 11:45:14.267 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=23 -> Rank 2 | size=1.03MB
2026-01-26 11:45:14.270 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=24 -> Rank 0 | size=1.03MB
2026-01-26 11:45:14.270 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=24 -> Rank 2 | size=1.03MB
2026-01-26 11:45:14.273 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=25 -> Rank 0 | size=1.03MB
2026-01-26 11:45:14.273 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=25 -> Rank 2 | size=1.03MB
2026-01-26 11:45:14.277 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=26 -> Rank 0 | size=1.03MB
2026-01-26 11:45:14.277 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=26 -> Rank 2 | size=1.03MB
2026-01-26 11:45:14.280 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=27 -> Rank 0 | size=1.03MB
2026-01-26 11:45:14.281 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=27 -> Rank 2 | size=1.03MB
2026-01-26 11:45:14.281 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:377] -   [PHASE 2] 完成 | layers=14, cache_sent=28, eagle_hidden_sent=0 | 耗时: 46.38ms
2026-01-26 11:45:14.281 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:387] -   [PHASE 3][SEND] Hidden States -> Rank 2
2026-01-26 11:45:14.282 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:393] -     Hidden States 发送完成 | shape=(1, 66, 4096), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:14.282 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:496] -   [PHASE 3] 完成 | 耗时: 1.08ms
2026-01-26 11:45:14.283 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:502] - [CHUNK 5/5] 完成 | 总耗时: 48.95ms
2026-01-26 11:45:14.283 - SpecSoT-Rank1 - INFO - [distributed_prefill.py:507] - [PREFILL] Chunks处理完成，开始 Cache 同步...
2026-01-26 11:45:14.283 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:513] - [RECV] 等待 Draft Tokens (from Rank 2)...
2026-01-26 11:45:15.733 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:524] - [RECV] Draft Tokens 接收完成 | shape=torch.Size([1, 40]) | 耗时: 1449.35ms
2026-01-26 11:45:15.733 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:527] - [SYNC] 等待所有 Cache 同步...
2026-01-26 11:45:15.757 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:545] - [SYNC_OK] Rank 1 Cache 同步完成 | 耗时: 24.25ms
2026-01-26 11:45:15.757 - SpecSoT-Rank1 - INFO - [distributed_prefill.py:554] - [PREFILL] 分布式 Prefill 完成 | Rank=1 | 耗时: 1.987s
2026-01-26 11:45:28.088 - SpecSoT-Rank1 - INFO - [run_specsot.py:362] - 
[统计信息]
2026-01-26 11:45:28.088 - SpecSoT-Rank1 - INFO - [run_specsot.py:363] -   推理时间: 14.30s
2026-01-26 11:45:28.088 - SpecSoT-Rank1 - INFO - [run_specsot.py:365] -   Skeleton阶段时间: 2.57s
2026-01-26 11:45:28.088 - SpecSoT-Rank1 - INFO - [run_specsot.py:366] -   Parallel阶段时间: 11.73s
2026-01-26 11:45:28.088 - SpecSoT-Rank1 - INFO - [run_specsot.py:367] -   峰值显存: 3552.38 MB
2026-01-26 11:45:28.088 - SpecSoT-Rank1 - INFO - [run_specsot.py:368] -   输出长度: 2914 tokens
2026-01-26 11:45:28.088 - SpecSoT-Rank1 - INFO - [run_specsot.py:369] -   吞吐量: 203.8 tokens/s
2026-01-26 11:45:28.088 - SpecSoT-Rank1 - INFO - [run_specsot.py:370] -   并行分支数: 3
2026-01-26 11:45:28.088 - SpecSoT-Rank1 - INFO - [run_specsot.py:371] -   平均接受长度: 6.41
2026-01-26 11:45:28.088 - SpecSoT-Rank1 - INFO - [run_specsot.py:372] -   平均Draft时间: 7.41 ms
2026-01-26 11:45:28.088 - SpecSoT-Rank1 - INFO - [run_specsot.py:373] -   平均Verify时间: 30.72 ms
2026-01-26 11:45:28.088 - SpecSoT-Rank1 - INFO - [run_specsot.py:374] -   平均Update时间: 0.86 ms
2026-01-26 11:45:28.088 - SpecSoT-Rank1 - INFO - [run_specsot.py:377] - 
[响应预览]
2026-01-26 11:45:28.088 - SpecSoT-Rank1 - INFO - [run_specsot.py:378] - [PLAN]
1.<154><Search>[-]Top 3 Cities in China
2.<543><Search>[-]Top 3 Cities in China
3.<456><Search>[-]Top 3 Cities in China
[END] 

## 1. Top 3 Cities in China
 China is home to some of the most populous and influential cities in the world. With a population of over 1.4 billion people, the country is a major player in global politics, economics, and culture. Here are the top 3 cities in China that you should know about:

1. Beijing: The capital of China, Beijing is a city with a rich history and a vibrant present. It is home to some of the country's most iconic landmarks, including the Great Wall of China, the Forbidden City, and the Temple of Heaven. The city is also a hub for technology and innovation, with a thriving startup scene and a number of world-class universities.
2. Shanghai: Known as the "Pearl of the Orient," Shanghai is China's largest city and one of the world's most important financial centers. It is home to some of the country's most impressive skyscrapers, as well...
2026-01-26 11:45:28.088 - SpecSoT-Rank1 - DEBUG - [run_specsot.py:441] - 正在清理分布式资源...
2026-01-26 11:45:28.088 - SpecSoT-Rank1 - INFO - [distributed_prefill.py:155] - [CLEANUP] 通信统计: {'draft_tokens_sent': 0, 'draft_tokens_recv': 1, 'hidden_sent': 5, 'hidden_recv': 5, 'eagle_input_hidden_sent': 0, 'eagle_input_hidden_recv': 0, 'base_cache_sent': 140, 'base_cache_recv': 90, 'eagle_cache_sent': 0, 'eagle_cache_recv': 5, 'aggregated_sends': 0, 'forwarded_messages': 0}
2026-01-26 11:45:28.172 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:158] - [CLEANUP] 分布式Prefill管理器已清理
2026-01-26 11:45:28.173 - SpecSoT-Rank1 - DEBUG - [run_specsot.py:443] - 分布式资源已清理
2026-01-26 11:45:28.173 - SpecSoT-Rank1 - INFO - [run_specsot.py:445] - Worker 执行完成
 32, 128, 128)
2026-01-26 11:45:14.091 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=16, chunk_idx=1, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.093 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=23, layer_idx=25, chunk_idx=0, key_shape=(1, 32, 128, 128), size=2050.60KB, time=3.28ms
2026-01-26 11:45:14.095 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=17, chunk_idx=1, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.095 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=17, chunk_idx=1, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.097 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=24, layer_idx=25, chunk_idx=0, key_shape=(1, 32, 128, 128), size=2050.60KB, time=3.32ms
2026-01-26 11:45:14.098 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=18, chunk_idx=1, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.098 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=18, chunk_idx=1, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.100 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=25, layer_idx=26, chunk_idx=0, key_shape=(1, 32, 128, 128), size=2050.60KB, time=3.28ms
2026-01-26 11:45:14.102 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=19, chunk_idx=1, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.102 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=19, chunk_idx=1, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.104 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=26, layer_idx=26, chunk_idx=0, key_shape=(1, 32, 128, 128), size=2050.60KB, time=3.48ms
2026-01-26 11:45:14.107 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=27, layer_idx=27, chunk_idx=0, key_shape=(1, 32, 128, 128), size=2050.60KB, time=3.29ms
2026-01-26 11:45:14.108 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=20, chunk_idx=1, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.108 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=20, chunk_idx=1, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.111 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=28, layer_idx=27, chunk_idx=0, key_shape=(1, 32, 128, 128), size=2050.60KB, time=3.42ms
2026-01-26 11:45:14.112 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=21, chunk_idx=1, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.112 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=21, chunk_idx=1, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.114 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=30, layer_idx=14, chunk_idx=1, key_shape=(1, 32, 128, 128), size=2050.60KB, time=3.49ms
2026-01-26 11:45:14.118 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=31, layer_idx=14, chunk_idx=1, key_shape=(1, 32, 128, 128), size=2050.60KB, time=3.23ms
2026-01-26 11:45:14.118 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=22, chunk_idx=1, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.118 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=22, chunk_idx=1, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.121 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=32, layer_idx=15, chunk_idx=1, key_shape=(1, 32, 128, 128), size=2050.60KB, time=3.33ms
2026-01-26 11:45:14.122 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=23, chunk_idx=1, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.122 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=23, chunk_idx=1, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.125 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=33, layer_idx=15, chunk_idx=1, key_shape=(1, 32, 128, 128), size=2050.60KB, time=3.41ms
2026-01-26 11:45:14.126 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=24, chunk_idx=1, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.128 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=24, chunk_idx=1, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.128 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=34, layer_idx=16, chunk_idx=1, key_shape=(1, 32, 128, 128), size=2050.60KB, time=3.38ms
2026-01-26 11:45:14.132 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=35, layer_idx=16, chunk_idx=1, key_shape=(1, 32, 128, 128), size=2050.60KB, time=3.28ms
2026-01-26 11:45:14.133 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=25, chunk_idx=1, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.133 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=25, chunk_idx=1, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.136 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=36, layer_idx=17, chunk_idx=1, key_shape=(1, 32, 128, 128), size=2050.60KB, time=3.53ms
2026-01-26 11:45:14.137 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=26, chunk_idx=1, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.137 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=26, chunk_idx=1, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.139 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=37, layer_idx=17, chunk_idx=1, key_shape=(1, 32, 128, 128), size=2050.60KB, time=3.52ms
2026-01-26 11:45:14.143 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=27, chunk_idx=1, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.143 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=27, chunk_idx=1, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.144 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=38, layer_idx=18, chunk_idx=1, key_shape=(1, 32, 128, 128), size=2050.60KB, time=4.35ms
2026-01-26 11:45:14.144 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:231] - [QUEUE] HIDDEN -> rank 2 | chunk_idx=1
2026-01-26 11:45:14.144 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:235] -   hidden: shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:14.145 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:430] - [WAIT] 等待接收 HIDDEN (src_rank=0, timeout=60.0s)
2026-01-26 11:45:14.146 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:448] - [RECV_OK] HIDDEN 接收成功 | from rank 0, chunk_idx=2, wait_time=0.17ms
2026-01-26 11:45:14.146 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:453] -   hidden: shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:14.149 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=39, layer_idx=18, chunk_idx=1, key_shape=(1, 32, 128, 128), size=2050.60KB, time=4.68ms
2026-01-26 11:45:14.150 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:128] - [SEND] HIDDEN -> rank 2 | seq_id=58, chunk_idx=1, size=1025.38KB, time=1.42ms
2026-01-26 11:45:14.150 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:133] -   hidden: shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:14.153 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=40, layer_idx=19, chunk_idx=1, key_shape=(1, 32, 128, 128), size=2050.60KB, time=2.37ms
2026-01-26 11:45:14.153 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=14, chunk_idx=2, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.153 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=14, chunk_idx=2, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.155 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=41, layer_idx=19, chunk_idx=1, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.90ms
2026-01-26 11:45:14.155 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=15, chunk_idx=2, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.156 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=15, chunk_idx=2, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.157 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=42, layer_idx=20, chunk_idx=1, key_shape=(1, 32, 128, 128), size=2050.60KB, time=2.06ms
2026-01-26 11:45:14.158 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=16, chunk_idx=2, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.159 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=16, chunk_idx=2, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.159 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=43, layer_idx=20, chunk_idx=1, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.97ms
2026-01-26 11:45:14.161 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=44, layer_idx=21, chunk_idx=1, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.84ms
2026-01-26 11:45:14.162 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=17, chunk_idx=2, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.162 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=17, chunk_idx=2, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.163 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=45, layer_idx=21, chunk_idx=1, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.99ms
2026-01-26 11:45:14.164 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=18, chunk_idx=2, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.165 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=18, chunk_idx=2, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.165 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=46, layer_idx=22, chunk_idx=1, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.89ms
2026-01-26 11:45:14.167 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=47, layer_idx=22, chunk_idx=1, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.84ms
2026-01-26 11:45:14.167 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=19, chunk_idx=2, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.168 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=19, chunk_idx=2, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.169 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=48, layer_idx=23, chunk_idx=1, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.90ms
2026-01-26 11:45:14.170 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=20, chunk_idx=2, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.170 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=20, chunk_idx=2, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.171 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=49, layer_idx=23, chunk_idx=1, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.91ms
2026-01-26 11:45:14.172 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=21, chunk_idx=2, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.173 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=21, chunk_idx=2, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.173 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=50, layer_idx=24, chunk_idx=1, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.91ms
2026-01-26 11:45:14.175 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=51, layer_idx=24, chunk_idx=1, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.80ms
2026-01-26 11:45:14.175 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=22, chunk_idx=2, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.176 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=22, chunk_idx=2, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.177 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=52, layer_idx=25, chunk_idx=1, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.93ms
2026-01-26 11:45:14.178 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=23, chunk_idx=2, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.178 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=23, chunk_idx=2, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.179 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=53, layer_idx=25, chunk_idx=1, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.90ms
2026-01-26 11:45:14.180 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=24, chunk_idx=2, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.181 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=24, chunk_idx=2, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.181 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=54, layer_idx=26, chunk_idx=1, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.95ms
2026-01-26 11:45:14.183 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=55, layer_idx=26, chunk_idx=1, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.80ms
2026-01-26 11:45:14.183 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=25, chunk_idx=2, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.184 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=25, chunk_idx=2, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.185 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=56, layer_idx=27, chunk_idx=1, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.79ms
2026-01-26 11:45:14.186 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=26, chunk_idx=2, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.186 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=26, chunk_idx=2, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.187 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=57, layer_idx=27, chunk_idx=1, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.91ms
2026-01-26 11:45:14.188 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=27, chunk_idx=2, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.189 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=27, chunk_idx=2, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.189 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:231] - [QUEUE] HIDDEN -> rank 2 | chunk_idx=2
2026-01-26 11:45:14.189 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:235] -   hidden: shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:14.189 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=59, layer_idx=14, chunk_idx=2, key_shape=(1, 32, 128, 128), size=2050.60KB, time=2.08ms
2026-01-26 11:45:14.191 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:128] - [SEND] HIDDEN -> rank 2 | seq_id=87, chunk_idx=2, size=1025.38KB, time=0.92ms
2026-01-26 11:45:14.191 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:133] -   hidden: shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:14.191 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:430] - [WAIT] 等待接收 HIDDEN (src_rank=0, timeout=60.0s)
2026-01-26 11:45:14.191 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:448] - [RECV_OK] HIDDEN 接收成功 | from rank 0, chunk_idx=3, wait_time=0.05ms
2026-01-26 11:45:14.191 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:453] -   hidden: shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:14.192 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=60, layer_idx=14, chunk_idx=2, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.72ms
2026-01-26 11:45:14.194 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=61, layer_idx=15, chunk_idx=2, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.74ms
2026-01-26 11:45:14.194 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=14, chunk_idx=3, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.195 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=14, chunk_idx=3, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.196 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=62, layer_idx=15, chunk_idx=2, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.87ms
2026-01-26 11:45:14.197 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=15, chunk_idx=3, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.197 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=15, chunk_idx=3, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.198 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=63, layer_idx=16, chunk_idx=2, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.93ms
2026-01-26 11:45:14.200 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=16, chunk_idx=3, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.201 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=16, chunk_idx=3, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.201 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=64, layer_idx=16, chunk_idx=2, key_shape=(1, 32, 128, 128), size=2050.60KB, time=2.37ms
2026-01-26 11:45:14.203 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=65, layer_idx=17, chunk_idx=2, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.81ms
2026-01-26 11:45:14.203 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=17, chunk_idx=3, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.204 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=17, chunk_idx=3, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.205 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=66, layer_idx=17, chunk_idx=2, key_shape=(1, 32, 128, 128), size=2050.60KB, time=2.09ms
2026-01-26 11:45:14.206 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=18, chunk_idx=3, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.206 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=18, chunk_idx=3, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.207 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=67, layer_idx=18, chunk_idx=2, key_shape=(1, 32, 128, 128), size=2050.60KB, time=2.05ms
2026-01-26 11:45:14.208 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=19, chunk_idx=3, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.209 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=19, chunk_idx=3, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.209 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=68, layer_idx=18, chunk_idx=2, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.96ms
2026-01-26 11:45:14.211 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=69, layer_idx=19, chunk_idx=2, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.79ms
2026-01-26 11:45:14.212 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=20, chunk_idx=3, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.212 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=20, chunk_idx=3, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.213 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=70, layer_idx=19, chunk_idx=2, key_shape=(1, 32, 128, 128), size=2050.60KB, time=2.01ms
2026-01-26 11:45:14.215 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=21, chunk_idx=3, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.215 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=21, chunk_idx=3, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.215 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=71, layer_idx=20, chunk_idx=2, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.98ms
2026-01-26 11:45:14.217 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=22, chunk_idx=3, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.217 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=22, chunk_idx=3, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.218 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=72, layer_idx=20, chunk_idx=2, key_shape=(1, 32, 128, 128), size=2050.60KB, time=2.01ms
2026-01-26 11:45:14.220 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=73, layer_idx=21, chunk_idx=2, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.81ms
2026-01-26 11:45:14.220 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=23, chunk_idx=3, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.220 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=23, chunk_idx=3, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.222 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=74, layer_idx=21, chunk_idx=2, key_shape=(1, 32, 128, 128), size=2050.60KB, time=2.04ms
2026-01-26 11:45:14.223 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=24, chunk_idx=3, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.223 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=24, chunk_idx=3, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.224 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=75, layer_idx=22, chunk_idx=2, key_shape=(1, 32, 128, 128), size=2050.60KB, time=2.08ms
2026-01-26 11:45:14.226 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=25, chunk_idx=3, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.226 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=76, layer_idx=22, chunk_idx=2, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.92ms
2026-01-26 11:45:14.226 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=25, chunk_idx=3, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.228 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=77, layer_idx=23, chunk_idx=2, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.85ms
2026-01-26 11:45:14.229 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=26, chunk_idx=3, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.229 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=26, chunk_idx=3, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.230 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=78, layer_idx=23, chunk_idx=2, key_shape=(1, 32, 128, 128), size=2050.60KB, time=2.10ms
2026-01-26 11:45:14.232 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=27, chunk_idx=3, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.232 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=27, chunk_idx=3, key_shape=(1, 32, 128, 128)
2026-01-26 11:45:14.232 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:231] - [QUEUE] HIDDEN -> rank 2 | chunk_idx=3
2026-01-26 11:45:14.232 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:235] -   hidden: shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:14.233 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=79, layer_idx=24, chunk_idx=2, key_shape=(1, 32, 128, 128), size=2050.60KB, time=2.14ms
2026-01-26 11:45:14.234 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:128] - [SEND] HIDDEN -> rank 2 | seq_id=116, chunk_idx=3, size=1025.38KB, time=0.90ms
2026-01-26 11:45:14.234 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:133] -   hidden: shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:14.234 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:430] - [WAIT] 等待接收 HIDDEN (src_rank=0, timeout=60.0s)
2026-01-26 11:45:14.234 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:448] - [RECV_OK] HIDDEN 接收成功 | from rank 0, chunk_idx=4, wait_time=0.06ms
2026-01-26 11:45:14.234 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:453] -   hidden: shape=(1, 66, 4096), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:14.236 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=80, layer_idx=24, chunk_idx=2, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.80ms
2026-01-26 11:45:14.237 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=81, layer_idx=25, chunk_idx=2, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.73ms
2026-01-26 11:45:14.239 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=14, chunk_idx=4, key_shape=(1, 32, 66, 128)
2026-01-26 11:45:14.239 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=14, chunk_idx=4, key_shape=(1, 32, 66, 128)
2026-01-26 11:45:14.239 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=82, layer_idx=25, chunk_idx=2, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.95ms
2026-01-26 11:45:14.241 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=83, layer_idx=26, chunk_idx=2, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.76ms
2026-01-26 11:45:14.242 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=15, chunk_idx=4, key_shape=(1, 32, 66, 128)
2026-01-26 11:45:14.242 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=15, chunk_idx=4, key_shape=(1, 32, 66, 128)
2026-01-26 11:45:14.243 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=84, layer_idx=26, chunk_idx=2, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.80ms
2026-01-26 11:45:14.244 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=85, layer_idx=27, chunk_idx=2, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.17ms
2026-01-26 11:45:14.245 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=16, chunk_idx=4, key_shape=(1, 32, 66, 128)
2026-01-26 11:45:14.245 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=16, chunk_idx=4, key_shape=(1, 32, 66, 128)
2026-01-26 11:45:14.246 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=86, layer_idx=27, chunk_idx=2, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.46ms
2026-01-26 11:45:14.248 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=88, layer_idx=14, chunk_idx=3, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.47ms
2026-01-26 11:45:14.249 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=17, chunk_idx=4, key_shape=(1, 32, 66, 128)
2026-01-26 11:45:14.249 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=17, chunk_idx=4, key_shape=(1, 32, 66, 128)
2026-01-26 11:45:14.249 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=89, layer_idx=14, chunk_idx=3, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.51ms
2026-01-26 11:45:14.250 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=90, layer_idx=15, chunk_idx=3, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.14ms
2026-01-26 11:45:14.252 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=18, chunk_idx=4, key_shape=(1, 32, 66, 128)
2026-01-26 11:45:14.252 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=91, layer_idx=15, chunk_idx=3, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.29ms
2026-01-26 11:45:14.252 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=18, chunk_idx=4, key_shape=(1, 32, 66, 128)
2026-01-26 11:45:14.253 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=92, layer_idx=16, chunk_idx=3, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.26ms
2026-01-26 11:45:14.254 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=93, layer_idx=16, chunk_idx=3, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.21ms
2026-01-26 11:45:14.255 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=19, chunk_idx=4, key_shape=(1, 32, 66, 128)
2026-01-26 11:45:14.255 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=19, chunk_idx=4, key_shape=(1, 32, 66, 128)
2026-01-26 11:45:14.256 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=94, layer_idx=17, chunk_idx=3, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.16ms
2026-01-26 11:45:14.257 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=95, layer_idx=17, chunk_idx=3, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.07ms
2026-01-26 11:45:14.257 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=20, chunk_idx=4, key_shape=(1, 32, 66, 128)
2026-01-26 11:45:14.258 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=20, chunk_idx=4, key_shape=(1, 32, 66, 128)
2026-01-26 11:45:14.258 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=96, layer_idx=18, chunk_idx=3, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.39ms
2026-01-26 11:45:14.260 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=97, layer_idx=18, chunk_idx=3, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.14ms
2026-01-26 11:45:14.260 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=21, chunk_idx=4, key_shape=(1, 32, 66, 128)
2026-01-26 11:45:14.261 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=21, chunk_idx=4, key_shape=(1, 32, 66, 128)
2026-01-26 11:45:14.261 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=98, layer_idx=19, chunk_idx=3, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.41ms
2026-01-26 11:45:14.262 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=99, layer_idx=19, chunk_idx=3, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.12ms
2026-01-26 11:45:14.264 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=22, chunk_idx=4, key_shape=(1, 32, 66, 128)
2026-01-26 11:45:14.264 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=100, layer_idx=20, chunk_idx=3, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.33ms
2026-01-26 11:45:14.264 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=22, chunk_idx=4, key_shape=(1, 32, 66, 128)
2026-01-26 11:45:14.265 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=101, layer_idx=20, chunk_idx=3, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.19ms
2026-01-26 11:45:14.266 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=102, layer_idx=21, chunk_idx=3, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.18ms
2026-01-26 11:45:14.267 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=23, chunk_idx=4, key_shape=(1, 32, 66, 128)
2026-01-26 11:45:14.267 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=23, chunk_idx=4, key_shape=(1, 32, 66, 128)
2026-01-26 11:45:14.268 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=103, layer_idx=21, chunk_idx=3, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.39ms
2026-01-26 11:45:14.269 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=104, layer_idx=22, chunk_idx=3, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.14ms
2026-01-26 11:45:14.270 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=24, chunk_idx=4, key_shape=(1, 32, 66, 128)
2026-01-26 11:45:14.270 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=24, chunk_idx=4, key_shape=(1, 32, 66, 128)
2026-01-26 11:45:14.270 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=105, layer_idx=22, chunk_idx=3, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.33ms
2026-01-26 11:45:14.272 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=106, layer_idx=23, chunk_idx=3, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.11ms
2026-01-26 11:45:14.273 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=25, chunk_idx=4, key_shape=(1, 32, 66, 128)
2026-01-26 11:45:14.273 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=107, layer_idx=23, chunk_idx=3, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.23ms
2026-01-26 11:45:14.273 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=25, chunk_idx=4, key_shape=(1, 32, 66, 128)
2026-01-26 11:45:14.274 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=108, layer_idx=24, chunk_idx=3, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.21ms
2026-01-26 11:45:14.276 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=109, layer_idx=24, chunk_idx=3, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.62ms
2026-01-26 11:45:14.276 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=26, chunk_idx=4, key_shape=(1, 32, 66, 128)
2026-01-26 11:45:14.277 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=26, chunk_idx=4, key_shape=(1, 32, 66, 128)
2026-01-26 11:45:14.278 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=110, layer_idx=25, chunk_idx=3, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.73ms
2026-01-26 11:45:14.280 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=111, layer_idx=25, chunk_idx=3, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.73ms
2026-01-26 11:45:14.280 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=27, chunk_idx=4, key_shape=(1, 32, 66, 128)
2026-01-26 11:45:14.281 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=27, chunk_idx=4, key_shape=(1, 32, 66, 128)
2026-01-26 11:45:14.281 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:231] - [QUEUE] HIDDEN -> rank 2 | chunk_idx=4
2026-01-26 11:45:14.281 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:235] -   hidden: shape=(1, 66, 4096), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:14.282 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=112, layer_idx=26, chunk_idx=3, key_shape=(1, 32, 128, 128), size=2050.60KB, time=2.15ms
2026-01-26 11:45:14.282 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:128] - [SEND] HIDDEN -> rank 2 | seq_id=145, chunk_idx=4, size=529.38KB, time=0.41ms
2026-01-26 11:45:14.282 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:133] -   hidden: shape=(1, 66, 4096), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:14.283 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:370] - [WAIT] 等待接收 DRAFT_TOKENS (src_rank=2, timeout=60.0s)
2026-01-26 11:45:14.284 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=113, layer_idx=26, chunk_idx=3, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.73ms
2026-01-26 11:45:14.286 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=114, layer_idx=27, chunk_idx=3, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.34ms
2026-01-26 11:45:14.287 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=115, layer_idx=27, chunk_idx=3, key_shape=(1, 32, 128, 128), size=2050.60KB, time=1.12ms
2026-01-26 11:45:14.287 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=117, layer_idx=14, chunk_idx=4, key_shape=(1, 32, 66, 128), size=1058.60KB, time=0.59ms
2026-01-26 11:45:14.288 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=118, layer_idx=14, chunk_idx=4, key_shape=(1, 32, 66, 128), size=1058.60KB, time=0.62ms
2026-01-26 11:45:14.289 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=119, layer_idx=15, chunk_idx=4, key_shape=(1, 32, 66, 128), size=1058.60KB, time=0.59ms
2026-01-26 11:45:14.289 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=120, layer_idx=15, chunk_idx=4, key_shape=(1, 32, 66, 128), size=1058.60KB, time=0.58ms
2026-01-26 11:45:14.290 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=121, layer_idx=16, chunk_idx=4, key_shape=(1, 32, 66, 128), size=1058.60KB, time=0.58ms
2026-01-26 11:45:14.290 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=122, layer_idx=16, chunk_idx=4, key_shape=(1, 32, 66, 128), size=1058.60KB, time=0.59ms
2026-01-26 11:45:14.291 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=123, layer_idx=17, chunk_idx=4, key_shape=(1, 32, 66, 128), size=1058.60KB, time=0.57ms
2026-01-26 11:45:14.292 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=124, layer_idx=17, chunk_idx=4, key_shape=(1, 32, 66, 128), size=1058.60KB, time=0.63ms
2026-01-26 11:45:14.292 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=125, layer_idx=18, chunk_idx=4, key_shape=(1, 32, 66, 128), size=1058.60KB, time=0.62ms
2026-01-26 11:45:14.293 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=126, layer_idx=18, chunk_idx=4, key_shape=(1, 32, 66, 128), size=1058.60KB, time=0.58ms
2026-01-26 11:45:14.294 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=127, layer_idx=19, chunk_idx=4, key_shape=(1, 32, 66, 128), size=1058.60KB, time=0.65ms
2026-01-26 11:45:14.294 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=128, layer_idx=19, chunk_idx=4, key_shape=(1, 32, 66, 128), size=1058.60KB, time=0.61ms
2026-01-26 11:45:14.295 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=129, layer_idx=20, chunk_idx=4, key_shape=(1, 32, 66, 128), size=1058.60KB, time=0.62ms
2026-01-26 11:45:14.296 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=130, layer_idx=20, chunk_idx=4, key_shape=(1, 32, 66, 128), size=1058.60KB, time=0.64ms
2026-01-26 11:45:14.296 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=131, layer_idx=21, chunk_idx=4, key_shape=(1, 32, 66, 128), size=1058.60KB, time=0.62ms
2026-01-26 11:45:14.297 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=132, layer_idx=21, chunk_idx=4, key_shape=(1, 32, 66, 128), size=1058.60KB, time=0.61ms
2026-01-26 11:45:14.298 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=133, layer_idx=22, chunk_idx=4, key_shape=(1, 32, 66, 128), size=1058.60KB, time=0.62ms
2026-01-26 11:45:14.298 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=134, layer_idx=22, chunk_idx=4, key_shape=(1, 32, 66, 128), size=1058.60KB, time=0.63ms
2026-01-26 11:45:14.299 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=135, layer_idx=23, chunk_idx=4, key_shape=(1, 32, 66, 128), size=1058.60KB, time=0.59ms
2026-01-26 11:45:14.300 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=136, layer_idx=23, chunk_idx=4, key_shape=(1, 32, 66, 128), size=1058.60KB, time=0.61ms
2026-01-26 11:45:14.300 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=137, layer_idx=24, chunk_idx=4, key_shape=(1, 32, 66, 128), size=1058.60KB, time=0.60ms
2026-01-26 11:45:14.301 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=138, layer_idx=24, chunk_idx=4, key_shape=(1, 32, 66, 128), size=1058.60KB, time=0.63ms
2026-01-26 11:45:14.302 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=139, layer_idx=25, chunk_idx=4, key_shape=(1, 32, 66, 128), size=1058.60KB, time=0.60ms
2026-01-26 11:45:14.302 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=140, layer_idx=25, chunk_idx=4, key_shape=(1, 32, 66, 128), size=1058.60KB, time=0.63ms
2026-01-26 11:45:14.303 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=141, layer_idx=26, chunk_idx=4, key_shape=(1, 32, 66, 128), size=1058.60KB, time=0.61ms
2026-01-26 11:45:14.304 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=142, layer_idx=26, chunk_idx=4, key_shape=(1, 32, 66, 128), size=1058.60KB, time=0.65ms
2026-01-26 11:45:14.304 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=143, layer_idx=27, chunk_idx=4, key_shape=(1, 32, 66, 128), size=1058.60KB, time=0.59ms
2026-01-26 11:45:14.305 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=144, layer_idx=27, chunk_idx=4, key_shape=(1, 32, 66, 128), size=1058.60KB, time=0.75ms
2026-01-26 11:45:15.502 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 2 | layer_idx=28, chunk_idx=0, seq_id=2, latency=16.95ms
2026-01-26 11:45:15.502 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.511 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 2 | layer_idx=29, chunk_idx=0, seq_id=4, latency=10.70ms
2026-01-26 11:45:15.511 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.522 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 2 | layer_idx=30, chunk_idx=0, seq_id=6, latency=10.43ms
2026-01-26 11:45:15.522 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.536 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 2 | layer_idx=31, chunk_idx=0, seq_id=8, latency=10.77ms
2026-01-26 11:45:15.536 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.573 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:275] - [RECV] EAGLE_CACHE from rank 2 | chunk_idx=0, incremental=True, seq_id=10, latency=13.74ms
2026-01-26 11:45:15.573 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:279] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.630 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 2 | layer_idx=28, chunk_idx=1, seq_id=12, latency=8.18ms
2026-01-26 11:45:15.630 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.637 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 2 | layer_idx=29, chunk_idx=1, seq_id=14, latency=13.55ms
2026-01-26 11:45:15.637 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.644 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 2 | layer_idx=30, chunk_idx=1, seq_id=16, latency=18.25ms
2026-01-26 11:45:15.644 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.652 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 2 | layer_idx=31, chunk_idx=1, seq_id=18, latency=24.64ms
2026-01-26 11:45:15.652 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.659 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 2 | layer_idx=28, chunk_idx=2, seq_id=22, latency=22.85ms
2026-01-26 11:45:15.659 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.667 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 2 | layer_idx=29, chunk_idx=2, seq_id=24, latency=29.43ms
2026-01-26 11:45:15.667 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.673 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 2 | layer_idx=30, chunk_idx=2, seq_id=26, latency=32.65ms
2026-01-26 11:45:15.673 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.684 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 2 | layer_idx=31, chunk_idx=2, seq_id=28, latency=40.69ms
2026-01-26 11:45:15.684 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.704 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 2 | layer_idx=28, chunk_idx=3, seq_id=32, latency=52.87ms
2026-01-26 11:45:15.704 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.708 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 2 | layer_idx=29, chunk_idx=3, seq_id=34, latency=54.03ms
2026-01-26 11:45:15.708 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.718 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 2 | layer_idx=30, chunk_idx=3, seq_id=36, latency=62.54ms
2026-01-26 11:45:15.718 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.723 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 2 | layer_idx=31, chunk_idx=3, seq_id=38, latency=64.69ms
2026-01-26 11:45:15.723 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.731 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 2 | layer_idx=28, chunk_idx=4, seq_id=42, latency=64.32ms
2026-01-26 11:45:15.731 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
  value: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:15.732 - SpecSoT-Rank1-Comm - INFO - [base_comm_manager.py:223] - [RECV] DRAFT_TOKENS from rank 2 | seq_id=52, latency=2.62ms
2026-01-26 11:45:15.732 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:227] -   draft_tokens: shape=(1, 40), dtype=int64, device=cpu, size=0.000MB
  retrieve_indices: shape=(1, 26, 6), dtype=int64, device=cpu, size=0.001MB
  tree_mask: shape=(1, 1, 40, 40), dtype=float32, device=cpu, size=0.006MB
  tree_position_ids: shape=(1, 40), dtype=int64, device=cpu, size=0.000MB
2026-01-26 11:45:15.732 - SpecSoT-Rank1-Comm - INFO - [base_comm_manager.py:395] - [RECV_OK] DRAFT_TOKENS 接收成功 | from rank 2, wait_time=1449.15ms, draft_tokens shape=(1, 40)
2026-01-26 11:45:15.733 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:776] - [WAIT] 等待接收所有 Cache | expected_base_caches=20, expected_eagle_caches=5, my_layer_range=[14, 28), timeout=60.0s
2026-01-26 11:45:15.733 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:781] -   待接收的 base cache: [(0, 28), (0, 29), (0, 30), (0, 31), (1, 28), (1, 29), (1, 30), (1, 31), (2, 28), (2, 29), (2, 30), (2, 31), (3, 28), (3, 29), (3, 30), (3, 31), (4, 28), (4, 29), (4, 30), (4, 31)]
2026-01-26 11:45:15.734 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:803] - [CACHE_RECV] BASE_CACHE | layer=28, chunk=0, from rank=2, remaining=19
2026-01-26 11:45:15.734 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:807] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.734 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:803] - [CACHE_RECV] BASE_CACHE | layer=29, chunk=0, from rank=2, remaining=18
2026-01-26 11:45:15.734 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:807] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.734 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:803] - [CACHE_RECV] BASE_CACHE | layer=30, chunk=0, from rank=2, remaining=17
2026-01-26 11:45:15.734 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:807] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.734 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:803] - [CACHE_RECV] BASE_CACHE | layer=31, chunk=0, from rank=2, remaining=16
2026-01-26 11:45:15.734 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:807] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.734 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:803] - [CACHE_RECV] BASE_CACHE | layer=28, chunk=1, from rank=2, remaining=15
2026-01-26 11:45:15.734 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:807] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.734 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:803] - [CACHE_RECV] BASE_CACHE | layer=29, chunk=1, from rank=2, remaining=14
2026-01-26 11:45:15.734 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:807] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.734 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:803] - [CACHE_RECV] BASE_CACHE | layer=30, chunk=1, from rank=2, remaining=13
2026-01-26 11:45:15.734 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:807] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.734 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:803] - [CACHE_RECV] BASE_CACHE | layer=31, chunk=1, from rank=2, remaining=12
2026-01-26 11:45:15.734 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:807] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.735 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:803] - [CACHE_RECV] BASE_CACHE | layer=28, chunk=2, from rank=2, remaining=11
2026-01-26 11:45:15.735 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:807] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.735 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:803] - [CACHE_RECV] BASE_CACHE | layer=29, chunk=2, from rank=2, remaining=10
2026-01-26 11:45:15.735 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:807] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.736 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 2 | layer_idx=29, chunk_idx=4, seq_id=44, latency=65.36ms
2026-01-26 11:45:15.736 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
  value: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:15.736 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:803] - [CACHE_RECV] BASE_CACHE | layer=30, chunk=2, from rank=2, remaining=9
2026-01-26 11:45:15.736 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:807] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.736 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:803] - [CACHE_RECV] BASE_CACHE | layer=31, chunk=2, from rank=2, remaining=8
2026-01-26 11:45:15.736 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:807] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.736 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:803] - [CACHE_RECV] BASE_CACHE | layer=28, chunk=3, from rank=2, remaining=7
2026-01-26 11:45:15.736 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:807] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.736 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:803] - [CACHE_RECV] BASE_CACHE | layer=29, chunk=3, from rank=2, remaining=6
2026-01-26 11:45:15.736 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:807] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.736 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:803] - [CACHE_RECV] BASE_CACHE | layer=30, chunk=3, from rank=2, remaining=5
2026-01-26 11:45:15.736 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:807] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.736 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:803] - [CACHE_RECV] BASE_CACHE | layer=31, chunk=3, from rank=2, remaining=4
2026-01-26 11:45:15.736 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:807] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.736 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:803] - [CACHE_RECV] BASE_CACHE | layer=28, chunk=4, from rank=2, remaining=3
2026-01-26 11:45:15.736 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:807] -   key: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:15.737 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:803] - [CACHE_RECV] BASE_CACHE | layer=29, chunk=4, from rank=2, remaining=2
2026-01-26 11:45:15.737 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:807] -   key: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:15.738 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 2 | layer_idx=30, chunk_idx=4, seq_id=46, latency=66.09ms
2026-01-26 11:45:15.738 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
  value: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:15.738 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:803] - [CACHE_RECV] BASE_CACHE | layer=30, chunk=4, from rank=2, remaining=1
2026-01-26 11:45:15.738 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:807] -   key: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:15.740 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 2 | layer_idx=31, chunk_idx=4, seq_id=48, latency=67.53ms
2026-01-26 11:45:15.740 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
  value: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:15.741 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:803] - [CACHE_RECV] BASE_CACHE | layer=31, chunk=4, from rank=2, remaining=0
2026-01-26 11:45:15.741 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:807] -   key: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:15.741 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:837] - [CACHE_RECV] EAGLE_CACHE | chunk=0, incremental=True, from rank=2, kv_length=128, remaining=4
2026-01-26 11:45:15.741 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:841] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.745 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:275] - [RECV] EAGLE_CACHE from rank 2 | chunk_idx=1, incremental=True, seq_id=20, latency=114.42ms
2026-01-26 11:45:15.745 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:279] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.745 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:837] - [CACHE_RECV] EAGLE_CACHE | chunk=1, incremental=True, from rank=2, kv_length=256, remaining=3
2026-01-26 11:45:15.745 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:841] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.750 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:275] - [RECV] EAGLE_CACHE from rank 2 | chunk_idx=2, incremental=True, seq_id=30, latency=102.86ms
2026-01-26 11:45:15.750 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:279] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.750 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:837] - [CACHE_RECV] EAGLE_CACHE | chunk=2, incremental=True, from rank=2, kv_length=384, remaining=2
2026-01-26 11:45:15.750 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:841] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.754 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:275] - [RECV] EAGLE_CACHE from rank 2 | chunk_idx=3, incremental=True, seq_id=40, latency=92.48ms
2026-01-26 11:45:15.754 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:279] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
  value: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.754 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:837] - [CACHE_RECV] EAGLE_CACHE | chunk=3, incremental=True, from rank=2, kv_length=512, remaining=1
2026-01-26 11:45:15.754 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:841] -   key: shape=(1, 32, 128, 128), dtype=float16, device=cuda:0, size=1.000MB
2026-01-26 11:45:15.757 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:275] - [RECV] EAGLE_CACHE from rank 2 | chunk_idx=4, incremental=True, seq_id=50, latency=27.35ms
2026-01-26 11:45:15.757 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:279] -   key: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
  value: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:15.757 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:837] - [CACHE_RECV] EAGLE_CACHE | chunk=4, incremental=True, from rank=2, kv_length=578, remaining=0
2026-01-26 11:45:15.757 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:841] -   key: shape=(1, 32, 66, 128), dtype=float16, device=cuda:0, size=0.516MB
2026-01-26 11:45:15.757 - SpecSoT-Rank1-Comm - INFO - [base_comm_manager.py:858] - [SYNC_OK] 所有 Cache 接收完成 | base_cache=20, eagle_cache=5, wait_time=24.20ms
2026-01-26 11:45:28.116 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:102] - [THREAD] 发送线程退出
2026-01-26 11:45:28.172 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:189] - 接收线程退出
2026-01-26 11:45:28.172 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:329] - 通信管理器已停止
