2026-01-23 14:49:19.905 - SpecSoT-Rank1-Comm - INFO - [logging_utils.py:155] - 日志将保存到: /data/home/chenyu/Coding/SD+SoT/Speculative-Decoding-Enabled-Skeleton-of-Thought/logs/rank_1.log
22026-01-23 14:49:23.912 - SpecSoT-Rank1-Model - INFO - [specsot_model.py:335] - 分布式推理已启用: DistributedConfig(rank=1/2, layer_splits=[14, 28], comm_mode=p2p)
2026-01-23 14:49:30.234 - SpecSoT-Rank1-Model - INFO - [specsot_model.py:668] - Generated Skeleton: #### 提高投篮命中率建议多角度分析与练习

1.  **技术方面**
    1.  #### 恒久性手枪握把螺丝助力提升球员进攻中球与手Gun之間的动态位置（80 tokens）：...
    2.  #### 能量的背板训练力，让我们的肩部给予足夠的弹力_ASS（130 tokens）：...
    3.  #### 合理构架的停留步，停在靶點下的傾斜UP持有尚未游戏U的三点性焦点CREATE！见敵()));
##  [增加体能方面](#### 体能
2026-01-23 14:49:30.237 - SpecSoT-Rank1-Model - INFO - [specsot_model.py:691] - Detected 2 parallel branches with predicted lengths: [80, 130]
sot.py:347] -   ellipsis_token_id: 128000 -> '<|begin_of_text|>'
2026-01-23 14:49:23.931 - SpecSoT-Rank1 - DEBUG - [run_specsot.py:347] -   half_ellipsis_token_id: 128000 -> '<|begin_of_text|>'
2026-01-23 14:49:23.931 - SpecSoT-Rank1 - DEBUG - [run_specsot.py:347] -   line_break_token_id: 128000 -> '<|begin_of_text|>'
2026-01-23 14:49:23.931 - SpecSoT-Rank1 - DEBUG - [run_specsot.py:347] -   colon_token_id: 128000 -> '<|begin_of_text|>'
2026-01-23 14:49:23.931 - SpecSoT-Rank1 - DEBUG - [run_specsot.py:347] -   cn_colon_token_id: 128000 -> '<|begin_of_text|>'
2026-01-23 14:49:23.931 - SpecSoT-Rank1 - DEBUG - [run_specsot.py:347] -   colon_new_line_token_id: 128000 -> '<|begin_of_text|>'
2026-01-23 14:49:23.940 - SpecSoT-Rank1 - INFO - [run_specsot.py:230] - 加载数据集: /data/home/chenyu/Coding/SD+SoT/Speculative-Decoding-Enabled-Skeleton-of-Thought/datasets/planning/industry_tasks_no_ascii.jsonl, 共 9 条样本
2026-01-23 14:49:23.941 - SpecSoT-Rank1 - INFO - [run_specsot.py:354] - 使用 1 条样本进行评估
2026-01-23 14:49:23.941 - SpecSoT-Rank1 - INFO - [run_specsot.py:370] - 
============================================================
2026-01-23 14:49:23.941 - SpecSoT-Rank1 - INFO - [run_specsot.py:371] - 样本 1/1: 请问打篮球时，如何提高投篮命中率？请给出详细的建议。...
2026-01-23 14:49:23.941 - SpecSoT-Rank1 - INFO - [run_specsot.py:372] - ============================================================
2026-01-23 14:49:23.977 - SpecSoT-Rank1 - INFO - [distributed_prefill.py:205] - [PREFILL] 开始 | Rank=1/2 | layers=[14,28) | seq_len=616
2026-01-23 14:49:23.977 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:753] - [INIT] Cache 追踪初始化: chunks=5, layers=32, seq_len=616
2026-01-23 14:49:23.977 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:620] - [SPLIT] 输入序列切分为 5 个 chunks | seq_len=616, chunk_size=128
2026-01-23 14:49:23.977 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:622] -     Chunk 0: shape=torch.Size([1, 128])
2026-01-23 14:49:23.978 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:622] -     Chunk 1: shape=torch.Size([1, 128])
2026-01-23 14:49:23.978 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:622] -     Chunk 2: shape=torch.Size([1, 128])
2026-01-23 14:49:23.978 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:622] -     Chunk 3: shape=torch.Size([1, 128])
2026-01-23 14:49:23.978 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:622] -     Chunk 4: shape=torch.Size([1, 104])
2026-01-23 14:49:23.978 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:212] -   Chunk数量: 5 (chunk_size=128)
2026-01-23 14:49:23.978 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:675] - [EAGLE] Input Layers 配置: [1, 15, 28] (总层数=32)
2026-01-23 14:49:23.978 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:216] -   Eagle Input Layers: [1, 15, 28]
2026-01-23 14:49:23.978 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:230] - [CHUNK 1/5] 开始处理 | seq_len=128, first=True, last=False
2026-01-23 14:49:23.978 - SpecSoT-Rank1 - DEBUG - [distributed_prefi2026-01-23 14:49:24 - SpecSoT-Rank1 - INFO - [PREFILL] Chunks处理完成，开始 Cache 同步...
2026-01-23 14:49:25 - SpecSoT-Rank1 - INFO - [PREFILL] 分布式 Prefill 完成 | Rank=1 | 耗时: 1.461s
2026-01-23 14:49:30 - SpecSoT-Rank1-Model - INFO - Generated Skeleton: #### 提高投篮命中率建议多角度分析与练习

1.  **技术方面**
    1.  #### 恒久性手枪握把螺丝助力提升球员进攻中球与手Gun之間的动态位置（80 tokens）：...
    2.  #### 能量的背板训练力，让我们的肩部给予足夠的弹力_ASS（130 tokens）：...
    3.  #### 合理构架的停留步，停在靶點下的傾斜UP持有尚未游戏U的三点性焦点CREATE！见敵()));
##  [增加体能方面](#### 体能
[parse_skeleton_str] Found 2 branches
  Branch 1: #### 恒久性手枪握把螺丝助力提升球员进攻中球与手Gun之間的动态位置【80】:... (predicted length: 80)
  Branch 2: #### 能量的背板训练力，让我们的肩部给予足夠的弹力_ASS【130】:... (predicted length: 130)
2026-01-23 14:49:30 - SpecSoT-Rank1-Model - INFO - Detected 2 parallel branches with predicted lengths: [80, 130]
Traceback (most recent call last):
  File "/data/home/chenyu/Coding/SD+SoT/Speculative-Decoding-Enabled-Skeleton-of-Thought/run_specsot.py", line 725, in <module>
    main()
  File "/data/home/chenyu/Coding/SD+SoT/Speculative-Decoding-Enabled-Skeleton-of-Thought/run_specsot.py", line 715, in main
    run_worker(args)
  File "/data/home/chenyu/Coding/SD+SoT/Speculative-Decoding-Enabled-Skeleton-of-Thought/run_specsot.py", line 379, in run_worker
    model.generate(
  File "/data/home/chenyu/anaconda3/envs/sdsot/lib/python3.9/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/data/home/chenyu/Coding/SD+SoT/Speculative-Decoding-Enabled-Skeleton-of-Thought/SpecSoT/specsot_model.py", line 475, in generate
    return self.generate_specsot(
  File "/data/home/chenyu/Coding/SD+SoT/Speculative-Decoding-Enabled-Skeleton-of-Thought/SpecSoT/specsot_model.py", line 707, in generate_specsot
    self.prefill_parallel(
  File "/data/home/chenyu/Coding/SD+SoT/Speculative-Decoding-Enabled-Skeleton-of-Thought/SpecSoT/specsot_model.py", line 921, in prefill_parallel
    outputs, hidden_states = self(
  File "/data/home/chenyu/anaconda3/envs/sdsot/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/data/home/chenyu/anaconda3/envs/sdsot/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/data/home/chenyu/Coding/SD+SoT/Speculative-Decoding-Enabled-Skeleton-of-Thought/SpecSoT/specsot_model.py", line 410, in forward
    outputs = self.base_model.model(
  File "/data/home/chenyu/anaconda3/envs/sdsot/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/data/home/chenyu/anaconda3/envs/sdsot/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/data/home/chenyu/Coding/SD+SoT/Speculative-Decoding-Enabled-Skeleton-of-Thought/SpecSoT/modeling_llama_kv.py", line 1116, in forward
    attention_mask = self._prepare_decoder_attention_mask(
  File "/data/home/chenyu/Coding/SD+SoT/Speculative-Decoding-Enabled-Skeleton-of-Thought/SpecSoT/modeling_llama_kv.py", line 1027, in _prepare_decoder_attention_mask
    expanded_attn_mask = _expand_mask(
  File "/data/home/chenyu/Coding/SD+SoT/Speculative-Decoding-Enabled-Skeleton-of-Thought/SpecSoT/modeling_llama_kv.py", line 90, in _expand_mask
    bsz, src_len = mask.size()
ValueError: too many values to unpack (expected 2)
24.224 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=25 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.226 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=26 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.226 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=26 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.229 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=27 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.229 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=27 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.229 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:377] -   [PHASE 2] 完成 | layers=14, cache_sent=28, eagle_hidden_sent=1 | 耗时: 250.31ms
2026-01-23 14:49:24.229 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:387] -   [PHASE 3][SEND] Hidden States -> Rank 2
2026-01-23 14:49:24.229 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:393] -     Hidden States 发送完成 | shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB
2026-01-23 14:49:24.229 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:496] -   [PHASE 3] 完成 | 耗时: 0.08ms
2026-01-23 14:49:24.229 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=0, chunk=0 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.230 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=1, chunk=0 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.230 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=2, chunk=0 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.230 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=3, chunk=0 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.230 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=4, chunk=0 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.230 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=5, chunk=0 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.231 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=6, chunk=0 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.231 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=7, chunk=0 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.231 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=8, chunk=0 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.231 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=9, chunk=0 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.231 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=10, chunk=0 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.231 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=11, chunk=0 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.231 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=12, chunk=0 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.231 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=13, chunk=0 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.231 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=0, chunk=1 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.231 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=1, chunk=1 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.231 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=2, chunk=1 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.231 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=3, chunk=1 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.231 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=4, chunk=1 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.231 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=5, chunk=1 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.231 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=6, chunk=1 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.231 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=7, chunk=1 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.232 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=8, chunk=1 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.232 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=9, chunk=1 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.232 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=10, chunk=1 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.232 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=11, chunk=1 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.232 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=12, chunk=1 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.233 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=13, chunk=1 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.233 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=0, chunk=2 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.233 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=1, chunk=2 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.233 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=2, chunk=2 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.233 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=3, chunk=2 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.233 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=4, chunk=2 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.234 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=5, chunk=2 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.234 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=6, chunk=2 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.234 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=7, chunk=2 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.234 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=8, chunk=2 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.234 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=9, chunk=2 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.234 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=10, chunk=2 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.234 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=11, chunk=2 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.234 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=12, chunk=2 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.235 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=13, chunk=2 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.235 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=0, chunk=3 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.235 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=1, chunk=3 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.235 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=2, chunk=3 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.235 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=3, chunk=3 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.236 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=4, chunk=3 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.236 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=5, chunk=3 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.236 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=6, chunk=3 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.236 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=7, chunk=3 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.236 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=8, chunk=3 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.237 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=9, chunk=3 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.237 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=10, chunk=3 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.237 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=11, chunk=3 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.237 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=12, chunk=3 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.237 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=13, chunk=3 from Rank 0 | size=0.50MB
2026-01-23 14:49:24.237 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=0, chunk=4 from Rank 0 | size=0.41MB
2026-01-23 14:49:24.237 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=1, chunk=4 from Rank 0 | size=0.41MB
2026-01-23 14:49:24.237 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=2, chunk=4 from Rank 0 | size=0.41MB
2026-01-23 14:49:24.238 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=3, chunk=4 from Rank 0 | size=0.41MB
2026-01-23 14:49:24.238 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=4, chunk=4 from Rank 0 | size=0.41MB
2026-01-23 14:49:24.238 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=5, chunk=4 from Rank 0 | size=0.41MB
2026-01-23 14:49:24.238 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=6, chunk=4 from Rank 0 | size=0.41MB
2026-01-23 14:49:24.238 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=7, chunk=4 from Rank 0 | size=0.41MB
2026-01-23 14:49:24.238 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=8, chunk=4 from Rank 0 | size=0.41MB
2026-01-23 14:49:24.238 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=9, chunk=4 from Rank 0 | size=0.41MB
2026-01-23 14:49:24.239 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=10, chunk=4 from Rank 0 | size=0.41MB
2026-01-23 14:49:24.239 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=11, chunk=4 from Rank 0 | size=0.41MB
2026-01-23 14:49:24.239 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=12, chunk=4 from Rank 0 | size=0.41MB
2026-01-23 14:49:24.239 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:660] -   [RECV][CACHE] layer=13, chunk=4 from Rank 0 | size=0.41MB
2026-01-23 14:49:24.240 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:663] -   [CACHE] 非阻塞接收 70 个 Base Cache
2026-01-23 14:49:24.240 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:502] - [CHUNK 1/5] 完成 | 总耗时: 262.37ms
2026-01-23 14:49:24.240 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:230] - [CHUNK 2/5] 开始处理 | seq_len=128, first=False, last=False
2026-01-23 14:49:24.240 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:245] -   [PHASE 1] 等待接收 Hidden States (from Rank 0)...
2026-01-23 14:49:24.241 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:254] -   [PHASE 1][RECV] Hidden States | shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB | chunk_idx=1
2026-01-23 14:49:24.241 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:257] -   [PHASE 1] 完成 | 耗时: 0.18ms
2026-01-23 14:49:24.241 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:263] -   [PHASE 2] 开始计算 Decoder Layers [14, 28)
2026-01-23 14:49:24.241 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:271] -     past_key_values_length=128, seq_with_past=256
2026-01-23 14:49:24.244 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=14 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.245 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=14 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.247 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:352] -     [SEND][EAGLE] hidden state layer=15, chunk=1 -> Rank 2
2026-01-23 14:49:24.247 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=15 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.247 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=15 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.251 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=16 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.251 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=16 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.254 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=17 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.254 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=17 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.257 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=18 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.258 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=18 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.261 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=19 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.261 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=19 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.265 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=20 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.265 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=20 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.268 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=21 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.268 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=21 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.272 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=22 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.272 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=22 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.276 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=23 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.276 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=23 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.278 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=24 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.279 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=24 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.281 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=25 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.282 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=25 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.284 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=26 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.285 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=26 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.287 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=27 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.287 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=27 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.287 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:377] -   [PHASE 2] 完成 | layers=14, cache_sent=28, eagle_hidden_sent=1 | 耗时: 46.83ms
2026-01-23 14:49:24.287 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:387] -   [PHASE 3][SEND] Hidden States -> Rank 2
2026-01-23 14:49:24.288 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:393] -     Hidden States 发送完成 | shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB
2026-01-23 14:49:24.288 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:496] -   [PHASE 3] 完成 | 耗时: 0.12ms
2026-01-23 14:49:24.289 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:502] - [CHUNK 2/5] 完成 | 总耗时: 48.30ms
2026-01-23 14:49:24.289 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:230] - [CHUNK 3/5] 开始处理 | seq_len=128, first=False, last=False
2026-01-23 14:49:24.289 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:245] -   [PHASE 1] 等待接收 Hidden States (from Rank 0)...
2026-01-23 14:49:24.289 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:254] -   [PHASE 1][RECV] Hidden States | shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB | chunk_idx=2
2026-01-23 14:49:24.289 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:257] -   [PHASE 1] 完成 | 耗时: 0.22ms
2026-01-23 14:49:24.289 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:263] -   [PHASE 2] 开始计算 Decoder Layers [14, 28)
2026-01-23 14:49:24.289 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:271] -     past_key_values_length=256, seq_with_past=384
2026-01-23 14:49:24.292 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=14 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.293 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=14 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.295 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:352] -     [SEND][EAGLE] hidden state layer=15, chunk=2 -> Rank 2
2026-01-23 14:49:24.296 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=15 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.296 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=15 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.298 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=16 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.299 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=16 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.301 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=17 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.302 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=17 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.305 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=18 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.305 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=18 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.308 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=19 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.308 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=19 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.311 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=20 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.311 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=20 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.316 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=21 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.316 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=21 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.319 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=22 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.320 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=22 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.323 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=23 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.323 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=23 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.326 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=24 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.326 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=24 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.329 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=25 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.330 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=25 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.333 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=26 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.333 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=26 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.336 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=27 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.337 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=27 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.337 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:377] -   [PHASE 2] 完成 | layers=14, cache_sent=28, eagle_hidden_sent=1 | 耗时: 47.84ms
2026-01-23 14:49:24.337 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:387] -   [PHASE 3][SEND] Hidden States -> Rank 2
2026-01-23 14:49:24.337 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:393] -     Hidden States 发送完成 | shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB
2026-01-23 14:49:24.337 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:496] -   [PHASE 3] 完成 | 耗时: 0.19ms
2026-01-23 14:49:24.338 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:502] - [CHUNK 3/5] 完成 | 总耗时: 49.48ms
2026-01-23 14:49:24.338 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:230] - [CHUNK 4/5] 开始处理 | seq_len=128, first=False, last=False
2026-01-23 14:49:24.338 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:245] -   [PHASE 1] 等待接收 Hidden States (from Rank 0)...
2026-01-23 14:49:24.338 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:254] -   [PHASE 1][RECV] Hidden States | shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB | chunk_idx=3
2026-01-23 14:49:24.338 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:257] -   [PHASE 1] 完成 | 耗时: 0.20ms
2026-01-23 14:49:24.339 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:263] -   [PHASE 2] 开始计算 Decoder Layers [14, 28)
2026-01-23 14:49:24.339 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:271] -     past_key_values_length=384, seq_with_past=512
2026-01-23 14:49:24.342 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=14 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.343 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=14 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.346 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:352] -     [SEND][EAGLE] hidden state layer=15, chunk=3 -> Rank 2
2026-01-23 14:49:24.346 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=15 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.346 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=15 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.350 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=16 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.350 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=16 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.353 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=17 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.354 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=17 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.357 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=18 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.357 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=18 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.361 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=19 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.361 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=19 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.364 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=20 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.365 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=20 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.367 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=21 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.368 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=21 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.371 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=22 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.371 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=22 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.374 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=23 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.375 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=23 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.378 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=24 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.378 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=24 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.381 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=25 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.381 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=25 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.384 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=26 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.385 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=26 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.388 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=27 -> Rank 0 | size=0.50MB
2026-01-23 14:49:24.388 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=27 -> Rank 2 | size=0.50MB
2026-01-23 14:49:24.388 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:377] -   [PHASE 2] 完成 | layers=14, cache_sent=28, eagle_hidden_sent=1 | 耗时: 49.86ms
2026-01-23 14:49:24.388 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:387] -   [PHASE 3][SEND] Hidden States -> Rank 2
2026-01-23 14:49:24.389 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:393] -     Hidden States 发送完成 | shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB
2026-01-23 14:49:24.389 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:496] -   [PHASE 3] 完成 | 耗时: 0.39ms
2026-01-23 14:49:24.390 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:502] - [CHUNK 4/5] 完成 | 总耗时: 51.69ms
2026-01-23 14:49:24.390 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:230] - [CHUNK 5/5] 开始处理 | seq_len=104, first=False, last=True
2026-01-23 14:49:24.390 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:245] -   [PHASE 1] 等待接收 Hidden States (from Rank 0)...
2026-01-23 14:49:24.390 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:254] -   [PHASE 1][RECV] Hidden States | shape=(1, 104, 4096), dtype=float16, device=cuda:0, size=0.812MB | chunk_idx=4
2026-01-23 14:49:24.390 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:257] -   [PHASE 1] 完成 | 耗时: 0.19ms
2026-01-23 14:49:24.390 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:263] -   [PHASE 2] 开始计算 Decoder Layers [14, 28)
2026-01-23 14:49:24.390 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:271] -     past_key_values_length=512, seq_with_past=616
2026-01-23 14:49:24.394 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=14 -> Rank 0 | size=0.41MB
2026-01-23 14:49:24.394 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=14 -> Rank 2 | size=0.41MB
2026-01-23 14:49:24.397 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:352] -     [SEND][EAGLE] hidden state layer=15, chunk=4 -> Rank 2
2026-01-23 14:49:24.398 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=15 -> Rank 0 | size=0.41MB
2026-01-23 14:49:24.398 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=15 -> Rank 2 | size=0.41MB
2026-01-23 14:49:24.401 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=16 -> Rank 0 | size=0.41MB
2026-01-23 14:49:24.402 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=16 -> Rank 2 | size=0.41MB
2026-01-23 14:49:24.405 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=17 -> Rank 0 | size=0.41MB
2026-01-23 14:49:24.405 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=17 -> Rank 2 | size=0.41MB
2026-01-23 14:49:24.408 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=18 -> Rank 0 | size=0.41MB
2026-01-23 14:49:24.409 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=18 -> Rank 2 | size=0.41MB
2026-01-23 14:49:24.412 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=19 -> Rank 0 | size=0.41MB
2026-01-23 14:49:24.412 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=19 -> Rank 2 | size=0.41MB
2026-01-23 14:49:24.415 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=20 -> Rank 0 | size=0.41MB
2026-01-23 14:49:24.415 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=20 -> Rank 2 | size=0.41MB
2026-01-23 14:49:24.418 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=21 -> Rank 0 | size=0.41MB
2026-01-23 14:49:24.419 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=21 -> Rank 2 | size=0.41MB
2026-01-23 14:49:24.422 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=22 -> Rank 0 | size=0.41MB
2026-01-23 14:49:24.422 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=22 -> Rank 2 | size=0.41MB
2026-01-23 14:49:24.425 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=23 -> Rank 0 | size=0.41MB
2026-01-23 14:49:24.425 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=23 -> Rank 2 | size=0.41MB
2026-01-23 14:49:24.428 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=24 -> Rank 0 | size=0.41MB
2026-01-23 14:49:24.429 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=24 -> Rank 2 | size=0.41MB
2026-01-23 14:49:24.432 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=25 -> Rank 0 | size=0.41MB
2026-01-23 14:49:24.432 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=25 -> Rank 2 | size=0.41MB
2026-01-23 14:49:24.435 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=26 -> Rank 0 | size=0.41MB
2026-01-23 14:49:24.436 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=26 -> Rank 2 | size=0.41MB
2026-01-23 14:49:24.439 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=27 -> Rank 0 | size=0.41MB
2026-01-23 14:49:24.439 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:371] -     [SEND][CACHE] layer=27 -> Rank 2 | size=0.41MB
2026-01-23 14:49:24.439 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:377] -   [PHASE 2] 完成 | layers=14, cache_sent=28, eagle_hidden_sent=1 | 耗时: 49.13ms
2026-01-23 14:49:24.440 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:387] -   [PHASE 3][SEND] Hidden States -> Rank 2
2026-01-23 14:49:24.440 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:393] -     Hidden States 发送完成 | shape=(1, 104, 4096), dtype=float16, device=cuda:0, size=0.812MB
2026-01-23 14:49:24.440 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:496] -   [PHASE 3] 完成 | 耗时: 0.42ms
2026-01-23 14:49:24.441 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:502] - [CHUNK 5/5] 完成 | 总耗时: 51.11ms
2026-01-23 14:49:24.441 - SpecSoT-Rank1 - INFO - [distributed_prefill.py:507] - [PREFILL] Chunks处理完成，开始 Cache 同步...
2026-01-23 14:49:24.441 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:513] - [RECV] 等待 Draft Tokens (from Rank 2)...
2026-01-23 14:49:25.431 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:524] - [RECV] Draft Tokens 接收完成 | shape=torch.Size([1, 40]) | 耗时: 989.78ms
2026-01-23 14:49:25.431 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:527] - [SYNC] 等待所有 Cache 同步...
2026-01-23 14:49:25.438 - SpecSoT-Rank1 - DEBUG - [distributed_prefill.py:545] - [SYNC_OK] Rank 1 Cache 同步完成 | 耗时: 6.21ms
2026-01-23 14:49:25.438 - SpecSoT-Rank1 - INFO - [distributed_prefill.py:554] - [PREFILL] 分布式 Prefill 完成 | Rank=1 | 耗时: 1.461s
oT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=21, layer_idx=23, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.31ms
2026-01-23 14:49:24.235 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=22, layer_idx=24, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.29ms
2026-01-23 14:49:24.236 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=23, layer_idx=24, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.31ms
2026-01-23 14:49:24.237 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=24, layer_idx=25, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.29ms
2026-01-23 14:49:24.239 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=25, layer_idx=25, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.32ms
2026-01-23 14:49:24.240 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=26, layer_idx=26, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.10ms
2026-01-23 14:49:24.240 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:430] - [WAIT] 等待接收 HIDDEN (src_rank=0, timeout=60.0s)
2026-01-23 14:49:24.240 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:448] - [RECV_OK] HIDDEN 接收成功 | from rank 0, chunk_idx=1, wait_time=0.10ms
2026-01-23 14:49:24.241 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:453] -   hidden: shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB
2026-01-23 14:49:24.242 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=27, layer_idx=26, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.19ms
2026-01-23 14:49:24.243 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=28, layer_idx=27, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.10ms
2026-01-23 14:49:24.244 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=14, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.245 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=14, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.245 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=29, layer_idx=27, chunk_idx=0, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.46ms
2026-01-23 14:49:24.246 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=31, layer_idx=14, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.09ms
2026-01-23 14:49:24.246 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:258] - [QUEUE] EAGLE_INPUT_HIDDEN -> rank 2 | layer_idx=15, chunk_idx=1
2026-01-23 14:49:24.247 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:262] -   hidden: shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB
2026-01-23 14:49:24.247 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=15, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.247 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=15, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.247 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=32, layer_idx=14, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.44ms
2026-01-23 14:49:24.250 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:137] - [SEND] EAGLE_INPUT_HIDDEN -> rank 2 | seq_id=33, layer_idx=15, size=1025.38KB, time=2.35ms
2026-01-23 14:49:24.250 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:142] -   hidden: shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB
2026-01-23 14:49:24.251 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=16, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.251 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=16, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.252 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=34, layer_idx=15, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.57ms
2026-01-23 14:49:24.253 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=35, layer_idx=15, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.13ms
2026-01-23 14:49:24.254 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=17, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.254 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=17, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.254 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=36, layer_idx=16, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.44ms
2026-01-23 14:49:24.256 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=37, layer_idx=16, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.28ms
2026-01-23 14:49:24.257 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=18, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.258 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=18, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.258 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=38, layer_idx=17, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.73ms
2026-01-23 14:49:24.259 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=39, layer_idx=17, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.36ms
2026-01-23 14:49:24.261 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=19, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.261 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=40, layer_idx=18, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.45ms
2026-01-23 14:49:24.261 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=19, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.263 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=41, layer_idx=18, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.43ms
2026-01-23 14:49:24.264 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=42, layer_idx=19, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.31ms
2026-01-23 14:49:24.265 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=20, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.265 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=20, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.266 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=43, layer_idx=19, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.72ms
2026-01-23 14:49:24.267 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=44, layer_idx=20, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.35ms
2026-01-23 14:49:24.268 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=21, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.268 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=21, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.269 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=45, layer_idx=20, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.59ms
2026-01-23 14:49:24.271 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=46, layer_idx=21, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.42ms
2026-01-23 14:49:24.272 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=22, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.272 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=22, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.272 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=47, layer_idx=21, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.53ms
2026-01-23 14:49:24.274 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=48, layer_idx=22, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.54ms
2026-01-23 14:49:24.275 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=23, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.276 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=49, layer_idx=22, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.26ms
2026-01-23 14:49:24.276 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=23, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.277 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=50, layer_idx=23, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.19ms
2026-01-23 14:49:24.278 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=24, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.279 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=51, layer_idx=23, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.27ms
2026-01-23 14:49:24.279 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=24, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.280 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=52, layer_idx=24, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.10ms
2026-01-23 14:49:24.281 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=53, layer_idx=24, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.11ms
2026-01-23 14:49:24.281 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=25, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.281 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=25, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.283 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=54, layer_idx=25, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.38ms
2026-01-23 14:49:24.284 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=26, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.284 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=55, layer_idx=25, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.25ms
2026-01-23 14:49:24.285 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=26, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.286 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=56, layer_idx=26, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.10ms
2026-01-23 14:49:24.287 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=57, layer_idx=26, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.10ms
2026-01-23 14:49:24.287 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=27, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.287 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=27, chunk_idx=1, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.287 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:231] - [QUEUE] HIDDEN -> rank 2 | chunk_idx=1
2026-01-23 14:49:24.287 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:235] -   hidden: shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB
2026-01-23 14:49:24.289 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=58, layer_idx=27, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.32ms
2026-01-23 14:49:24.289 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:430] - [WAIT] 等待接收 HIDDEN (src_rank=0, timeout=60.0s)
2026-01-23 14:49:24.289 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:448] - [RECV_OK] HIDDEN 接收成功 | from rank 0, chunk_idx=2, wait_time=0.11ms
2026-01-23 14:49:24.289 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:453] -   hidden: shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB
2026-01-23 14:49:24.291 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:128] - [SEND] HIDDEN -> rank 2 | seq_id=60, chunk_idx=1, size=1025.38KB, time=1.41ms
2026-01-23 14:49:24.291 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:133] -   hidden: shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB
2026-01-23 14:49:24.292 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=59, layer_idx=27, chunk_idx=1, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.13ms
2026-01-23 14:49:24.292 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=14, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.292 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=14, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.294 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=61, layer_idx=14, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.32ms
2026-01-23 14:49:24.295 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=62, layer_idx=14, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.16ms
2026-01-23 14:49:24.295 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:258] - [QUEUE] EAGLE_INPUT_HIDDEN -> rank 2 | layer_idx=15, chunk_idx=2
2026-01-23 14:49:24.295 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:262] -   hidden: shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB
2026-01-23 14:49:24.296 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=15, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.296 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=15, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.297 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:137] - [SEND] EAGLE_INPUT_HIDDEN -> rank 2 | seq_id=63, layer_idx=15, size=1025.38KB, time=1.34ms
2026-01-23 14:49:24.297 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:142] -   hidden: shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB
2026-01-23 14:49:24.298 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=16, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.298 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=16, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.298 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=64, layer_idx=15, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.39ms
2026-01-23 14:49:24.300 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=65, layer_idx=15, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.14ms
2026-01-23 14:49:24.301 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=17, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.301 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=66, layer_idx=16, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.32ms
2026-01-23 14:49:24.301 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=17, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.303 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=67, layer_idx=16, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.12ms
2026-01-23 14:49:24.304 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=68, layer_idx=17, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.11ms
2026-01-23 14:49:24.304 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=18, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.305 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=18, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.306 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=69, layer_idx=17, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.60ms
2026-01-23 14:49:24.307 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=70, layer_idx=18, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.13ms
2026-01-23 14:49:24.308 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=19, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.308 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=19, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.308 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=71, layer_idx=18, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.41ms
2026-01-23 14:49:24.310 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=72, layer_idx=19, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.10ms
2026-01-23 14:49:24.311 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=20, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.311 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=73, layer_idx=19, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.33ms
2026-01-23 14:49:24.311 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=20, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.314 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=74, layer_idx=20, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=2.36ms
2026-01-23 14:49:24.315 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=75, layer_idx=20, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.19ms
2026-01-23 14:49:24.315 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=21, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.316 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=21, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.317 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=76, layer_idx=21, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.30ms
2026-01-23 14:49:24.318 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=77, layer_idx=21, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.17ms
2026-01-23 14:49:24.319 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=22, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.319 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=22, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.321 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=78, layer_idx=22, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.31ms
2026-01-23 14:49:24.322 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=79, layer_idx=22, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.12ms
2026-01-23 14:49:24.322 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=23, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.323 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=23, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.324 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=80, layer_idx=23, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.27ms
2026-01-23 14:49:24.325 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=81, layer_idx=23, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.11ms
2026-01-23 14:49:24.326 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=24, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.326 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=24, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.327 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=82, layer_idx=24, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.29ms
2026-01-23 14:49:24.329 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=83, layer_idx=24, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.14ms
2026-01-23 14:49:24.329 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=25, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.330 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=25, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.331 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=84, layer_idx=25, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.23ms
2026-01-23 14:49:24.332 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=85, layer_idx=25, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.12ms
2026-01-23 14:49:24.333 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=26, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.333 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=26, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.334 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=86, layer_idx=26, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.27ms
2026-01-23 14:49:24.336 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=87, layer_idx=26, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.11ms
2026-01-23 14:49:24.336 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=27, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.337 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=27, chunk_idx=2, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.337 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:231] - [QUEUE] HIDDEN -> rank 2 | chunk_idx=2
2026-01-23 14:49:24.337 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:235] -   hidden: shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB
2026-01-23 14:49:24.338 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=88, layer_idx=27, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.47ms
2026-01-23 14:49:24.338 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:430] - [WAIT] 等待接收 HIDDEN (src_rank=0, timeout=60.0s)
2026-01-23 14:49:24.338 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:448] - [RECV_OK] HIDDEN 接收成功 | from rank 0, chunk_idx=3, wait_time=0.05ms
2026-01-23 14:49:24.338 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:453] -   hidden: shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB
2026-01-23 14:49:24.339 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:128] - [SEND] HIDDEN -> rank 2 | seq_id=90, chunk_idx=2, size=1025.38KB, time=1.34ms
2026-01-23 14:49:24.339 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:133] -   hidden: shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB
2026-01-23 14:49:24.341 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=89, layer_idx=27, chunk_idx=2, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.37ms
2026-01-23 14:49:24.342 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=14, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.343 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=14, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.344 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=91, layer_idx=14, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.29ms
2026-01-23 14:49:24.345 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=92, layer_idx=14, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.13ms
2026-01-23 14:49:24.345 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:258] - [QUEUE] EAGLE_INPUT_HIDDEN -> rank 2 | layer_idx=15, chunk_idx=3
2026-01-23 14:49:24.346 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:262] -   hidden: shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB
2026-01-23 14:49:24.346 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=15, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.346 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=15, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.347 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:137] - [SEND] EAGLE_INPUT_HIDDEN -> rank 2 | seq_id=93, layer_idx=15, size=1025.38KB, time=1.34ms
2026-01-23 14:49:24.347 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:142] -   hidden: shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB
2026-01-23 14:49:24.348 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=94, layer_idx=15, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.18ms
2026-01-23 14:49:24.350 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=16, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.350 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=95, layer_idx=15, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.36ms
2026-01-23 14:49:24.350 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=16, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.351 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=96, layer_idx=16, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.14ms
2026-01-23 14:49:24.353 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=97, layer_idx=16, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.06ms
2026-01-23 14:49:24.353 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=17, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.354 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=17, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.355 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=98, layer_idx=17, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.22ms
2026-01-23 14:49:24.356 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=99, layer_idx=17, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.11ms
2026-01-23 14:49:24.357 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=18, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.357 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=18, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.358 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=100, layer_idx=18, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.66ms
2026-01-23 14:49:24.360 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=101, layer_idx=18, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.16ms
2026-01-23 14:49:24.360 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=19, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.361 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=19, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.362 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=102, layer_idx=19, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.26ms
2026-01-23 14:49:24.363 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=103, layer_idx=19, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.15ms
2026-01-23 14:49:24.364 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=20, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.364 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=20, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.366 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=104, layer_idx=20, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.40ms
2026-01-23 14:49:24.367 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=105, layer_idx=20, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.12ms
2026-01-23 14:49:24.367 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=21, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.368 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=21, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.369 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=106, layer_idx=21, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.32ms
2026-01-23 14:49:24.370 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=107, layer_idx=21, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.13ms
2026-01-23 14:49:24.371 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=22, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.371 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=22, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.372 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=108, layer_idx=22, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.28ms
2026-01-23 14:49:24.374 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=109, layer_idx=22, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.14ms
2026-01-23 14:49:24.374 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=23, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.375 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=23, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.376 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=110, layer_idx=23, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.29ms
2026-01-23 14:49:24.377 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=111, layer_idx=23, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.13ms
2026-01-23 14:49:24.378 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=24, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.378 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=24, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.379 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=112, layer_idx=24, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.30ms
2026-01-23 14:49:24.380 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=113, layer_idx=24, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.15ms
2026-01-23 14:49:24.381 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=25, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.381 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=25, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.382 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=114, layer_idx=25, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.27ms
2026-01-23 14:49:24.384 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=115, layer_idx=25, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.15ms
2026-01-23 14:49:24.384 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=26, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.385 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=26, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.386 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=116, layer_idx=26, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.25ms
2026-01-23 14:49:24.387 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=117, layer_idx=26, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.15ms
2026-01-23 14:49:24.388 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=27, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.388 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=27, chunk_idx=3, key_shape=(1, 8, 128, 128)
2026-01-23 14:49:24.389 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:231] - [QUEUE] HIDDEN -> rank 2 | chunk_idx=3
2026-01-23 14:49:24.389 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:235] -   hidden: shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB
2026-01-23 14:49:24.389 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=118, layer_idx=27, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.48ms
2026-01-23 14:49:24.390 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:430] - [WAIT] 等待接收 HIDDEN (src_rank=0, timeout=60.0s)
2026-01-23 14:49:24.390 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:448] - [RECV_OK] HIDDEN 接收成功 | from rank 0, chunk_idx=4, wait_time=0.05ms
2026-01-23 14:49:24.390 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:453] -   hidden: shape=(1, 104, 4096), dtype=float16, device=cuda:0, size=0.812MB
2026-01-23 14:49:24.391 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:128] - [SEND] HIDDEN -> rank 2 | seq_id=120, chunk_idx=3, size=1025.38KB, time=1.31ms
2026-01-23 14:49:24.391 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:133] -   hidden: shape=(1, 128, 4096), dtype=float16, device=cuda:0, size=1.000MB
2026-01-23 14:49:24.392 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=119, layer_idx=27, chunk_idx=3, key_shape=(1, 8, 128, 128), size=514.60KB, time=1.08ms
2026-01-23 14:49:24.394 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=14, chunk_idx=4, key_shape=(1, 8, 104, 128)
2026-01-23 14:49:24.394 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=14, chunk_idx=4, key_shape=(1, 8, 104, 128)
2026-01-23 14:49:24.395 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=121, layer_idx=14, chunk_idx=4, key_shape=(1, 8, 104, 128), size=418.60KB, time=1.20ms
2026-01-23 14:49:24.396 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=122, layer_idx=14, chunk_idx=4, key_shape=(1, 8, 104, 128), size=418.60KB, time=1.05ms
2026-01-23 14:49:24.397 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:258] - [QUEUE] EAGLE_INPUT_HIDDEN -> rank 2 | layer_idx=15, chunk_idx=4
2026-01-23 14:49:24.397 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:262] -   hidden: shape=(1, 104, 4096), dtype=float16, device=cuda:0, size=0.812MB
2026-01-23 14:49:24.398 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=15, chunk_idx=4, key_shape=(1, 8, 104, 128)
2026-01-23 14:49:24.398 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=15, chunk_idx=4, key_shape=(1, 8, 104, 128)
2026-01-23 14:49:24.399 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:137] - [SEND] EAGLE_INPUT_HIDDEN -> rank 2 | seq_id=123, layer_idx=15, size=833.38KB, time=1.23ms
2026-01-23 14:49:24.399 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:142] -   hidden: shape=(1, 104, 4096), dtype=float16, device=cuda:0, size=0.812MB
2026-01-23 14:49:24.400 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=124, layer_idx=15, chunk_idx=4, key_shape=(1, 8, 104, 128), size=418.60KB, time=1.05ms
2026-01-23 14:49:24.401 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=125, layer_idx=15, chunk_idx=4, key_shape=(1, 8, 104, 128), size=418.60KB, time=1.04ms
2026-01-23 14:49:24.401 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=16, chunk_idx=4, key_shape=(1, 8, 104, 128)
2026-01-23 14:49:24.402 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=16, chunk_idx=4, key_shape=(1, 8, 104, 128)
2026-01-23 14:49:24.403 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=126, layer_idx=16, chunk_idx=4, key_shape=(1, 8, 104, 128), size=418.60KB, time=1.48ms
2026-01-23 14:49:24.404 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=127, layer_idx=16, chunk_idx=4, key_shape=(1, 8, 104, 128), size=418.60KB, time=1.09ms
2026-01-23 14:49:24.405 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=17, chunk_idx=4, key_shape=(1, 8, 104, 128)
2026-01-23 14:49:24.405 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=17, chunk_idx=4, key_shape=(1, 8, 104, 128)
2026-01-23 14:49:24.406 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=128, layer_idx=17, chunk_idx=4, key_shape=(1, 8, 104, 128), size=418.60KB, time=1.18ms
2026-01-23 14:49:24.407 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=129, layer_idx=17, chunk_idx=4, key_shape=(1, 8, 104, 128), size=418.60KB, time=1.06ms
2026-01-23 14:49:24.408 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=18, chunk_idx=4, key_shape=(1, 8, 104, 128)
2026-01-23 14:49:24.408 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=18, chunk_idx=4, key_shape=(1, 8, 104, 128)
2026-01-23 14:49:24.410 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=130, layer_idx=18, chunk_idx=4, key_shape=(1, 8, 104, 128), size=418.60KB, time=1.20ms
2026-01-23 14:49:24.411 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=131, layer_idx=18, chunk_idx=4, key_shape=(1, 8, 104, 128), size=418.60KB, time=1.06ms
2026-01-23 14:49:24.411 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=19, chunk_idx=4, key_shape=(1, 8, 104, 128)
2026-01-23 14:49:24.412 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=19, chunk_idx=4, key_shape=(1, 8, 104, 128)
2026-01-23 14:49:24.413 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=132, layer_idx=19, chunk_idx=4, key_shape=(1, 8, 104, 128), size=418.60KB, time=1.25ms
2026-01-23 14:49:24.414 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=133, layer_idx=19, chunk_idx=4, key_shape=(1, 8, 104, 128), size=418.60KB, time=1.08ms
2026-01-23 14:49:24.415 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=20, chunk_idx=4, key_shape=(1, 8, 104, 128)
2026-01-23 14:49:24.415 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=20, chunk_idx=4, key_shape=(1, 8, 104, 128)
2026-01-23 14:49:24.416 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=134, layer_idx=20, chunk_idx=4, key_shape=(1, 8, 104, 128), size=418.60KB, time=1.23ms
2026-01-23 14:49:24.418 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=135, layer_idx=20, chunk_idx=4, key_shape=(1, 8, 104, 128), size=418.60KB, time=1.05ms
2026-01-23 14:49:24.418 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=21, chunk_idx=4, key_shape=(1, 8, 104, 128)
2026-01-23 14:49:24.419 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=21, chunk_idx=4, key_shape=(1, 8, 104, 128)
2026-01-23 14:49:24.420 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=136, layer_idx=21, chunk_idx=4, key_shape=(1, 8, 104, 128), size=418.60KB, time=1.19ms
2026-01-23 14:49:24.421 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=137, layer_idx=21, chunk_idx=4, key_shape=(1, 8, 104, 128), size=418.60KB, time=1.05ms
2026-01-23 14:49:24.422 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=22, chunk_idx=4, key_shape=(1, 8, 104, 128)
2026-01-23 14:49:24.422 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=22, chunk_idx=4, key_shape=(1, 8, 104, 128)
2026-01-23 14:49:24.423 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=138, layer_idx=22, chunk_idx=4, key_shape=(1, 8, 104, 128), size=418.60KB, time=1.19ms
2026-01-23 14:49:24.424 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=139, layer_idx=22, chunk_idx=4, key_shape=(1, 8, 104, 128), size=418.60KB, time=1.08ms
2026-01-23 14:49:24.425 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=23, chunk_idx=4, key_shape=(1, 8, 104, 128)
2026-01-23 14:49:24.425 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=23, chunk_idx=4, key_shape=(1, 8, 104, 128)
2026-01-23 14:49:24.426 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=140, layer_idx=23, chunk_idx=4, key_shape=(1, 8, 104, 128), size=418.60KB, time=1.12ms
2026-01-23 14:49:24.427 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=141, layer_idx=23, chunk_idx=4, key_shape=(1, 8, 104, 128), size=418.60KB, time=1.00ms
2026-01-23 14:49:24.428 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=24, chunk_idx=4, key_shape=(1, 8, 104, 128)
2026-01-23 14:49:24.429 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=24, chunk_idx=4, key_shape=(1, 8, 104, 128)
2026-01-23 14:49:24.430 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=142, layer_idx=24, chunk_idx=4, key_shape=(1, 8, 104, 128), size=418.60KB, time=1.13ms
2026-01-23 14:49:24.431 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=143, layer_idx=24, chunk_idx=4, key_shape=(1, 8, 104, 128), size=418.60KB, time=1.02ms
2026-01-23 14:49:24.432 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=25, chunk_idx=4, key_shape=(1, 8, 104, 128)
2026-01-23 14:49:24.432 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=25, chunk_idx=4, key_shape=(1, 8, 104, 128)
2026-01-23 14:49:24.433 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=144, layer_idx=25, chunk_idx=4, key_shape=(1, 8, 104, 128), size=418.60KB, time=1.28ms
2026-01-23 14:49:24.435 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=145, layer_idx=25, chunk_idx=4, key_shape=(1, 8, 104, 128), size=418.60KB, time=1.09ms
2026-01-23 14:49:24.435 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=26, chunk_idx=4, key_shape=(1, 8, 104, 128)
2026-01-23 14:49:24.436 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=26, chunk_idx=4, key_shape=(1, 8, 104, 128)
2026-01-23 14:49:24.437 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=146, layer_idx=26, chunk_idx=4, key_shape=(1, 8, 104, 128), size=418.60KB, time=1.13ms
2026-01-23 14:49:24.438 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=147, layer_idx=26, chunk_idx=4, key_shape=(1, 8, 104, 128), size=418.60KB, time=1.03ms
2026-01-23 14:49:24.439 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 0 | layer_idx=27, chunk_idx=4, key_shape=(1, 8, 104, 128)
2026-01-23 14:49:24.439 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:286] - [QUEUE] BASE_CACHE -> rank 2 | layer_idx=27, chunk_idx=4, key_shape=(1, 8, 104, 128)
2026-01-23 14:49:24.440 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:231] - [QUEUE] HIDDEN -> rank 2 | chunk_idx=4
2026-01-23 14:49:24.440 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:235] -   hidden: shape=(1, 104, 4096), dtype=float16, device=cuda:0, size=0.812MB
2026-01-23 14:49:24.440 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 0 | seq_id=148, layer_idx=27, chunk_idx=4, key_shape=(1, 8, 104, 128), size=418.60KB, time=1.33ms
2026-01-23 14:49:24.441 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:370] - [WAIT] 等待接收 DRAFT_TOKENS (src_rank=2, timeout=60.0s)
2026-01-23 14:49:24.442 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:128] - [SEND] HIDDEN -> rank 2 | seq_id=150, chunk_idx=4, size=833.38KB, time=1.27ms
2026-01-23 14:49:24.442 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:133] -   hidden: shape=(1, 104, 4096), dtype=float16, device=cuda:0, size=0.812MB
2026-01-23 14:49:24.443 - SpecSoT-Rank1-Comm - DEBUG - [p2p_comm_manager.py:147] - [SEND] BASE_CACHE -> rank 2 | seq_id=149, layer_idx=27, chunk_idx=4, key_shape=(1, 8, 104, 128), size=418.60KB, time=0.92ms
2026-01-23 14:49:25.261 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 2 | layer_idx=28, chunk_idx=0, seq_id=2, latency=9.74ms
2026-01-23 14:49:25.261 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
  value: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
2026-01-23 14:49:25.270 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 2 | layer_idx=29, chunk_idx=0, seq_id=4, latency=4.49ms
2026-01-23 14:49:25.270 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
  value: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
2026-01-23 14:49:25.274 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 2 | layer_idx=30, chunk_idx=0, seq_id=6, latency=5.78ms
2026-01-23 14:49:25.274 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
  value: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
2026-01-23 14:49:25.283 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 2 | layer_idx=31, chunk_idx=0, seq_id=8, latency=11.13ms
2026-01-23 14:49:25.283 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
  value: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
2026-01-23 14:49:25.304 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:275] - [RECV] EAGLE_CACHE from rank 2 | chunk_idx=0, incremental=True, seq_id=10, latency=4.19ms
2026-01-23 14:49:25.304 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:279] -   key: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
  value: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
2026-01-23 14:49:25.315 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 2 | layer_idx=28, chunk_idx=1, seq_id=12, latency=3.80ms
2026-01-23 14:49:25.315 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
  value: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
2026-01-23 14:49:25.318 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 2 | layer_idx=29, chunk_idx=1, seq_id=14, latency=4.81ms
2026-01-23 14:49:25.318 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
  value: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
2026-01-23 14:49:25.322 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 2 | layer_idx=30, chunk_idx=1, seq_id=16, latency=5.92ms
2026-01-23 14:49:25.322 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
  value: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
2026-01-23 14:49:25.325 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 2 | layer_idx=31, chunk_idx=1, seq_id=18, latency=6.80ms
2026-01-23 14:49:25.325 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
  value: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
2026-01-23 14:49:25.328 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:275] - [RECV] EAGLE_CACHE from rank 2 | chunk_idx=1, incremental=True, seq_id=20, latency=5.47ms
2026-01-23 14:49:25.328 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:279] -   key: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
  value: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
2026-01-23 14:49:25.332 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 2 | layer_idx=28, chunk_idx=2, seq_id=22, latency=4.04ms
2026-01-23 14:49:25.332 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
  value: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
2026-01-23 14:49:25.335 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 2 | layer_idx=29, chunk_idx=2, seq_id=24, latency=4.88ms
2026-01-23 14:49:25.335 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
  value: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
2026-01-23 14:49:25.339 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 2 | layer_idx=30, chunk_idx=2, seq_id=26, latency=6.28ms
2026-01-23 14:49:25.339 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
  value: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
2026-01-23 14:49:25.343 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 2 | layer_idx=31, chunk_idx=2, seq_id=28, latency=7.80ms
2026-01-23 14:49:25.343 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
  value: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
2026-01-23 14:49:25.346 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:275] - [RECV] EAGLE_CACHE from rank 2 | chunk_idx=2, incremental=True, seq_id=30, latency=6.58ms
2026-01-23 14:49:25.346 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:279] -   key: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
  value: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
2026-01-23 14:49:25.350 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 2 | layer_idx=28, chunk_idx=3, seq_id=32, latency=5.45ms
2026-01-23 14:49:25.350 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
  value: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
2026-01-23 14:49:25.353 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 2 | layer_idx=29, chunk_idx=3, seq_id=34, latency=5.03ms
2026-01-23 14:49:25.353 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
  value: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
2026-01-23 14:49:25.356 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 2 | layer_idx=30, chunk_idx=3, seq_id=36, latency=5.56ms
2026-01-23 14:49:25.356 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
  value: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
2026-01-23 14:49:25.359 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 2 | layer_idx=31, chunk_idx=3, seq_id=38, latency=6.20ms
2026-01-23 14:49:25.359 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
  value: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
2026-01-23 14:49:25.362 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:275] - [RECV] EAGLE_CACHE from rank 2 | chunk_idx=3, incremental=True, seq_id=40, latency=4.52ms
2026-01-23 14:49:25.362 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:279] -   key: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
  value: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
2026-01-23 14:49:25.364 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 2 | layer_idx=28, chunk_idx=4, seq_id=42, latency=3.23ms
2026-01-23 14:49:25.365 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 104, 128), dtype=float16, device=cuda:0, size=0.203MB
  value: shape=(1, 8, 104, 128), dtype=float16, device=cuda:0, size=0.203MB
2026-01-23 14:49:25.367 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 2 | layer_idx=29, chunk_idx=4, seq_id=44, latency=3.59ms
2026-01-23 14:49:25.367 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 104, 128), dtype=float16, device=cuda:0, size=0.203MB
  value: shape=(1, 8, 104, 128), dtype=float16, device=cuda:0, size=0.203MB
2026-01-23 14:49:25.370 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 2 | layer_idx=30, chunk_idx=4, seq_id=46, latency=3.64ms
2026-01-23 14:49:25.370 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 104, 128), dtype=float16, device=cuda:0, size=0.203MB
  value: shape=(1, 8, 104, 128), dtype=float16, device=cuda:0, size=0.203MB
2026-01-23 14:49:25.382 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:259] - [RECV] BASE_CACHE from rank 2 | layer_idx=31, chunk_idx=4, seq_id=48, latency=13.31ms
2026-01-23 14:49:25.382 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:263] -   key: shape=(1, 8, 104, 128), dtype=float16, device=cuda:0, size=0.203MB
  value: shape=(1, 8, 104, 128), dtype=float16, device=cuda:0, size=0.203MB
2026-01-23 14:49:25.430 - SpecSoT-Rank1-Comm - INFO - [base_comm_manager.py:223] - [RECV] DRAFT_TOKENS from rank 2 | seq_id=52, latency=3.42ms
2026-01-23 14:49:25.430 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:227] -   draft_tokens: shape=(1, 40), dtype=int64, device=cpu, size=0.000MB
  retrieve_indices: shape=(1, 33, 3), dtype=int64, device=cpu, size=0.001MB
  tree_mask: shape=(1, 1, 40, 40), dtype=float32, device=cpu, size=0.006MB
  tree_position_ids: shape=(1, 40), dtype=int64, device=cpu, size=0.000MB
2026-01-23 14:49:25.430 - SpecSoT-Rank1-Comm - INFO - [base_comm_manager.py:395] - [RECV_OK] DRAFT_TOKENS 接收成功 | from rank 2, wait_time=989.15ms, draft_tokens shape=(1, 40)
2026-01-23 14:49:25.432 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:275] - [RECV] EAGLE_CACHE from rank 2 | chunk_idx=4, incremental=True, seq_id=50, latency=5.38ms
2026-01-23 14:49:25.432 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:279] -   key: shape=(1, 8, 104, 128), dtype=float16, device=cuda:0, size=0.203MB
  value: shape=(1, 8, 104, 128), dtype=float16, device=cuda:0, size=0.203MB
2026-01-23 14:49:25.433 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:776] - [WAIT] 等待接收所有 Cache | expected_base_caches=20, expected_eagle_caches=5, my_layer_range=[14, 28), timeout=60.0s
2026-01-23 14:49:25.433 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:781] -   待接收的 base cache: [(0, 28), (0, 29), (0, 30), (0, 31), (1, 28), (1, 29), (1, 30), (1, 31), (2, 28), (2, 29), (2, 30), (2, 31), (3, 28), (3, 29), (3, 30), (3, 31), (4, 28), (4, 29), (4, 30), (4, 31)]
2026-01-23 14:49:25.433 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:803] - [CACHE_RECV] BASE_CACHE | layer=28, chunk=0, from rank=2, remaining=19
2026-01-23 14:49:25.434 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:807] -   key: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
2026-01-23 14:49:25.434 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:803] - [CACHE_RECV] BASE_CACHE | layer=29, chunk=0, from rank=2, remaining=18
2026-01-23 14:49:25.434 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:807] -   key: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
2026-01-23 14:49:25.434 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:803] - [CACHE_RECV] BASE_CACHE | layer=30, chunk=0, from rank=2, remaining=17
2026-01-23 14:49:25.434 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:807] -   key: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
2026-01-23 14:49:25.434 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:803] - [CACHE_RECV] BASE_CACHE | layer=31, chunk=0, from rank=2, remaining=16
2026-01-23 14:49:25.434 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:807] -   key: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
2026-01-23 14:49:25.434 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:803] - [CACHE_RECV] BASE_CACHE | layer=28, chunk=1, from rank=2, remaining=15
2026-01-23 14:49:25.434 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:807] -   key: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
2026-01-23 14:49:25.434 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:803] - [CACHE_RECV] BASE_CACHE | layer=29, chunk=1, from rank=2, remaining=14
2026-01-23 14:49:25.434 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:807] -   key: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
2026-01-23 14:49:25.435 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:803] - [CACHE_RECV] BASE_CACHE | layer=30, chunk=1, from rank=2, remaining=13
2026-01-23 14:49:25.435 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:807] -   key: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
2026-01-23 14:49:25.435 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:803] - [CACHE_RECV] BASE_CACHE | layer=31, chunk=1, from rank=2, remaining=12
2026-01-23 14:49:25.435 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:807] -   key: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
2026-01-23 14:49:25.435 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:803] - [CACHE_RECV] BASE_CACHE | layer=28, chunk=2, from rank=2, remaining=11
2026-01-23 14:49:25.435 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:807] -   key: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
2026-01-23 14:49:25.435 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:803] - [CACHE_RECV] BASE_CACHE | layer=29, chunk=2, from rank=2, remaining=10
2026-01-23 14:49:25.435 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:807] -   key: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
2026-01-23 14:49:25.435 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:803] - [CACHE_RECV] BASE_CACHE | layer=30, chunk=2, from rank=2, remaining=9
2026-01-23 14:49:25.435 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:807] -   key: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
2026-01-23 14:49:25.435 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:803] - [CACHE_RECV] BASE_CACHE | layer=31, chunk=2, from rank=2, remaining=8
2026-01-23 14:49:25.435 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:807] -   key: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
2026-01-23 14:49:25.435 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:803] - [CACHE_RECV] BASE_CACHE | layer=28, chunk=3, from rank=2, remaining=7
2026-01-23 14:49:25.436 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:807] -   key: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
2026-01-23 14:49:25.436 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:803] - [CACHE_RECV] BASE_CACHE | layer=29, chunk=3, from rank=2, remaining=6
2026-01-23 14:49:25.436 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:807] -   key: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
2026-01-23 14:49:25.436 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:803] - [CACHE_RECV] BASE_CACHE | layer=30, chunk=3, from rank=2, remaining=5
2026-01-23 14:49:25.436 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:807] -   key: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
2026-01-23 14:49:25.436 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:803] - [CACHE_RECV] BASE_CACHE | layer=31, chunk=3, from rank=2, remaining=4
2026-01-23 14:49:25.436 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:807] -   key: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
2026-01-23 14:49:25.436 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:803] - [CACHE_RECV] BASE_CACHE | layer=28, chunk=4, from rank=2, remaining=3
2026-01-23 14:49:25.436 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:807] -   key: shape=(1, 8, 104, 128), dtype=float16, device=cuda:0, size=0.203MB
2026-01-23 14:49:25.436 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:803] - [CACHE_RECV] BASE_CACHE | layer=29, chunk=4, from rank=2, remaining=2
2026-01-23 14:49:25.436 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:807] -   key: shape=(1, 8, 104, 128), dtype=float16, device=cuda:0, size=0.203MB
2026-01-23 14:49:25.436 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:803] - [CACHE_RECV] BASE_CACHE | layer=30, chunk=4, from rank=2, remaining=1
2026-01-23 14:49:25.436 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:807] -   key: shape=(1, 8, 104, 128), dtype=float16, device=cuda:0, size=0.203MB
2026-01-23 14:49:25.437 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:803] - [CACHE_RECV] BASE_CACHE | layer=31, chunk=4, from rank=2, remaining=0
2026-01-23 14:49:25.437 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:807] -   key: shape=(1, 8, 104, 128), dtype=float16, device=cuda:0, size=0.203MB
2026-01-23 14:49:25.437 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:837] - [CACHE_RECV] EAGLE_CACHE | chunk=0, incremental=True, from rank=2, kv_length=128, remaining=4
2026-01-23 14:49:25.437 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:841] -   key: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
2026-01-23 14:49:25.437 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:837] - [CACHE_RECV] EAGLE_CACHE | chunk=1, incremental=True, from rank=2, kv_length=256, remaining=3
2026-01-23 14:49:25.437 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:841] -   key: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
2026-01-23 14:49:25.437 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:837] - [CACHE_RECV] EAGLE_CACHE | chunk=2, incremental=True, from rank=2, kv_length=384, remaining=2
2026-01-23 14:49:25.437 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:841] -   key: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
2026-01-23 14:49:25.437 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:837] - [CACHE_RECV] EAGLE_CACHE | chunk=3, incremental=True, from rank=2, kv_length=512, remaining=1
2026-01-23 14:49:25.437 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:841] -   key: shape=(1, 8, 128, 128), dtype=float16, device=cuda:0, size=0.250MB
2026-01-23 14:49:25.437 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:837] - [CACHE_RECV] EAGLE_CACHE | chunk=4, incremental=True, from rank=2, kv_length=616, remaining=0
2026-01-23 14:49:25.437 - SpecSoT-Rank1-Comm - DEBUG - [base_comm_manager.py:841] -   key: shape=(1, 8, 104, 128), dtype=float16, device=cuda:0, size=0.203MB
2026-01-23 14:49:25.438 - SpecSoT-Rank1-Comm - INFO - [base_comm_manager.py:858] - [SYNC_OK] 所有 Cache 接收完成 | base_cache=20, eagle_cache=5, wait_time=6.14ms
