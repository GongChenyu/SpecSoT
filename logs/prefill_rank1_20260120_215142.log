2026-01-20 21:51:42.380 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:181] - [INIT] 初始化ZMQ通信管理器 | mode=p2p, base_port=45000
2026-01-20 21:51:43.382 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:193] - [INIT] 等待其他节点就绪 (3.0秒)...
2026-01-20 21:51:46.388 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:198] - [INIT] 通信管理器已启动
2026-01-20 21:51:46.433 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:255] - ============================================================
2026-01-20 21:51:46.434 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:256] - [PREFILL] 开始分布式 Prefill 阶段
2026-01-20 21:51:46.434 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:257] - ============================================================
2026-01-20 21:51:46.434 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:258] -   Rank: 1/2
2026-01-20 21:51:46.434 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:259] -   负责层范围: [14, 28)
2026-01-20 21:51:46.434 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:260] -   输入序列长度: 568
2026-01-20 21:51:46.434 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:261] -   模型总层数: 36
2026-01-20 21:51:46.435 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:809] - [INIT] Cache 追踪初始化: chunks=5, layers=36, seq_len=568
2026-01-20 21:51:46.435 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:676] - [SPLIT] 输入序列切分为 5 个 chunks | seq_len=568, chunk_size=128
2026-01-20 21:51:46.436 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:678] -     Chunk 0: shape=torch.Size([1, 128])
2026-01-20 21:51:46.436 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:678] -     Chunk 1: shape=torch.Size([1, 128])
2026-01-20 21:51:46.436 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:678] -     Chunk 2: shape=torch.Size([1, 128])
2026-01-20 21:51:46.436 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:678] -     Chunk 3: shape=torch.Size([1, 128])
2026-01-20 21:51:46.436 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:678] -     Chunk 4: shape=torch.Size([1, 56])
2026-01-20 21:51:46.436 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:268] -   Chunk数量: 5 (chunk_size=128)
2026-01-20 21:51:46.436 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:731] - [EAGLE] Input Layers 配置: [2, 18, 33] (总层数=36)
2026-01-20 21:51:46.436 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:272] -   Eagle Input Layers: [2, 18, 33]
2026-01-20 21:51:46.436 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:286] - 
[CHUNK 1/5] 开始处理 | seq_len=128, first=True, last=False
2026-01-20 21:51:46.436 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:301] -   [PHASE 1] 等待接收 Hidden States (from Rank 0)...
2026-01-20 21:51:46.444 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:310] -   [PHASE 1][RECV] Hidden States | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB | chunk_idx=0
2026-01-20 21:51:46.445 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:313] -   [PHASE 1] 完成 | 耗时: 8.79ms
2026-01-20 21:51:46.445 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:319] -   [PHASE 2] 开始计算 Decoder Layers [14, 28)
2026-01-20 21:51:46.445 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:327] -     past_key_values_length=0, seq_with_past=128
2026-01-20 21:51:46.656 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=14 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.656 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=14 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.660 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=15 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.660 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=15 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.663 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=16 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.663 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=16 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.665 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=17 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.666 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=17 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.668 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:407] -     [SEND][EAGLE] hidden state layer=18 -> Rank 2
2026-01-20 21:51:46.668 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=18 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.669 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=18 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.672 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=19 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.672 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=19 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.674 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=20 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.674 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=20 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.677 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=21 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.677 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=21 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.679 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=22 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.679 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=22 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.681 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=23 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.681 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=23 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.683 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=24 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.683 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=24 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.685 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=25 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.685 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=25 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.688 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=26 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.688 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=26 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.690 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=27 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.690 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=27 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.691 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:432] -   [PHASE 2] 完成 | layers=14, cache_sent=28, eagle_hidden_sent=1 | 耗时: 245.63ms
2026-01-20 21:51:46.691 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:442] -   [PHASE 3][SEND] Hidden States -> Rank 2
2026-01-20 21:51:46.691 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:448] -     Hidden States 发送完成 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-20 21:51:46.691 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:547] -   [PHASE 3] 完成 | 耗时: 0.27ms
2026-01-20 21:51:46.691 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=0, chunk=0 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.691 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=1, chunk=0 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.691 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=2, chunk=0 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.691 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=3, chunk=0 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.692 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=4, chunk=0 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.692 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=5, chunk=0 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.693 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=6, chunk=0 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.693 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=7, chunk=0 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.693 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=8, chunk=0 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.693 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=9, chunk=0 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.693 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=10, chunk=0 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.693 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=11, chunk=0 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.693 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=12, chunk=0 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.693 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=13, chunk=0 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.693 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=0, chunk=1 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.694 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=1, chunk=1 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.694 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=2, chunk=1 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.694 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=3, chunk=1 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.695 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=4, chunk=1 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.695 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=5, chunk=1 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.695 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=6, chunk=1 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.695 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=7, chunk=1 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.695 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=8, chunk=1 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.695 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=9, chunk=1 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.696 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=10, chunk=1 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.696 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=11, chunk=1 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.696 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=12, chunk=1 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.696 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=13, chunk=1 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.696 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=0, chunk=2 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.696 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=1, chunk=2 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.697 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=2, chunk=2 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.697 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=3, chunk=2 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.697 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=4, chunk=2 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.697 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=5, chunk=2 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.697 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=6, chunk=2 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.697 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=7, chunk=2 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.697 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=8, chunk=2 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.698 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=9, chunk=2 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.698 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=10, chunk=2 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.698 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=11, chunk=2 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.698 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=12, chunk=2 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.698 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=13, chunk=2 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.698 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=0, chunk=3 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.699 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=1, chunk=3 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.699 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=2, chunk=3 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.700 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=3, chunk=3 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.700 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=4, chunk=3 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.700 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=5, chunk=3 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.700 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=6, chunk=3 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.700 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=7, chunk=3 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.700 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=8, chunk=3 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.701 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=9, chunk=3 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.701 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=10, chunk=3 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.701 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=11, chunk=3 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.701 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=12, chunk=3 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.702 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=13, chunk=3 from Rank 0 | size=0.50MB
2026-01-20 21:51:46.702 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=0, chunk=4 from Rank 0 | size=0.22MB
2026-01-20 21:51:46.702 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=1, chunk=4 from Rank 0 | size=0.22MB
2026-01-20 21:51:46.702 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=2, chunk=4 from Rank 0 | size=0.22MB
2026-01-20 21:51:46.702 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=3, chunk=4 from Rank 0 | size=0.22MB
2026-01-20 21:51:46.702 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=4, chunk=4 from Rank 0 | size=0.22MB
2026-01-20 21:51:46.703 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=5, chunk=4 from Rank 0 | size=0.22MB
2026-01-20 21:51:46.703 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=6, chunk=4 from Rank 0 | size=0.22MB
2026-01-20 21:51:46.703 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=7, chunk=4 from Rank 0 | size=0.22MB
2026-01-20 21:51:46.703 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=8, chunk=4 from Rank 0 | size=0.22MB
2026-01-20 21:51:46.704 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=9, chunk=4 from Rank 0 | size=0.22MB
2026-01-20 21:51:46.704 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=10, chunk=4 from Rank 0 | size=0.22MB
2026-01-20 21:51:46.704 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=11, chunk=4 from Rank 0 | size=0.22MB
2026-01-20 21:51:46.705 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=12, chunk=4 from Rank 0 | size=0.22MB
2026-01-20 21:51:46.705 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:716] -   [RECV][CACHE] layer=13, chunk=4 from Rank 0 | size=0.22MB
2026-01-20 21:51:46.706 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:719] -   [CACHE] 非阻塞接收 70 个 Base Cache
2026-01-20 21:51:46.706 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:553] - [CHUNK 1/5] 完成 | 总耗时: 270.35ms
2026-01-20 21:51:46.706 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:286] - 
[CHUNK 2/5] 开始处理 | seq_len=128, first=False, last=False
2026-01-20 21:51:46.706 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:301] -   [PHASE 1] 等待接收 Hidden States (from Rank 0)...
2026-01-20 21:51:46.707 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:310] -   [PHASE 1][RECV] Hidden States | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB | chunk_idx=1
2026-01-20 21:51:46.707 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:313] -   [PHASE 1] 完成 | 耗时: 0.17ms
2026-01-20 21:51:46.707 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:319] -   [PHASE 2] 开始计算 Decoder Layers [14, 28)
2026-01-20 21:51:46.707 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:327] -     past_key_values_length=568, seq_with_past=696
2026-01-20 21:51:46.709 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=14 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.709 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=14 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.712 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=15 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.713 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=15 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.716 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=16 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.716 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=16 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.719 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=17 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.719 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=17 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.722 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:407] -     [SEND][EAGLE] hidden state layer=18 -> Rank 2
2026-01-20 21:51:46.723 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=18 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.723 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=18 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.726 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=19 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.727 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=19 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.730 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=20 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.731 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=20 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.734 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=21 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.734 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=21 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.737 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=22 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.737 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=22 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.739 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=23 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.740 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=23 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.742 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=24 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.743 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=24 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.745 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=25 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.745 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=25 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.748 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=26 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.749 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=26 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.751 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=27 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.751 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=27 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.752 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:432] -   [PHASE 2] 完成 | layers=14, cache_sent=28, eagle_hidden_sent=1 | 耗时: 44.90ms
2026-01-20 21:51:46.752 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:442] -   [PHASE 3][SEND] Hidden States -> Rank 2
2026-01-20 21:51:46.752 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:448] -     Hidden States 发送完成 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-20 21:51:46.752 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:547] -   [PHASE 3] 完成 | 耗时: 0.14ms
2026-01-20 21:51:46.753 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:553] - [CHUNK 2/5] 完成 | 总耗时: 46.46ms
2026-01-20 21:51:46.753 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:286] - 
[CHUNK 3/5] 开始处理 | seq_len=128, first=False, last=False
2026-01-20 21:51:46.753 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:301] -   [PHASE 1] 等待接收 Hidden States (from Rank 0)...
2026-01-20 21:51:46.753 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:310] -   [PHASE 1][RECV] Hidden States | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB | chunk_idx=2
2026-01-20 21:51:46.753 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:313] -   [PHASE 1] 完成 | 耗时: 0.13ms
2026-01-20 21:51:46.753 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:319] -   [PHASE 2] 开始计算 Decoder Layers [14, 28)
2026-01-20 21:51:46.753 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:327] -     past_key_values_length=568, seq_with_past=696
2026-01-20 21:51:46.757 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=14 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.757 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=14 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.760 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=15 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.760 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=15 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.763 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=16 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.763 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=16 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.766 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=17 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.766 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=17 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.769 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:407] -     [SEND][EAGLE] hidden state layer=18 -> Rank 2
2026-01-20 21:51:46.769 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=18 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.770 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=18 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.772 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=19 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.772 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=19 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.775 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=20 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.776 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=20 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.779 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=21 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.780 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=21 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.783 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=22 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.783 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=22 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.786 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=23 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.787 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=23 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.790 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=24 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.790 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=24 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.793 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=25 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.794 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=25 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.797 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=26 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.797 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=26 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.800 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=27 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.801 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=27 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.801 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:432] -   [PHASE 2] 完成 | layers=14, cache_sent=28, eagle_hidden_sent=1 | 耗时: 47.58ms
2026-01-20 21:51:46.801 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:442] -   [PHASE 3][SEND] Hidden States -> Rank 2
2026-01-20 21:51:46.801 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:448] -     Hidden States 发送完成 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-20 21:51:46.801 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:547] -   [PHASE 3] 完成 | 耗时: 0.23ms
2026-01-20 21:51:46.802 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:553] - [CHUNK 3/5] 完成 | 总耗时: 49.43ms
2026-01-20 21:51:46.802 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:286] - 
[CHUNK 4/5] 开始处理 | seq_len=128, first=False, last=False
2026-01-20 21:51:46.803 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:301] -   [PHASE 1] 等待接收 Hidden States (from Rank 0)...
2026-01-20 21:51:46.803 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:310] -   [PHASE 1][RECV] Hidden States | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB | chunk_idx=3
2026-01-20 21:51:46.803 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:313] -   [PHASE 1] 完成 | 耗时: 0.41ms
2026-01-20 21:51:46.803 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:319] -   [PHASE 2] 开始计算 Decoder Layers [14, 28)
2026-01-20 21:51:46.803 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:327] -     past_key_values_length=568, seq_with_past=696
2026-01-20 21:51:46.807 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=14 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.807 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=14 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.810 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=15 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.811 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=15 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.818 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=16 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.819 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=16 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.822 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=17 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.822 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=17 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.825 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:407] -     [SEND][EAGLE] hidden state layer=18 -> Rank 2
2026-01-20 21:51:46.826 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=18 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.826 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=18 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.830 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=19 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.830 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=19 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.833 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=20 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.834 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=20 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.837 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=21 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.837 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=21 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.840 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=22 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.841 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=22 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.844 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=23 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.844 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=23 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.847 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=24 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.848 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=24 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.851 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=25 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.851 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=25 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.854 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=26 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.855 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=26 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.858 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=27 -> Rank 0 | size=0.50MB
2026-01-20 21:51:46.858 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=27 -> Rank 2 | size=0.50MB
2026-01-20 21:51:46.858 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:432] -   [PHASE 2] 完成 | layers=14, cache_sent=28, eagle_hidden_sent=1 | 耗时: 55.28ms
2026-01-20 21:51:46.858 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:442] -   [PHASE 3][SEND] Hidden States -> Rank 2
2026-01-20 21:51:46.859 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:448] -     Hidden States 发送完成 | shape=(1, 128, 2560), dtype=float16, device=cuda:0, size=0.625MB
2026-01-20 21:51:46.859 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:547] -   [PHASE 3] 完成 | 耗时: 0.40ms
2026-01-20 21:51:46.860 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:553] - [CHUNK 4/5] 完成 | 总耗时: 57.42ms
2026-01-20 21:51:46.860 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:286] - 
[CHUNK 5/5] 开始处理 | seq_len=56, first=False, last=True
2026-01-20 21:51:46.860 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:301] -   [PHASE 1] 等待接收 Hidden States (from Rank 0)...
2026-01-20 21:51:46.860 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:310] -   [PHASE 1][RECV] Hidden States | shape=(1, 56, 2560), dtype=float16, device=cuda:0, size=0.273MB | chunk_idx=4
2026-01-20 21:51:46.860 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:313] -   [PHASE 1] 完成 | 耗时: 0.26ms
2026-01-20 21:51:46.860 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:319] -   [PHASE 2] 开始计算 Decoder Layers [14, 28)
2026-01-20 21:51:46.861 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:327] -     past_key_values_length=568, seq_with_past=624
2026-01-20 21:51:46.865 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=14 -> Rank 0 | size=0.22MB
2026-01-20 21:51:46.866 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=14 -> Rank 2 | size=0.22MB
2026-01-20 21:51:46.869 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=15 -> Rank 0 | size=0.22MB
2026-01-20 21:51:46.869 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=15 -> Rank 2 | size=0.22MB
2026-01-20 21:51:46.873 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=16 -> Rank 0 | size=0.22MB
2026-01-20 21:51:46.873 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=16 -> Rank 2 | size=0.22MB
2026-01-20 21:51:46.876 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=17 -> Rank 0 | size=0.22MB
2026-01-20 21:51:46.876 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=17 -> Rank 2 | size=0.22MB
2026-01-20 21:51:46.880 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:407] -     [SEND][EAGLE] hidden state layer=18 -> Rank 2
2026-01-20 21:51:46.880 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=18 -> Rank 0 | size=0.22MB
2026-01-20 21:51:46.880 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=18 -> Rank 2 | size=0.22MB
2026-01-20 21:51:46.884 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=19 -> Rank 0 | size=0.22MB
2026-01-20 21:51:46.884 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=19 -> Rank 2 | size=0.22MB
2026-01-20 21:51:46.887 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=20 -> Rank 0 | size=0.22MB
2026-01-20 21:51:46.888 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=20 -> Rank 2 | size=0.22MB
2026-01-20 21:51:46.891 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=21 -> Rank 0 | size=0.22MB
2026-01-20 21:51:46.891 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=21 -> Rank 2 | size=0.22MB
2026-01-20 21:51:46.894 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=22 -> Rank 0 | size=0.22MB
2026-01-20 21:51:46.895 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=22 -> Rank 2 | size=0.22MB
2026-01-20 21:51:46.898 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=23 -> Rank 0 | size=0.22MB
2026-01-20 21:51:46.898 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=23 -> Rank 2 | size=0.22MB
2026-01-20 21:51:46.901 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=24 -> Rank 0 | size=0.22MB
2026-01-20 21:51:46.902 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=24 -> Rank 2 | size=0.22MB
2026-01-20 21:51:46.905 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=25 -> Rank 0 | size=0.22MB
2026-01-20 21:51:46.905 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=25 -> Rank 2 | size=0.22MB
2026-01-20 21:51:46.908 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=26 -> Rank 0 | size=0.22MB
2026-01-20 21:51:46.909 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=26 -> Rank 2 | size=0.22MB
2026-01-20 21:51:46.912 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=27 -> Rank 0 | size=0.22MB
2026-01-20 21:51:46.912 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:426] -     [SEND][CACHE] layer=27 -> Rank 2 | size=0.22MB
2026-01-20 21:51:46.912 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:432] -   [PHASE 2] 完成 | layers=14, cache_sent=28, eagle_hidden_sent=1 | 耗时: 51.94ms
2026-01-20 21:51:46.912 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:442] -   [PHASE 3][SEND] Hidden States -> Rank 2
2026-01-20 21:51:46.913 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:448] -     Hidden States 发送完成 | shape=(1, 56, 2560), dtype=float16, device=cuda:0, size=0.273MB
2026-01-20 21:51:46.913 - DistPrefill-Rank1 - DEBUG - [distributed_prefill.py:547] -   [PHASE 3] 完成 | 耗时: 0.25ms
2026-01-20 21:51:46.914 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:553] - [CHUNK 5/5] 完成 | 总耗时: 53.88ms
2026-01-20 21:51:46.914 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:558] - 
============================================================
2026-01-20 21:51:46.914 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:559] - [POST-CHUNK] 所有 Chunks 处理完成，开始同步阶段
2026-01-20 21:51:46.914 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:560] - ============================================================
2026-01-20 21:51:46.914 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:566] - [RECV] 等待 Draft Tokens (from Rank 2)...
2026-01-20 21:51:48.085 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:577] - [RECV] Draft Tokens 接收完成 | shape=torch.Size([1, 40]) | 耗时: 1170.67ms
2026-01-20 21:51:48.085 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:580] - [SYNC] 等待所有 Cache 同步...
2026-01-20 21:51:48.092 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:597] - [SYNC_OK] Rank 1 Cache 同步完成 | 耗时: 6.45ms
2026-01-20 21:51:48.092 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:606] - ============================================================
2026-01-20 21:51:48.092 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:607] - [PREFILL] 分布式 Prefill 完成 | 总耗时: 1.659s
2026-01-20 21:51:48.092 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:608] - ============================================================
2026-01-20 21:51:53.628 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:205] - [CLEANUP] 通信统计: {'draft_tokens_sent': 0, 'draft_tokens_recv': 1, 'hidden_sent': 5, 'hidden_recv': 5, 'eagle_input_hidden_sent': 5, 'eagle_input_hidden_recv': 0, 'base_cache_sent': 140, 'base_cache_recv': 110, 'eagle_cache_sent': 0, 'eagle_cache_recv': 5, 'aggregated_sends': 0, 'forwarded_messages': 0}
2026-01-20 21:51:53.727 - DistPrefill-Rank1 - INFO - [distributed_prefill.py:208] - [CLEANUP] 分布式Prefill管理器已清理
